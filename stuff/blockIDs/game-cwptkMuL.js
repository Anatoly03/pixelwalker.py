var Uo=Object.defineProperty;var No=(n,e,t)=>e in n?Uo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var m=(n,e,t)=>(No(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Me={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},Rs=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],Ls=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],Fs=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],Te=typeof window<"u"&&typeof window.document<"u"?window.document:{},je="fullscreenEnabled"in Te&&Object.keys(Me)||Rs[0]in Te&&Rs||Ls[0]in Te&&Ls||Fs[0]in Te&&Fs||[],Hi={requestFullscreen:function(n){return n[je[Me.requestFullscreen]]()},requestFullscreenFunction:function(n){return n[je[Me.requestFullscreen]]},get exitFullscreen(){return Te[je[Me.exitFullscreen]].bind(Te)},get fullscreenPseudoClass(){return":"+je[Me.fullscreen]},addEventListener:function(n,e,t){return Te.addEventListener(je[Me[n]],e,t)},removeEventListener:function(n,e,t){return Te.removeEventListener(je[Me[n]],e,t)},get fullscreenEnabled(){return!!Te[je[Me.fullscreenEnabled]]},set fullscreenEnabled(n){},get fullscreenElement(){return Te[je[Me.fullscreenElement]]},set fullscreenElement(n){},get onfullscreenchange(){return Te[("on"+je[Me.fullscreenchange]).toLowerCase()]},set onfullscreenchange(n){return Te[("on"+je[Me.fullscreenchange]).toLowerCase()]=n},get onfullscreenerror(){return Te[("on"+je[Me.fullscreenerror]).toLowerCase()]},set onfullscreenerror(n){return Te[("on"+je[Me.fullscreenerror]).toLowerCase()]=n}},at=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var dn={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(at,function(){var t=function(){function i(p){return o.appendChild(p.dom),p}function r(p){for(var _=0;_<o.children.length;_++)o.children[_].style.display=_===p?"block":"none";s=p}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(p){p.preventDefault(),r(++s%o.children.length)},!1);var l=(performance||Date).now(),h=l,f=0,g=i(new t.Panel("FPS","#0ff","#002")),a=i(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=i(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:i,showPanel:r,begin:function(){l=(performance||Date).now()},end:function(){f++;var p=(performance||Date).now();if(a.update(p-l,200),p>h+1e3&&(g.update(1e3*f/(p-h),100),h=p,f=0,c)){var _=performance.memory;c.update(_.usedJSHeapSize/1048576,_.jsHeapSizeLimit/1048576)}return p},update:function(){l=this.end()},domElement:o,setMode:r}};return t.Panel=function(i,r,s){var o=1/0,l=0,h=Math.round,f=h(window.devicePixelRatio||1),g=80*f,a=48*f,c=3*f,p=2*f,_=3*f,y=15*f,S=74*f,x=30*f,v=document.createElement("canvas");v.width=g,v.height=a,v.style.cssText="width:80px;height:48px";var P=v.getContext("2d");return P.font="bold "+9*f+"px Helvetica,Arial,sans-serif",P.textBaseline="top",P.fillStyle=s,P.fillRect(0,0,g,a),P.fillStyle=r,P.fillText(i,c,p),P.fillRect(_,y,S,x),P.fillStyle=s,P.globalAlpha=.9,P.fillRect(_,y,S,x),{dom:v,update:function(E,I){o=Math.min(o,E),l=Math.max(l,E),P.fillStyle=s,P.globalAlpha=1,P.fillRect(0,0,g,y),P.fillStyle=r,P.fillText(h(E)+" "+i+" ("+h(o)+"-"+h(l)+")",c,p),P.drawImage(v,_+f,y,S-f,x,_,y,S-f,x),P.fillRect(_+S-f,y,f,x),P.fillStyle=s,P.globalAlpha=.9,P.fillRect(_+S-f,y,f,h((1-E/I)*x))}}},t})})(dn);var Ko=dn.exports;const Xo=Yo(Ko),Vo="/assets/tile_atlas-GalCJu8M.png",Wo=[{filename:"background/basic/blue",frame:{x:0,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/basic/cyan",frame:{x:16,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/basic/gray",frame:{x:32,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/basic/green",frame:{x:48,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/basic/magenta",frame:{x:64,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/basic/red",frame:{x:80,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/basic/yellow",frame:{x:96,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/bricks/brown",frame:{x:112,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/bricks/green",frame:{x:128,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/bricks/olive",frame:{x:144,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/bricks/purple",frame:{x:160,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/bricks/red",frame:{x:176,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/bricks/teal",frame:{x:192,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/candy/blue",frame:{x:208,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/candy/pink",frame:{x:224,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/checker/blue",frame:{x:240,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/checker/cyan",frame:{x:256,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/checker/gray",frame:{x:272,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/checker/green",frame:{x:288,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/checker/magenta",frame:{x:304,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/checker/red",frame:{x:320,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/checker/yellow",frame:{x:336,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/dark/blue",frame:{x:352,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/dark/cyan",frame:{x:368,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/dark/gray",frame:{x:384,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/dark/green",frame:{x:400,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/dark/magenta",frame:{x:416,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/dark/red",frame:{x:432,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/dark/yellow",frame:{x:448,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/normal/blue",frame:{x:464,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/normal/cyan",frame:{x:480,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/normal/gray",frame:{x:496,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/normal/green",frame:{x:0,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/normal/magenta",frame:{x:16,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/normal/red",frame:{x:32,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/normal/yellow",frame:{x:48,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/pastel/blue",frame:{x:64,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/pastel/light_cyan",frame:{x:80,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/pastel/light_green",frame:{x:96,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/pastel/light_salmon_pink",frame:{x:112,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/pastel/light_tan",frame:{x:128,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"background/pastel/reef",frame:{x:144,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/candy/cream_large",frame:{x:160,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/candy/cream_small",frame:{x:176,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/candy/gumdrop_green",frame:{x:192,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/candy/gumdrop_pink",frame:{x:208,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/candy/gumdrop_red",frame:{x:224,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/easter_eggs/blue",frame:{x:240,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/easter_eggs/green",frame:{x:256,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/easter_eggs/pink",frame:{x:272,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/easter_eggs/red",frame:{x:288,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/easter_eggs/yellow",frame:{x:304,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/bush_left",frame:{x:320,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/bush_middle",frame:{x:336,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/bush_right",frame:{x:352,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/grass_left",frame:{x:368,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/grass_middle",frame:{x:384,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/grass_right",frame:{x:400,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/small_bush",frame:{x:416,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"decoration/meadow/yellow_flower",frame:{x:432,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"extra/empty",frame:{x:448,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"extra/numbers",frame:{x:416,y:80,w:66,h:14},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:66,h:14},sourceSize:{w:66,h:14}},{filename:"foreground/basic/blue",frame:{x:464,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/basic/cyan",frame:{x:480,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/basic/gray",frame:{x:496,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/basic/green",frame:{x:0,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/basic/magenta",frame:{x:16,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/basic/red",frame:{x:32,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/basic/yellow",frame:{x:48,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/beveled/blue",frame:{x:64,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/beveled/gray",frame:{x:80,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/beveled/green",frame:{x:96,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/beveled/magenta",frame:{x:112,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/beveled/red",frame:{x:128,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/beveled/yellow",frame:{x:144,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/boost/down",frame:{x:160,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/boost/left",frame:{x:176,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/boost/right",frame:{x:192,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/boost/up",frame:{x:208,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/bricks/brown",frame:{x:224,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/bricks/green",frame:{x:240,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/bricks/olive",frame:{x:256,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/bricks/purple",frame:{x:272,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/bricks/red",frame:{x:288,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/bricks/teal",frame:{x:304,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/blue",frame:{x:320,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/cane",frame:{x:336,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/chocolate",frame:{x:352,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/licorice",frame:{x:368,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/pink",frame:{x:384,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/platform_cyan",frame:{x:400,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/platform_green",frame:{x:416,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/platform_pink",frame:{x:432,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/candy/platform_red",frame:{x:448,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/coin_doors_and_gates/blue_coin_door",frame:{x:80,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/coin_doors_and_gates/blue_coin_gate",frame:{x:112,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/coin_doors_and_gates/coin_door",frame:{x:144,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/coin_doors_and_gates/coin_gate",frame:{x:176,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/coins/blue_coin",frame:{x:0,y:160,w:416,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:416,h:16},sourceSize:{w:416,h:16}},{filename:"foreground/coins/coin",frame:{x:0,y:176,w:416,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:416,h:16},sourceSize:{w:416,h:16}},{filename:"foreground/crown",frame:{x:464,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/death/death_door",frame:{x:208,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/death/death_gate",frame:{x:240,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/factory/metal_crate",frame:{x:480,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/factory/scales",frame:{x:496,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/factory/stone",frame:{x:0,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/factory/wood",frame:{x:16,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/factory/wood_crate",frame:{x:32,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/generic/black_block",frame:{x:48,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/generic/face_block",frame:{x:64,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/generic/full_black_block",frame:{x:80,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/generic/hazard_stripes",frame:{x:96,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/blue",frame:{x:112,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/cyan",frame:{x:128,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/green",frame:{x:144,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/magenta",frame:{x:160,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/orange",frame:{x:176,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/purple",frame:{x:192,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/red",frame:{x:208,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/glass/yellow",frame:{x:224,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/grass/grass",frame:{x:240,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/grass/grass_left_edge",frame:{x:256,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/grass/grass_right_edge",frame:{x:272,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/gravity/dot",frame:{x:288,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/gravity/down",frame:{x:304,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/gravity/left",frame:{x:320,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/gravity/right",frame:{x:336,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/gravity/slow_dot",frame:{x:352,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/gravity/up",frame:{x:368,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/hazards/fire",frame:{x:128,y:96,w:192,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:192,h:16},sourceSize:{w:192,h:16}},{filename:"foreground/hazards/spikes",frame:{x:160,y:80,w:64,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:16},sourceSize:{w:64,h:16}},{filename:"foreground/hazards/spikes_center",frame:{x:384,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/keys/key_blue",frame:{x:400,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/keys/key_door_blue",frame:{x:272,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/keys/key_door_green",frame:{x:304,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/keys/key_door_red",frame:{x:336,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/keys/key_gate_blue",frame:{x:368,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/keys/key_gate_green",frame:{x:400,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/keys/key_gate_red",frame:{x:432,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/keys/key_green",frame:{x:416,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/keys/key_red",frame:{x:432,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/liquids/water",frame:{x:0,y:144,w:352,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:352,h:16},sourceSize:{w:352,h:16}},{filename:"foreground/liquids/water_surface",frame:{x:0,y:96,w:128,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:16},sourceSize:{w:128,h:16}},{filename:"foreground/metal/copper",frame:{x:448,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/metal/gold",frame:{x:464,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/metal/silver",frame:{x:480,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/portal/down",frame:{x:0,y:112,w:240,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:240,h:16},sourceSize:{w:240,h:16}},{filename:"foreground/portal/invisible",frame:{x:224,y:80,w:64,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:16},sourceSize:{w:64,h:16}},{filename:"foreground/portal/left",frame:{x:240,y:112,w:240,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:240,h:16},sourceSize:{w:240,h:16}},{filename:"foreground/portal/right",frame:{x:0,y:128,w:240,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:240,h:16},sourceSize:{w:240,h:16}},{filename:"foreground/portal/up",frame:{x:240,y:128,w:240,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:240,h:16},sourceSize:{w:240,h:16}},{filename:"foreground/secrets/appear",frame:{x:496,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/secrets/disappear",frame:{x:464,y:64,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/spawn/checkpoint",frame:{x:0,y:80,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/spawn/spawn_point",frame:{x:0,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/switches/global_door",frame:{x:16,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/switches/global_gate",frame:{x:32,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/switches/global_resetter",frame:{x:32,y:80,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/switches/global_setter",frame:{x:288,y:80,w:64,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:16},sourceSize:{w:64,h:16}},{filename:"foreground/switches/global_switch",frame:{x:64,y:80,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/switches/local_door",frame:{x:48,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/switches/local_gate",frame:{x:64,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16}},{filename:"foreground/switches/local_resetter",frame:{x:96,y:80,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}},{filename:"foreground/switches/local_setter",frame:{x:352,y:80,w:64,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:16},sourceSize:{w:64,h:16}},{filename:"foreground/switches/local_switch",frame:{x:128,y:80,w:32,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:32,h:16},sourceSize:{w:32,h:16}}],qo={app:"https://www.codeandweb.com/texturepacker",version:"1.0",image:"tile_atlas.png",format:"RGBA8888",size:{w:512,h:256},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:1adc056ade4cef018fde6155fee5c52a:5673d559ad3f31315500eef234c14c2b:a2313b992111dc7224c457eab3e30c18$"},jo={frames:Wo,meta:qo},Ho="/assets/sprite_atlas-Dunw_LYv.png",$o=[{filename:"auras/aura",frame:{x:0,y:0,w:48,h:48},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:48,h:48},sourceSize:{w:48,h:48}},{filename:"auras/staff",frame:{x:48,y:0,w:768,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:768,h:64},sourceSize:{w:768,h:64}},{filename:"crowns/gold",frame:{x:816,y:0,w:12,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:12,h:8},sourceSize:{w:12,h:8}},{filename:"crowns/silver",frame:{x:828,y:0,w:12,h:8},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:12,h:8},sourceSize:{w:12,h:8}},{filename:"misc/death",frame:{x:840,y:0,w:512,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:512,h:64},sourceSize:{w:512,h:64}},{filename:"misc/microchat",frame:{x:1352,y:0,w:13,h:13},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:13,h:13},sourceSize:{w:13,h:13}},{filename:"misc/particles",frame:{x:1365,y:0,w:90,h:6},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:90,h:6},sourceSize:{w:90,h:6}},{filename:"smileys/annoyed",frame:{x:1455,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/cry",frame:{x:1481,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/devil",frame:{x:1507,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/frustrated",frame:{x:1533,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/grin",frame:{x:1559,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/happy",frame:{x:1585,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/indifferent",frame:{x:1611,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/inquisitive",frame:{x:1637,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/sad",frame:{x:1663,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/shades",frame:{x:1689,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/smiley",frame:{x:1715,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/surprised",frame:{x:1741,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/tongue",frame:{x:1767,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"smileys/wink",frame:{x:1793,y:0,w:26,h:26},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:26,h:26},sourceSize:{w:26,h:26}}],Jo={app:"https://www.codeandweb.com/texturepacker",version:"1.0",image:"sprite_atlas.png",format:"RGBA8888",size:{w:1819,h:64},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:ff971e011a37dd4ea929f050c4ed8dc3:35b3b7d5323c17bae6c78d036d8dbbca:6faed1d119539f9288c5144068f00f24$"},Zo={frames:$o,meta:Jo},Qo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAAAlwSFlzAAAOwwAADsMBx2+oZAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC40EoIC8wAAAC9JREFUOE9j+A8EDAwMvuTSQAzmgAwiB0MIKE0yHnXBqAtAeNQFqC4A8cig//8HAEaFymHVbYN4AAAAAElFTkSuQmCC",ea="/assets/coin-kRemJZGu.mp3",ta="/assets/btn_fullscreen-D-qSaDnd.png",ia="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGUSURBVDhPzZK/S8NQEMevqUWEOvgLoUOL4O7SH9Q6OjjYQXAvCIWCtbNzcauUDu7dBP0DKki3QKGQbhJHKS1UYtQqFtuQ+PzeIxlaswgOfuDDe0nuLu8uoX/Pnuuv2IFnUIM2FPAensNdOEXQXT34bUfJZPI4m81GKpWKksvlKBwOr4ZCoe1erxfB80+oc7AfF/F4XKiqKobDoTBNUwwGA9HtdkWz2RSZTIZPcwmXZfQMh/BuNBqJfD4vuBAXMQxDpFIpUSwWha7rXOABnnACo7grMwfng8EgdTod0jSNFEWhQCBA7XZb3uM94LYX4RpfcJKHCY1SqbTZarXIcRwqFAqySL/fp8lkQrVajeNe4BuU1Wa5hiKRSPyYQTqd5uOzt3ALLsGpFph3nnqj0aDxeCzfalmWPE29XifMhmMs11e+mC3wGIvFZGK5XCbbtmVytVqV+2g0yjHcwhdv/NiHV5B79I7s+QFv4CncgBK/QazAA7gOF/gGcCD/QCp8hk/u6j9JF/5Z+JN5bfIpuJBM/COIvgH2+q95llvXlwAAAABJRU5ErkJggg==",ra="/assets/lobby_background-BWrtL_hA.png";var fn={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(n){(function(){var e=function(){this.init()};e.prototype={init:function(){var a=this||t;return a._counter=1e3,a._html5AudioPool=[],a.html5PoolSize=10,a._codecs={},a._howls=[],a._muted=!1,a._volume=1,a._canPlayEvent="canplaythrough",a._navigator=typeof window<"u"&&window.navigator?window.navigator:null,a.masterGain=null,a.noAudio=!1,a.usingWebAudio=!0,a.autoSuspend=!0,a.ctx=null,a.autoUnlock=!0,a._setup(),a},volume:function(a){var c=this||t;if(a=parseFloat(a),c.ctx||g(),typeof a<"u"&&a>=0&&a<=1){if(c._volume=a,c._muted)return c;c.usingWebAudio&&c.masterGain.gain.setValueAtTime(a,t.ctx.currentTime);for(var p=0;p<c._howls.length;p++)if(!c._howls[p]._webAudio)for(var _=c._howls[p]._getSoundIds(),y=0;y<_.length;y++){var S=c._howls[p]._soundById(_[y]);S&&S._node&&(S._node.volume=S._volume*a)}return c}return c._volume},mute:function(a){var c=this||t;c.ctx||g(),c._muted=a,c.usingWebAudio&&c.masterGain.gain.setValueAtTime(a?0:c._volume,t.ctx.currentTime);for(var p=0;p<c._howls.length;p++)if(!c._howls[p]._webAudio)for(var _=c._howls[p]._getSoundIds(),y=0;y<_.length;y++){var S=c._howls[p]._soundById(_[y]);S&&S._node&&(S._node.muted=a?!0:S._muted)}return c},stop:function(){for(var a=this||t,c=0;c<a._howls.length;c++)a._howls[c].stop();return a},unload:function(){for(var a=this||t,c=a._howls.length-1;c>=0;c--)a._howls[c].unload();return a.usingWebAudio&&a.ctx&&typeof a.ctx.close<"u"&&(a.ctx.close(),a.ctx=null,g()),a},codecs:function(a){return(this||t)._codecs[a.replace(/^x-/,"")]},_setup:function(){var a=this||t;if(a.state=a.ctx&&a.ctx.state||"suspended",a._autoSuspend(),!a.usingWebAudio)if(typeof Audio<"u")try{var c=new Audio;typeof c.oncanplaythrough>"u"&&(a._canPlayEvent="canplay")}catch{a.noAudio=!0}else a.noAudio=!0;try{var c=new Audio;c.muted&&(a.noAudio=!0)}catch{}return a.noAudio||a._setupCodecs(),a},_setupCodecs:function(){var a=this||t,c=null;try{c=typeof Audio<"u"?new Audio:null}catch{return a}if(!c||typeof c.canPlayType!="function")return a;var p=c.canPlayType("audio/mpeg;").replace(/^no$/,""),_=a._navigator?a._navigator.userAgent:"",y=_.match(/OPR\/(\d+)/g),S=y&&parseInt(y[0].split("/")[1],10)<33,x=_.indexOf("Safari")!==-1&&_.indexOf("Chrome")===-1,v=_.match(/Version\/(.*?) /),P=x&&v&&parseInt(v[1],10)<15;return a._codecs={mp3:!!(!S&&(p||c.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(c.canPlayType('audio/wav; codecs="1"')||c.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!c.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(c.canPlayType("audio/x-m4b;")||c.canPlayType("audio/m4b;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!P&&c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!P&&c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!c.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(c.canPlayType("audio/x-flac;")||c.canPlayType("audio/flac;")).replace(/^no$/,"")},a},_unlockAudio:function(){var a=this||t;if(!(a._audioUnlocked||!a.ctx)){a._audioUnlocked=!1,a.autoUnlock=!1,!a._mobileUnloaded&&a.ctx.sampleRate!==44100&&(a._mobileUnloaded=!0,a.unload()),a._scratchBuffer=a.ctx.createBuffer(1,1,22050);var c=function(p){for(;a._html5AudioPool.length<a.html5PoolSize;)try{var _=new Audio;_._unlocked=!0,a._releaseHtml5Audio(_)}catch{a.noAudio=!0;break}for(var y=0;y<a._howls.length;y++)if(!a._howls[y]._webAudio)for(var S=a._howls[y]._getSoundIds(),x=0;x<S.length;x++){var v=a._howls[y]._soundById(S[x]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}a._autoResume();var P=a.ctx.createBufferSource();P.buffer=a._scratchBuffer,P.connect(a.ctx.destination),typeof P.start>"u"?P.noteOn(0):P.start(0),typeof a.ctx.resume=="function"&&a.ctx.resume(),P.onended=function(){P.disconnect(0),a._audioUnlocked=!0,document.removeEventListener("touchstart",c,!0),document.removeEventListener("touchend",c,!0),document.removeEventListener("click",c,!0),document.removeEventListener("keydown",c,!0);for(var E=0;E<a._howls.length;E++)a._howls[E]._emit("unlock")}};return document.addEventListener("touchstart",c,!0),document.addEventListener("touchend",c,!0),document.addEventListener("click",c,!0),document.addEventListener("keydown",c,!0),a}},_obtainHtml5Audio:function(){var a=this||t;if(a._html5AudioPool.length)return a._html5AudioPool.pop();var c=new Audio().play();return c&&typeof Promise<"u"&&(c instanceof Promise||typeof c.then=="function")&&c.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(a){var c=this||t;return a._unlocked&&c._html5AudioPool.push(a),c},_autoSuspend:function(){var a=this;if(!(!a.autoSuspend||!a.ctx||typeof a.ctx.suspend>"u"||!t.usingWebAudio)){for(var c=0;c<a._howls.length;c++)if(a._howls[c]._webAudio){for(var p=0;p<a._howls[c]._sounds.length;p++)if(!a._howls[c]._sounds[p]._paused)return a}return a._suspendTimer&&clearTimeout(a._suspendTimer),a._suspendTimer=setTimeout(function(){if(a.autoSuspend){a._suspendTimer=null,a.state="suspending";var _=function(){a.state="suspended",a._resumeAfterSuspend&&(delete a._resumeAfterSuspend,a._autoResume())};a.ctx.suspend().then(_,_)}},3e4),a}},_autoResume:function(){var a=this;if(!(!a.ctx||typeof a.ctx.resume>"u"||!t.usingWebAudio))return a.state==="running"&&a.ctx.state!=="interrupted"&&a._suspendTimer?(clearTimeout(a._suspendTimer),a._suspendTimer=null):a.state==="suspended"||a.state==="running"&&a.ctx.state==="interrupted"?(a.ctx.resume().then(function(){a.state="running";for(var c=0;c<a._howls.length;c++)a._howls[c]._emit("resume")}),a._suspendTimer&&(clearTimeout(a._suspendTimer),a._suspendTimer=null)):a.state==="suspending"&&(a._resumeAfterSuspend=!0),a}};var t=new e,i=function(a){var c=this;if(!a.src||a.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}c.init(a)};i.prototype={init:function(a){var c=this;return t.ctx||g(),c._autoplay=a.autoplay||!1,c._format=typeof a.format!="string"?a.format:[a.format],c._html5=a.html5||!1,c._muted=a.mute||!1,c._loop=a.loop||!1,c._pool=a.pool||5,c._preload=typeof a.preload=="boolean"||a.preload==="metadata"?a.preload:!0,c._rate=a.rate||1,c._sprite=a.sprite||{},c._src=typeof a.src!="string"?a.src:[a.src],c._volume=a.volume!==void 0?a.volume:1,c._xhr={method:a.xhr&&a.xhr.method?a.xhr.method:"GET",headers:a.xhr&&a.xhr.headers?a.xhr.headers:null,withCredentials:a.xhr&&a.xhr.withCredentials?a.xhr.withCredentials:!1},c._duration=0,c._state="unloaded",c._sounds=[],c._endTimers={},c._queue=[],c._playLock=!1,c._onend=a.onend?[{fn:a.onend}]:[],c._onfade=a.onfade?[{fn:a.onfade}]:[],c._onload=a.onload?[{fn:a.onload}]:[],c._onloaderror=a.onloaderror?[{fn:a.onloaderror}]:[],c._onplayerror=a.onplayerror?[{fn:a.onplayerror}]:[],c._onpause=a.onpause?[{fn:a.onpause}]:[],c._onplay=a.onplay?[{fn:a.onplay}]:[],c._onstop=a.onstop?[{fn:a.onstop}]:[],c._onmute=a.onmute?[{fn:a.onmute}]:[],c._onvolume=a.onvolume?[{fn:a.onvolume}]:[],c._onrate=a.onrate?[{fn:a.onrate}]:[],c._onseek=a.onseek?[{fn:a.onseek}]:[],c._onunlock=a.onunlock?[{fn:a.onunlock}]:[],c._onresume=[],c._webAudio=t.usingWebAudio&&!c._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(c),c._autoplay&&c._queue.push({event:"play",action:function(){c.play()}}),c._preload&&c._preload!=="none"&&c.load(),c},load:function(){var a=this,c=null;if(t.noAudio){a._emit("loaderror",null,"No audio support.");return}typeof a._src=="string"&&(a._src=[a._src]);for(var p=0;p<a._src.length;p++){var _,y;if(a._format&&a._format[p])_=a._format[p];else{if(y=a._src[p],typeof y!="string"){a._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}_=/^data:audio\/([^;,]+);/i.exec(y),_||(_=/\.([^.]+)$/.exec(y.split("?",1)[0])),_&&(_=_[1].toLowerCase())}if(_||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),_&&t.codecs(_)){c=a._src[p];break}}if(!c){a._emit("loaderror",null,"No codec support for selected audio sources.");return}return a._src=c,a._state="loading",window.location.protocol==="https:"&&c.slice(0,5)==="http:"&&(a._html5=!0,a._webAudio=!1),new r(a),a._webAudio&&o(a),a},play:function(a,c){var p=this,_=null;if(typeof a=="number")_=a,a=null;else{if(typeof a=="string"&&p._state==="loaded"&&!p._sprite[a])return null;if(typeof a>"u"&&(a="__default",!p._playLock)){for(var y=0,S=0;S<p._sounds.length;S++)p._sounds[S]._paused&&!p._sounds[S]._ended&&(y++,_=p._sounds[S]._id);y===1?a=null:_=null}}var x=_?p._soundById(_):p._inactiveSound();if(!x)return null;if(_&&!a&&(a=x._sprite||"__default"),p._state!=="loaded"){x._sprite=a,x._ended=!1;var v=x._id;return p._queue.push({event:"play",action:function(){p.play(v)}}),v}if(_&&!x._paused)return c||p._loadQueue("play"),x._id;p._webAudio&&t._autoResume();var P=Math.max(0,x._seek>0?x._seek:p._sprite[a][0]/1e3),E=Math.max(0,(p._sprite[a][0]+p._sprite[a][1])/1e3-P),I=E*1e3/Math.abs(x._rate),F=p._sprite[a][0]/1e3,M=(p._sprite[a][0]+p._sprite[a][1])/1e3;x._sprite=a,x._ended=!1;var O=function(){x._paused=!1,x._seek=P,x._start=F,x._stop=M,x._loop=!!(x._loop||p._sprite[a][2])};if(P>=M){p._ended(x);return}var L=x._node;if(p._webAudio){var W=function(){p._playLock=!1,O(),p._refreshBuffer(x);var J=x._muted||p._muted?0:x._volume;L.gain.setValueAtTime(J,t.ctx.currentTime),x._playStart=t.ctx.currentTime,typeof L.bufferSource.start>"u"?x._loop?L.bufferSource.noteGrainOn(0,P,86400):L.bufferSource.noteGrainOn(0,P,E):x._loop?L.bufferSource.start(0,P,86400):L.bufferSource.start(0,P,E),I!==1/0&&(p._endTimers[x._id]=setTimeout(p._ended.bind(p,x),I)),c||setTimeout(function(){p._emit("play",x._id),p._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?W():(p._playLock=!0,p.once("resume",W),p._clearTimer(x._id))}else{var H=function(){L.currentTime=P,L.muted=x._muted||p._muted||t._muted||L.muted,L.volume=x._volume*t.volume(),L.playbackRate=x._rate;try{var J=L.play();if(J&&typeof Promise<"u"&&(J instanceof Promise||typeof J.then=="function")?(p._playLock=!0,O(),J.then(function(){p._playLock=!1,L._unlocked=!0,c?p._loadQueue():p._emit("play",x._id)}).catch(function(){p._playLock=!1,p._emit("playerror",x._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),x._ended=!0,x._paused=!0})):c||(p._playLock=!1,O(),p._emit("play",x._id)),L.playbackRate=x._rate,L.paused){p._emit("playerror",x._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}a!=="__default"||x._loop?p._endTimers[x._id]=setTimeout(p._ended.bind(p,x),I):(p._endTimers[x._id]=function(){p._ended(x),L.removeEventListener("ended",p._endTimers[x._id],!1)},L.addEventListener("ended",p._endTimers[x._id],!1))}catch(X){p._emit("playerror",x._id,X)}};L.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(L.src=p._src,L.load());var q=window&&window.ejecta||!L.readyState&&t._navigator.isCocoonJS;if(L.readyState>=3||q)H();else{p._playLock=!0,p._state="loading";var K=function(){p._state="loaded",H(),L.removeEventListener(t._canPlayEvent,K,!1)};L.addEventListener(t._canPlayEvent,K,!1),p._clearTimer(x._id)}}return x._id},pause:function(a){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"pause",action:function(){c.pause(a)}}),c;for(var p=c._getSoundIds(a),_=0;_<p.length;_++){c._clearTimer(p[_]);var y=c._soundById(p[_]);if(y&&!y._paused&&(y._seek=c.seek(p[_]),y._rateSeek=0,y._paused=!0,c._stopFade(p[_]),y._node))if(c._webAudio){if(!y._node.bufferSource)continue;typeof y._node.bufferSource.stop>"u"?y._node.bufferSource.noteOff(0):y._node.bufferSource.stop(0),c._cleanBuffer(y._node)}else(!isNaN(y._node.duration)||y._node.duration===1/0)&&y._node.pause();arguments[1]||c._emit("pause",y?y._id:null)}return c},stop:function(a,c){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(a)}}),p;for(var _=p._getSoundIds(a),y=0;y<_.length;y++){p._clearTimer(_[y]);var S=p._soundById(_[y]);S&&(S._seek=S._start||0,S._rateSeek=0,S._paused=!0,S._ended=!0,p._stopFade(_[y]),S._node&&(p._webAudio?S._node.bufferSource&&(typeof S._node.bufferSource.stop>"u"?S._node.bufferSource.noteOff(0):S._node.bufferSource.stop(0),p._cleanBuffer(S._node)):(!isNaN(S._node.duration)||S._node.duration===1/0)&&(S._node.currentTime=S._start||0,S._node.pause(),S._node.duration===1/0&&p._clearSound(S._node))),c||p._emit("stop",S._id))}return p},mute:function(a,c){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(a,c)}}),p;if(typeof c>"u")if(typeof a=="boolean")p._muted=a;else return p._muted;for(var _=p._getSoundIds(c),y=0;y<_.length;y++){var S=p._soundById(_[y]);S&&(S._muted=a,S._interval&&p._stopFade(S._id),p._webAudio&&S._node?S._node.gain.setValueAtTime(a?0:S._volume,t.ctx.currentTime):S._node&&(S._node.muted=t._muted?!0:a),p._emit("mute",S._id))}return p},volume:function(){var a=this,c=arguments,p,_;if(c.length===0)return a._volume;if(c.length===1||c.length===2&&typeof c[1]>"u"){var y=a._getSoundIds(),S=y.indexOf(c[0]);S>=0?_=parseInt(c[0],10):p=parseFloat(c[0])}else c.length>=2&&(p=parseFloat(c[0]),_=parseInt(c[1],10));var x;if(typeof p<"u"&&p>=0&&p<=1){if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"volume",action:function(){a.volume.apply(a,c)}}),a;typeof _>"u"&&(a._volume=p),_=a._getSoundIds(_);for(var v=0;v<_.length;v++)x=a._soundById(_[v]),x&&(x._volume=p,c[2]||a._stopFade(_[v]),a._webAudio&&x._node&&!x._muted?x._node.gain.setValueAtTime(p,t.ctx.currentTime):x._node&&!x._muted&&(x._node.volume=p*t.volume()),a._emit("volume",x._id))}else return x=_?a._soundById(_):a._sounds[0],x?x._volume:0;return a},fade:function(a,c,p,_){var y=this;if(y._state!=="loaded"||y._playLock)return y._queue.push({event:"fade",action:function(){y.fade(a,c,p,_)}}),y;a=Math.min(Math.max(0,parseFloat(a)),1),c=Math.min(Math.max(0,parseFloat(c)),1),p=parseFloat(p),y.volume(a,_);for(var S=y._getSoundIds(_),x=0;x<S.length;x++){var v=y._soundById(S[x]);if(v){if(_||y._stopFade(S[x]),y._webAudio&&!v._muted){var P=t.ctx.currentTime,E=P+p/1e3;v._volume=a,v._node.gain.setValueAtTime(a,P),v._node.gain.linearRampToValueAtTime(c,E)}y._startFadeInterval(v,a,c,p,S[x],typeof _>"u")}}return y},_startFadeInterval:function(a,c,p,_,y,S){var x=this,v=c,P=p-c,E=Math.abs(P/.01),I=Math.max(4,E>0?_/E:_),F=Date.now();a._fadeTo=p,a._interval=setInterval(function(){var M=(Date.now()-F)/_;F=Date.now(),v+=P*M,v=Math.round(v*100)/100,P<0?v=Math.max(p,v):v=Math.min(p,v),x._webAudio?a._volume=v:x.volume(v,a._id,!0),S&&(x._volume=v),(p<c&&v<=p||p>c&&v>=p)&&(clearInterval(a._interval),a._interval=null,a._fadeTo=null,x.volume(p,a._id),x._emit("fade",a._id))},I)},_stopFade:function(a){var c=this,p=c._soundById(a);return p&&p._interval&&(c._webAudio&&p._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(p._interval),p._interval=null,c.volume(p._fadeTo,a),p._fadeTo=null,c._emit("fade",a)),c},loop:function(){var a=this,c=arguments,p,_,y;if(c.length===0)return a._loop;if(c.length===1)if(typeof c[0]=="boolean")p=c[0],a._loop=p;else return y=a._soundById(parseInt(c[0],10)),y?y._loop:!1;else c.length===2&&(p=c[0],_=parseInt(c[1],10));for(var S=a._getSoundIds(_),x=0;x<S.length;x++)y=a._soundById(S[x]),y&&(y._loop=p,a._webAudio&&y._node&&y._node.bufferSource&&(y._node.bufferSource.loop=p,p&&(y._node.bufferSource.loopStart=y._start||0,y._node.bufferSource.loopEnd=y._stop,a.playing(S[x])&&(a.pause(S[x],!0),a.play(S[x],!0)))));return a},rate:function(){var a=this,c=arguments,p,_;if(c.length===0)_=a._sounds[0]._id;else if(c.length===1){var y=a._getSoundIds(),S=y.indexOf(c[0]);S>=0?_=parseInt(c[0],10):p=parseFloat(c[0])}else c.length===2&&(p=parseFloat(c[0]),_=parseInt(c[1],10));var x;if(typeof p=="number"){if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"rate",action:function(){a.rate.apply(a,c)}}),a;typeof _>"u"&&(a._rate=p),_=a._getSoundIds(_);for(var v=0;v<_.length;v++)if(x=a._soundById(_[v]),x){a.playing(_[v])&&(x._rateSeek=a.seek(_[v]),x._playStart=a._webAudio?t.ctx.currentTime:x._playStart),x._rate=p,a._webAudio&&x._node&&x._node.bufferSource?x._node.bufferSource.playbackRate.setValueAtTime(p,t.ctx.currentTime):x._node&&(x._node.playbackRate=p);var P=a.seek(_[v]),E=(a._sprite[x._sprite][0]+a._sprite[x._sprite][1])/1e3-P,I=E*1e3/Math.abs(x._rate);(a._endTimers[_[v]]||!x._paused)&&(a._clearTimer(_[v]),a._endTimers[_[v]]=setTimeout(a._ended.bind(a,x),I)),a._emit("rate",x._id)}}else return x=a._soundById(_),x?x._rate:a._rate;return a},seek:function(){var a=this,c=arguments,p,_;if(c.length===0)a._sounds.length&&(_=a._sounds[0]._id);else if(c.length===1){var y=a._getSoundIds(),S=y.indexOf(c[0]);S>=0?_=parseInt(c[0],10):a._sounds.length&&(_=a._sounds[0]._id,p=parseFloat(c[0]))}else c.length===2&&(p=parseFloat(c[0]),_=parseInt(c[1],10));if(typeof _>"u")return 0;if(typeof p=="number"&&(a._state!=="loaded"||a._playLock))return a._queue.push({event:"seek",action:function(){a.seek.apply(a,c)}}),a;var x=a._soundById(_);if(x)if(typeof p=="number"&&p>=0){var v=a.playing(_);v&&a.pause(_,!0),x._seek=p,x._ended=!1,a._clearTimer(_),!a._webAudio&&x._node&&!isNaN(x._node.duration)&&(x._node.currentTime=p);var P=function(){v&&a.play(_,!0),a._emit("seek",_)};if(v&&!a._webAudio){var E=function(){a._playLock?setTimeout(E,0):P()};setTimeout(E,0)}else P()}else if(a._webAudio){var I=a.playing(_)?t.ctx.currentTime-x._playStart:0,F=x._rateSeek?x._rateSeek-x._seek:0;return x._seek+(F+I*Math.abs(x._rate))}else return x._node.currentTime;return a},playing:function(a){var c=this;if(typeof a=="number"){var p=c._soundById(a);return p?!p._paused:!1}for(var _=0;_<c._sounds.length;_++)if(!c._sounds[_]._paused)return!0;return!1},duration:function(a){var c=this,p=c._duration,_=c._soundById(a);return _&&(p=c._sprite[_._sprite][1]/1e3),p},state:function(){return this._state},unload:function(){for(var a=this,c=a._sounds,p=0;p<c.length;p++)c[p]._paused||a.stop(c[p]._id),a._webAudio||(a._clearSound(c[p]._node),c[p]._node.removeEventListener("error",c[p]._errorFn,!1),c[p]._node.removeEventListener(t._canPlayEvent,c[p]._loadFn,!1),c[p]._node.removeEventListener("ended",c[p]._endFn,!1),t._releaseHtml5Audio(c[p]._node)),delete c[p]._node,a._clearTimer(c[p]._id);var _=t._howls.indexOf(a);_>=0&&t._howls.splice(_,1);var y=!0;for(p=0;p<t._howls.length;p++)if(t._howls[p]._src===a._src||a._src.indexOf(t._howls[p]._src)>=0){y=!1;break}return s&&y&&delete s[a._src],t.noAudio=!1,a._state="unloaded",a._sounds=[],a=null,null},on:function(a,c,p,_){var y=this,S=y["_on"+a];return typeof c=="function"&&S.push(_?{id:p,fn:c,once:_}:{id:p,fn:c}),y},off:function(a,c,p){var _=this,y=_["_on"+a],S=0;if(typeof c=="number"&&(p=c,c=null),c||p)for(S=0;S<y.length;S++){var x=p===y[S].id;if(c===y[S].fn&&x||!c&&x){y.splice(S,1);break}}else if(a)_["_on"+a]=[];else{var v=Object.keys(_);for(S=0;S<v.length;S++)v[S].indexOf("_on")===0&&Array.isArray(_[v[S]])&&(_[v[S]]=[])}return _},once:function(a,c,p){var _=this;return _.on(a,c,p,1),_},_emit:function(a,c,p){for(var _=this,y=_["_on"+a],S=y.length-1;S>=0;S--)(!y[S].id||y[S].id===c||a==="load")&&(setTimeout((function(x){x.call(this,c,p)}).bind(_,y[S].fn),0),y[S].once&&_.off(a,y[S].fn,y[S].id));return _._loadQueue(a),_},_loadQueue:function(a){var c=this;if(c._queue.length>0){var p=c._queue[0];p.event===a&&(c._queue.shift(),c._loadQueue()),a||p.action()}return c},_ended:function(a){var c=this,p=a._sprite;if(!c._webAudio&&a._node&&!a._node.paused&&!a._node.ended&&a._node.currentTime<a._stop)return setTimeout(c._ended.bind(c,a),100),c;var _=!!(a._loop||c._sprite[p][2]);if(c._emit("end",a._id),!c._webAudio&&_&&c.stop(a._id,!0).play(a._id),c._webAudio&&_){c._emit("play",a._id),a._seek=a._start||0,a._rateSeek=0,a._playStart=t.ctx.currentTime;var y=(a._stop-a._start)*1e3/Math.abs(a._rate);c._endTimers[a._id]=setTimeout(c._ended.bind(c,a),y)}return c._webAudio&&!_&&(a._paused=!0,a._ended=!0,a._seek=a._start||0,a._rateSeek=0,c._clearTimer(a._id),c._cleanBuffer(a._node),t._autoSuspend()),!c._webAudio&&!_&&c.stop(a._id,!0),c},_clearTimer:function(a){var c=this;if(c._endTimers[a]){if(typeof c._endTimers[a]!="function")clearTimeout(c._endTimers[a]);else{var p=c._soundById(a);p&&p._node&&p._node.removeEventListener("ended",c._endTimers[a],!1)}delete c._endTimers[a]}return c},_soundById:function(a){for(var c=this,p=0;p<c._sounds.length;p++)if(a===c._sounds[p]._id)return c._sounds[p];return null},_inactiveSound:function(){var a=this;a._drain();for(var c=0;c<a._sounds.length;c++)if(a._sounds[c]._ended)return a._sounds[c].reset();return new r(a)},_drain:function(){var a=this,c=a._pool,p=0,_=0;if(!(a._sounds.length<c)){for(_=0;_<a._sounds.length;_++)a._sounds[_]._ended&&p++;for(_=a._sounds.length-1;_>=0;_--){if(p<=c)return;a._sounds[_]._ended&&(a._webAudio&&a._sounds[_]._node&&a._sounds[_]._node.disconnect(0),a._sounds.splice(_,1),p--)}}},_getSoundIds:function(a){var c=this;if(typeof a>"u"){for(var p=[],_=0;_<c._sounds.length;_++)p.push(c._sounds[_]._id);return p}else return[a]},_refreshBuffer:function(a){var c=this;return a._node.bufferSource=t.ctx.createBufferSource(),a._node.bufferSource.buffer=s[c._src],a._panner?a._node.bufferSource.connect(a._panner):a._node.bufferSource.connect(a._node),a._node.bufferSource.loop=a._loop,a._loop&&(a._node.bufferSource.loopStart=a._start||0,a._node.bufferSource.loopEnd=a._stop||0),a._node.bufferSource.playbackRate.setValueAtTime(a._rate,t.ctx.currentTime),c},_cleanBuffer:function(a){var c=this,p=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!a.bufferSource)return c;if(t._scratchBuffer&&a.bufferSource&&(a.bufferSource.onended=null,a.bufferSource.disconnect(0),p))try{a.bufferSource.buffer=t._scratchBuffer}catch{}return a.bufferSource=null,c},_clearSound:function(a){var c=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);c||(a.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(a){this._parent=a,this.init()};r.prototype={init:function(){var a=this,c=a._parent;return a._muted=c._muted,a._loop=c._loop,a._volume=c._volume,a._rate=c._rate,a._seek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++t._counter,c._sounds.push(a),a.create(),a},create:function(){var a=this,c=a._parent,p=t._muted||a._muted||a._parent._muted?0:a._volume;return c._webAudio?(a._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),a._node.gain.setValueAtTime(p,t.ctx.currentTime),a._node.paused=!0,a._node.connect(t.masterGain)):t.noAudio||(a._node=t._obtainHtml5Audio(),a._errorFn=a._errorListener.bind(a),a._node.addEventListener("error",a._errorFn,!1),a._loadFn=a._loadListener.bind(a),a._node.addEventListener(t._canPlayEvent,a._loadFn,!1),a._endFn=a._endListener.bind(a),a._node.addEventListener("ended",a._endFn,!1),a._node.src=c._src,a._node.preload=c._preload===!0?"auto":c._preload,a._node.volume=p*t.volume(),a._node.load()),a},reset:function(){var a=this,c=a._parent;return a._muted=c._muted,a._loop=c._loop,a._volume=c._volume,a._rate=c._rate,a._seek=0,a._rateSeek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++t._counter,a},_errorListener:function(){var a=this;a._parent._emit("loaderror",a._id,a._node.error?a._node.error.code:0),a._node.removeEventListener("error",a._errorFn,!1)},_loadListener:function(){var a=this,c=a._parent;c._duration=Math.ceil(a._node.duration*10)/10,Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue()),a._node.removeEventListener(t._canPlayEvent,a._loadFn,!1)},_endListener:function(){var a=this,c=a._parent;c._duration===1/0&&(c._duration=Math.ceil(a._node.duration*10)/10,c._sprite.__default[1]===1/0&&(c._sprite.__default[1]=c._duration*1e3),c._ended(a)),a._node.removeEventListener("ended",a._endFn,!1)}};var s={},o=function(a){var c=a._src;if(s[c]){a._duration=s[c].duration,f(a);return}if(/^data:[^;]+;base64,/.test(c)){for(var p=atob(c.split(",")[1]),_=new Uint8Array(p.length),y=0;y<p.length;++y)_[y]=p.charCodeAt(y);h(_.buffer,a)}else{var S=new XMLHttpRequest;S.open(a._xhr.method,c,!0),S.withCredentials=a._xhr.withCredentials,S.responseType="arraybuffer",a._xhr.headers&&Object.keys(a._xhr.headers).forEach(function(x){S.setRequestHeader(x,a._xhr.headers[x])}),S.onload=function(){var x=(S.status+"")[0];if(x!=="0"&&x!=="2"&&x!=="3"){a._emit("loaderror",null,"Failed loading audio file with status: "+S.status+".");return}h(S.response,a)},S.onerror=function(){a._webAudio&&(a._html5=!0,a._webAudio=!1,a._sounds=[],delete s[c],a.load())},l(S)}},l=function(a){try{a.send()}catch{a.onerror()}},h=function(a,c){var p=function(){c._emit("loaderror",null,"Decoding audio data failed.")},_=function(y){y&&c._sounds.length>0?(s[c._src]=y,f(c,y)):p()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(a).then(_).catch(p):t.ctx.decodeAudioData(a,_,p)},f=function(a,c){c&&!a._duration&&(a._duration=c.duration),Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue())},g=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var a=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),c=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=c?parseInt(c[1],10):null;if(a&&p&&p<9){var _=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!_&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};n.Howler=t,n.Howl=i,typeof at<"u"?(at.HowlerGlobal=e,at.Howler=t,at.Howl=i,at.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=i,window.Sound=r)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var r=i._howls.length-1;r>=0;r--)i._howls[r].stereo(t);return i},HowlerGlobal.prototype.pos=function(t,i,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,r=typeof r!="number"?s._pos[2]:r,typeof t=="number")s._pos=[t,i,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,i,r,s,o,l){var h=this;if(!h.ctx||!h.ctx.listener)return h;var f=h._orientation;if(i=typeof i!="number"?f[1]:i,r=typeof r!="number"?f[2]:r,s=typeof s!="number"?f[3]:s,o=typeof o!="number"?f[4]:o,l=typeof l!="number"?f[5]:l,typeof t=="number")h._orientation=[t,i,r,s,o,l],typeof h.ctx.listener.forwardX<"u"?(h.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),h.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),h.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),h.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),h.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),h.ctx.listener.upZ.setTargetAtTime(l,Howler.ctx.currentTime,.1)):h.ctx.listener.setOrientation(t,i,r,s,o,l);else return f;return h},Howl.prototype.init=function(t){return function(i){var r=this;return r._orientation=i.orientation||[1,0,0],r._stereo=i.stereo||null,r._pos=i.pos||null,r._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},r._onstereo=i.onstereo?[{fn:i.onstereo}]:[],r._onpos=i.onpos?[{fn:i.onpos}]:[],r._onorientation=i.onorientation?[{fn:i.onorientation}]:[],t.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,i){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(t,i)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof t=="number")r._stereo=t,r._pos=[t,0,0];else return r._stereo;for(var o=r._getSoundIds(i),l=0;l<o.length;l++){var h=r._soundById(o[l]);if(h)if(typeof t=="number")h._stereo=t,h._pos=[t,0,0],h._node&&(h._pannerAttr.panningModel="equalpower",(!h._panner||!h._panner.pan)&&e(h,s),s==="spatial"?typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):h._panner.setPosition(t,0,0):h._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",h._id);else return h._stereo}return r},Howl.prototype.pos=function(t,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(t,i,r,s)}}),o;if(i=typeof i!="number"?0:i,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof t=="number")o._pos=[t,i,r];else return o._pos;for(var l=o._getSoundIds(s),h=0;h<l.length;h++){var f=o._soundById(l[h]);if(f)if(typeof t=="number")f._pos=[t,i,r],f._node&&((!f._panner||f._panner.pan)&&e(f,"spatial"),typeof f._panner.positionX<"u"?(f._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):f._panner.setPosition(t,i,r)),o._emit("pos",f._id);else return f._pos}return o},Howl.prototype.orientation=function(t,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(t,i,r,s)}}),o;if(i=typeof i!="number"?o._orientation[1]:i,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof t=="number")o._orientation=[t,i,r];else return o._orientation;for(var l=o._getSoundIds(s),h=0;h<l.length;h++){var f=o._soundById(l[h]);if(f)if(typeof t=="number")f._orientation=[t,i,r],f._node&&(f._panner||(f._pos||(f._pos=o._pos||[0,0,-.5]),e(f,"spatial")),typeof f._panner.orientationX<"u"?(f._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),f._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):f._panner.setOrientation(t,i,r)),o._emit("orientation",f._id);else return f._orientation}return o},Howl.prototype.pannerAttr=function(){var t=this,i=arguments,r,s,o;if(!t._webAudio)return t;if(i.length===0)return t._pannerAttr;if(i.length===1)if(typeof i[0]=="object")r=i[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),t._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:t._panningModel});else return o=t._soundById(parseInt(i[0],10)),o?o._pannerAttr:t._pannerAttr;else i.length===2&&(r=i[0],s=parseInt(i[1],10));for(var l=t._getSoundIds(s),h=0;h<l.length;h++)if(o=t._soundById(l[h]),o){var f=o._pannerAttr;f={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:f.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:f.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:f.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:f.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:f.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:f.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:f.panningModel};var g=o._panner;g||(o._pos||(o._pos=t._pos||[0,0,-.5]),e(o,"spatial"),g=o._panner),g.coneInnerAngle=f.coneInnerAngle,g.coneOuterAngle=f.coneOuterAngle,g.coneOuterGain=f.coneOuterGain,g.distanceModel=f.distanceModel,g.maxDistance=f.maxDistance,g.refDistance=f.refDistance,g.rolloffFactor=f.rolloffFactor,g.panningModel=f.panningModel}return t},Sound.prototype.init=function(t){return function(){var i=this,r=i._parent;i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,t.call(this),i._stereo?r.stereo(i._stereo):i._pos&&r.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var i=this,r=i._parent;return i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,i._stereo?r.stereo(i._stereo):i._pos?r.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,r._refreshBuffer(i)),t.call(this)}}(Sound.prototype.reset);var e=function(t,i){i=i||"spatial",i==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(fn);class Z{static loadAssets(){return Promise.all([this.loadImages(),this.loadSounds(),this.loadAtlasData(this.tileAtlasPositions,jo),this.loadAtlasData(this.spriteAtlasPositions,Zo),this.loadFonts()])}static async loadImages(){this.tileAtlas=await this.loadImage(Vo),this.spriteAtlas=await this.loadImage(Ho),this.selectionIndicator=await this.loadImage(Qo),this.fullScreenIcon=await this.loadImage(ta),this.deathCountIcon=await this.loadImage(ia),this.lobbyBackground=await this.loadImage(ra)}static async loadSounds(){this.coinSound=await this.loadAudio(ea)}static async loadFonts(){await this.loadFont("inter","/fonts/Inter-Regular.ttf"),await document.fonts.ready}static loadAudio(e){return new Promise((t,i)=>{const r=new fn.Howl({src:[e],preload:!0,onloaderror:i});r.once("load",()=>t(r))})}static loadImage(e){return new Promise((t,i)=>{const r=new Image;r.onload=()=>t(r),r.onerror=i,r.src=e})}static loadFont(e,t){return new Promise((i,r)=>{const s=new FontFace(e,`url(${t})`);s.load().then(()=>{document.fonts.add(s),i()}).catch(r)})}static loadAtlasData(e,t){for(const i of t.frames)e[i.filename]={x:i.frame.x,y:i.frame.y,w:i.frame.w,h:i.frame.h}}static getTileAtlasPosition(e){return this.tileAtlasPositions[e]}static getSpriteAtlasPosition(e){return this.spriteAtlasPositions[e]}static registerTexture(e,t,i,r){e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,i.width,i.height,0,e.RGBA,e.UNSIGNED_BYTE,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}}m(Z,"tileAtlas"),m(Z,"spriteAtlas"),m(Z,"selectionIndicator"),m(Z,"fullScreenIcon"),m(Z,"deathCountIcon"),m(Z,"lobbyBackground"),m(Z,"coinSound"),m(Z,"tileAtlasPositions",{}),m(Z,"spriteAtlasPositions",{});class U{static registerKeyBind(e,t){this.keyBinds[e]=t,this.keyState[e]=!1}static handleKeyEvent(e,t){if(!this.isActiveElementInput()){if(e.repeat){e.preventDefault();return}for(const i in this.keyBinds)if(this.keyBinds[i].includes(e.code)){this.keyState[e.code]=t,t&&(this.justKeyState[e.code]=t),e.preventDefault();break}}}static handleMouseButtonEvent(e,t){t&&this.blurActiveElement(),this.mouseState[e.button]=t,e.preventDefault()}static handleMouseMoveEvent(e){this.mouseX=e.offsetX,this.mouseY=e.offsetY}static releaseKeys(){for(const e in this.keyState)this.keyState[e]=!1,this.justKeyState[e]=!1}static releaseMouse(){this.mouseState=[]}static isKeyDown(e){if(this.isActiveElementInput())return this.releaseKeys(),!1;for(const t of this.keyBinds[e])if(this.keyState[t])return!0;return!1}static isKeyJustDown(e){if(this.isActiveElementInput())return this.releaseKeys(),!1;for(const t of this.keyBinds[e])if(this.justKeyState[t])return this.justKeyState[t]=!1,!0;return!1}static getKeyBinds(e){return this.keyBinds[e]}static isMouseDown(e){switch(e){case"left":return this.mouseState[0];case"middle":return this.mouseState[1];case"right":return this.mouseState[2]}return!1}static forceFocus(){this.isActiveElementInput()||window.focus()}static isActiveElementInput(){const e=document.activeElement;return e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement}static initialize(e){addEventListener("keydown",t=>this.handleKeyEvent(t,!0)),addEventListener("keyup",t=>this.handleKeyEvent(t,!1)),addEventListener("mouseup",t=>this.handleMouseButtonEvent(t,!1)),addEventListener("blur",t=>this.releaseKeys()),e.addEventListener("contextmenu",t=>{this.isActiveElementInput()||t.preventDefault()})}static blurActiveElement(){const e=document.activeElement;(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&e.blur()}static addCanvasListeners(e){e.addEventListener("mousedown",t=>this.handleMouseButtonEvent(t,!0)),e.addEventListener("mousemove",t=>this.handleMouseMoveEvent(t)),e.addEventListener("mouseleave",t=>this.releaseMouse())}}m(U,"keyBinds",{}),m(U,"keyState",{}),m(U,"justKeyState",{}),m(U,"mouseState",{}),m(U,"mouseInCanvas",!1),m(U,"mouseX",0),m(U,"mouseY",0);var N=(n=>(n[n.Background=0]="Background",n[n.Foreground=1]="Foreground",n[n.AbovePlayers=2]="AbovePlayers",n[n.Numbers=3]="Numbers",n))(N||{}),w=(n=>(n[n.Empty=0]="Empty",n[n.GravityLeft=1]="GravityLeft",n[n.GravityUp=2]="GravityUp",n[n.GravityRight=3]="GravityRight",n[n.GravityDown=4]="GravityDown",n[n.GravityDot=5]="GravityDot",n[n.GravitySlowDot=6]="GravitySlowDot",n[n.BoostLeft=7]="BoostLeft",n[n.BoostUp=8]="BoostUp",n[n.BoostRight=9]="BoostRight",n[n.BoostDown=10]="BoostDown",n[n.Crown=11]="Crown",n[n.Coin=12]="Coin",n[n.BlueCoin=13]="BlueCoin",n[n.SpawnPoint=14]="SpawnPoint",n[n.Checkpoint=15]="Checkpoint",n[n.Portal=16]="Portal",n[n.PortalInvisible=17]="PortalInvisible",n[n.Water=18]="Water",n[n.WaterSurface=19]="WaterSurface",n[n.KeyRed=20]="KeyRed",n[n.KeyGreen=21]="KeyGreen",n[n.KeyBlue=22]="KeyBlue",n[n.KeyDoorRed=23]="KeyDoorRed",n[n.KeyDoorGreen=24]="KeyDoorGreen",n[n.KeyDoorBlue=25]="KeyDoorBlue",n[n.CoinDoor=26]="CoinDoor",n[n.BlueCoinDoor=27]="BlueCoinDoor",n[n.KeyGateRed=28]="KeyGateRed",n[n.KeyGateGreen=29]="KeyGateGreen",n[n.KeyGateBlue=30]="KeyGateBlue",n[n.CoinGate=31]="CoinGate",n[n.BlueCoinGate=32]="BlueCoinGate",n[n.LocalSwitch=33]="LocalSwitch",n[n.LocalSwitchActivator=34]="LocalSwitchActivator",n[n.LocalSwitchResetter=35]="LocalSwitchResetter",n[n.LocalSwitchDoor=36]="LocalSwitchDoor",n[n.LocalSwitchGate=37]="LocalSwitchGate",n[n.GlobalSwitch=38]="GlobalSwitch",n[n.GlobalSwitchActivator=39]="GlobalSwitchActivator",n[n.GlobalSwitchResetter=40]="GlobalSwitchResetter",n[n.GlobalSwitchDoor=41]="GlobalSwitchDoor",n[n.GlobalSwitchGate=42]="GlobalSwitchGate",n[n.DeathDoor=43]="DeathDoor",n[n.DeathGate=44]="DeathGate",n[n.Spikes=45]="Spikes",n[n.SpikesCenter=46]="SpikesCenter",n[n.Fire=47]="Fire",n[n.BasicGray=48]="BasicGray",n[n.BasicBlue=49]="BasicBlue",n[n.BasicMagenta=50]="BasicMagenta",n[n.BasicRed=51]="BasicRed",n[n.BasicYellow=52]="BasicYellow",n[n.BasicGreen=53]="BasicGreen",n[n.BasicCyan=54]="BasicCyan",n[n.BasicGrayBg=55]="BasicGrayBg",n[n.BasicBlueBg=56]="BasicBlueBg",n[n.BasicMagentaBg=57]="BasicMagentaBg",n[n.BasicRedBg=58]="BasicRedBg",n[n.BasicYellowBg=59]="BasicYellowBg",n[n.BasicGreenBg=60]="BasicGreenBg",n[n.BasicCyanBg=61]="BasicCyanBg",n[n.BeveledMagenta=62]="BeveledMagenta",n[n.BeveledGreen=63]="BeveledGreen",n[n.BeveledBlue=64]="BeveledBlue",n[n.BeveledRed=65]="BeveledRed",n[n.BeveledYellow=66]="BeveledYellow",n[n.BeveledGray=67]="BeveledGray",n[n.BricksBrown=68]="BricksBrown",n[n.BricksTeal=69]="BricksTeal",n[n.BricksPurple=70]="BricksPurple",n[n.BricksGreen=71]="BricksGreen",n[n.BricksRed=72]="BricksRed",n[n.BricksOlive=73]="BricksOlive",n[n.BricksBrownBg=74]="BricksBrownBg",n[n.BricksTealBg=75]="BricksTealBg",n[n.BricksPurpleBg=76]="BricksPurpleBg",n[n.BricksGreenBg=77]="BricksGreenBg",n[n.BricksRedBg=78]="BricksRedBg",n[n.BricksOliveBg=79]="BricksOliveBg",n[n.NormalGrayBg=80]="NormalGrayBg",n[n.NormalBlueBg=81]="NormalBlueBg",n[n.NormalMagentaBg=82]="NormalMagentaBg",n[n.NormalRedBg=83]="NormalRedBg",n[n.NormalYellowBg=84]="NormalYellowBg",n[n.NormalGreenBg=85]="NormalGreenBg",n[n.NormalCyanBg=86]="NormalCyanBg",n[n.DarkGrayBg=87]="DarkGrayBg",n[n.DarkBlueBg=88]="DarkBlueBg",n[n.DarkMagentaBg=89]="DarkMagentaBg",n[n.DarkRedBg=90]="DarkRedBg",n[n.DarkYellowBg=91]="DarkYellowBg",n[n.DarkGreenBg=92]="DarkGreenBg",n[n.DarkCyanBg=93]="DarkCyanBg",n[n.CheckerGrayBg=94]="CheckerGrayBg",n[n.CheckerBlueBg=95]="CheckerBlueBg",n[n.CheckerMagentaBg=96]="CheckerMagentaBg",n[n.CheckerRedBg=97]="CheckerRedBg",n[n.CheckerYellowBg=98]="CheckerYellowBg",n[n.CheckerGreenBg=99]="CheckerGreenBg",n[n.CheckerCyanBg=100]="CheckerCyanBg",n[n.PastelLightTanBg=101]="PastelLightTanBg",n[n.PastelLightGreenBg=102]="PastelLightGreenBg",n[n.PastelReefBg=103]="PastelReefBg",n[n.PastelLightCyanBg=104]="PastelLightCyanBg",n[n.PastelBlueBg=105]="PastelBlueBg",n[n.PastelLightSalmonPinkBg=106]="PastelLightSalmonPinkBg",n[n.BricksGrass=107]="BricksGrass",n[n.BricksGrassLeftEdge=108]="BricksGrassLeftEdge",n[n.BricksGrassRightEdge=109]="BricksGrassRightEdge",n[n.MetalSilver=110]="MetalSilver",n[n.MetalCopper=111]="MetalCopper",n[n.MetalGold=112]="MetalGold",n[n.HazardStripes=113]="HazardStripes",n[n.FaceBlock=114]="FaceBlock",n[n.BlackBlock=115]="BlackBlock",n[n.FullBlackBlock=116]="FullBlackBlock",n[n.SecretAppear=117]="SecretAppear",n[n.SecretDisappear=118]="SecretDisappear",n[n.FactoryMetalCrate=119]="FactoryMetalCrate",n[n.FactoryStone=120]="FactoryStone",n[n.FactoryWood=121]="FactoryWood",n[n.FactoryWoodenCrate=122]="FactoryWoodenCrate",n[n.FactoryScales=123]="FactoryScales",n[n.GlassRed=124]="GlassRed",n[n.GlassOrange=125]="GlassOrange",n[n.GlassYellow=126]="GlassYellow",n[n.GlassGreen=127]="GlassGreen",n[n.GlassCyan=128]="GlassCyan",n[n.GlassBlue=129]="GlassBlue",n[n.GlassPurple=130]="GlassPurple",n[n.GlassMagenta=131]="GlassMagenta",n[n.MeadowGrassLeft=132]="MeadowGrassLeft",n[n.MeadowGrassMiddle=133]="MeadowGrassMiddle",n[n.MeadowGrassRight=134]="MeadowGrassRight",n[n.MeadowBushLeft=135]="MeadowBushLeft",n[n.MeadowBushMiddle=136]="MeadowBushMiddle",n[n.MeadowBushRight=137]="MeadowBushRight",n[n.MeadowYellowFlower=138]="MeadowYellowFlower",n[n.MeadowSmallBush=139]="MeadowSmallBush",n[n.EasterEggsBlue=140]="EasterEggsBlue",n[n.EasterEggsPink=141]="EasterEggsPink",n[n.EasterEggsYellow=142]="EasterEggsYellow",n[n.EasterEggsRed=143]="EasterEggsRed",n[n.EasterEggsGreen=144]="EasterEggsGreen",n[n.CandyPink=145]="CandyPink",n[n.CandyBlue=146]="CandyBlue",n[n.CandyPlatformPink=147]="CandyPlatformPink",n[n.CandyPlatformRed=148]="CandyPlatformRed",n[n.CandyPlatformCyan=149]="CandyPlatformCyan",n[n.CandyPlatformGreen=150]="CandyPlatformGreen",n[n.CandyCane=151]="CandyCane",n[n.CandyLicorice=152]="CandyLicorice",n[n.CandyChocolate=153]="CandyChocolate",n[n.CandyCreamSmall=154]="CandyCreamSmall",n[n.CandyCreamLarge=155]="CandyCreamLarge",n[n.CandyGumdropRed=156]="CandyGumdropRed",n[n.CandyGumdropGreen=157]="CandyGumdropGreen",n[n.CandyGumdropPink=158]="CandyGumdropPink",n[n.CandyPinkBg=159]="CandyPinkBg",n[n.CandyBlueBg=160]="CandyBlueBg",n))(w||{}),Q=(n=>(n[n.Background=0]="Background",n[n.Foreground=1]="Foreground",n))(Q||{});class A{constructor(e,t,i,r){m(this,"id");m(this,"layer");m(this,"shadow");m(this,"tileset");m(this,"minimapColor");m(this,"frames",1);m(this,"frameTime",1);m(this,"frameStaggerMult",1);m(this,"renderLayer");m(this,"hasNumber",!1);m(this,"hasNumberShadow",!1);m(this,"blockTab");m(this,"collisionType","full");m(this,"isLadder",!1);m(this,"isLiquid",!1);m(this,"isHazard",!1);m(this,"isBoost",!1);m(this,"boostX",0);m(this,"boostY",0);m(this,"displayImage");this.id=e,this.layer=t,this.tileset=i,this.blockTab=r,this.renderLayer=t==Q.Foreground?N.Foreground:N.Background,e==w.Empty&&(this.renderLayer=N.Background),this.shadow=t==Q.Foreground,this.displayImage=this.generateDisplayImage()}noShadow(){return this.shadow=!1,this}nonSolid(){return this.collisionType="none",this}platform(){return this.collisionType="platform",this}animated(e,t,i=0){return this.frames=e,this.frameTime=t,this.frameStaggerMult=i,this}abovePlayers(){return this.renderLayer=N.AbovePlayers,this}number(e){return this.hasNumber=!0,this.hasNumberShadow=e,this}minimap(e){return this.minimapColor=e,this}ladderPhysics(){return this.isLadder=!0,this}liquidPhysics(){return this.isLiquid=!0,this}hazard(){return this.isHazard=!0,this}boost(e,t){return this.isBoost=!0,this.boostX=e,this.boostY=t,this}static getById(e){return ht.blocks[e]}getBlockImage(){const e=Z.tileAtlasPositions[this.tileset];if(!e)throw new Error(`Tileset not found while loading block ${this.id} with tileset ${this.tileset}`);const t=Z.tileAtlas,i=document.createElement("canvas"),r=i.getContext("2d");return i.width=16,i.height=16,r.drawImage(t,e.x,e.y,16,16,0,0,16,16),i}generateDisplayImage(e=!0){const t=Z.tileAtlasPositions["extra/empty"];if(!t)throw new Error(`Tileset not found while loading block ${this.id}`);const i=Z.tileAtlas,r=document.createElement("canvas"),s=r.getContext("2d");r.width=16,r.height=16,this.layer==Q.Foreground&&e&&s.drawImage(i,t.x,t.y,16,16,0,0,16,16),s.drawImage(this.getBlockImage(),0,0,16,16,0,0,16,16);const o=new Image;return o.src=r.toDataURL("image/png"),o}generateMinimapColor(){const i=this.getBlockImage().getContext("2d").getImageData(0,0,16,16).data;let r=0,s=0,o=0;for(let h=0;h<i.length;h+=4)r+=i[h],s+=i[h+1],o+=i[h+2];const l=i.length/4;r/=l,s/=l,o/=l,this.minimapColor=255<<24|r<<16|s<<8|o}}class ee{constructor(e){m(this,"name");m(this,"blocks",[]);this.name=e}addBlock(e){this.blocks.push(e)}}var C=(n=>(n[n.Blocks=0]="Blocks",n[n.Action=1]="Action",n[n.Decorations=2]="Decorations",n[n.Backgrounds=3]="Backgrounds",n))(C||{});const Ot=class Ot{constructor(e,t,i){m(this,"id");m(this,"name");m(this,"spriteName");m(this,"displayImage");this.id=e,this.name=t,this.spriteName=i,this.displayImage=this.generateDisplayImage()}generateDisplayImage(){const e=Z.spriteAtlas,t=Z.getSpriteAtlasPosition(this.spriteName),i=document.createElement("canvas"),r=i.getContext("2d");i.width=26,i.height=26,r.drawImage(e,t.x,t.y,Ot.SMILEY_SIZE,Ot.SMILEY_SIZE,0,0,Ot.SMILEY_SIZE,Ot.SMILEY_SIZE);const s=new Image;return s.src=i.toDataURL(),s}static getById(e){return ht.smileys[e]}};m(Ot,"SMILEY_SIZE",26);let _e=Ot;class ht{static initSmileys(){this.addSmiley(new _e(0,"Smiley","smileys/smiley")),this.addSmiley(new _e(1,"Grin","smileys/grin")),this.addSmiley(new _e(2,"Tongue","smileys/tongue")),this.addSmiley(new _e(3,"Happy","smileys/happy")),this.addSmiley(new _e(4,"Annoyed","smileys/annoyed")),this.addSmiley(new _e(5,"Sad","smileys/sad")),this.addSmiley(new _e(6,"Surprised","smileys/surprised")),this.addSmiley(new _e(7,"Indifferent","smileys/indifferent")),this.addSmiley(new _e(8,"Crying","smileys/cry")),this.addSmiley(new _e(9,"Wink","smileys/wink")),this.addSmiley(new _e(10,"Frustrated","smileys/frustrated")),this.addSmiley(new _e(11,"Shades","smileys/shades")),this.addSmiley(new _e(12,"Devil","smileys/devil")),this.addSmiley(new _e(13,"Inquisitive","smileys/inquisitive"))}static initBlocks(){const e=Q.Foreground,t=Q.Background,i=new ee("Gravity");i.addBlock(new A(w.Empty,e,"extra/empty",C.Action).nonSolid().noShadow().minimap(null)),i.addBlock(new A(w.GravityLeft,e,"foreground/gravity/left",C.Action).nonSolid().noShadow().minimap(null)),i.addBlock(new A(w.GravityUp,e,"foreground/gravity/up",C.Action).nonSolid().noShadow().minimap(null)),i.addBlock(new A(w.GravityRight,e,"foreground/gravity/right",C.Action).nonSolid().noShadow().minimap(null)),i.addBlock(new A(w.GravityDown,e,"foreground/gravity/down",C.Action).nonSolid().noShadow().minimap(null)),i.addBlock(new A(w.GravityDot,e,"foreground/gravity/dot",C.Action).nonSolid().noShadow().minimap(null)),i.addBlock(new A(w.GravitySlowDot,e,"foreground/gravity/slow_dot",C.Action).nonSolid().noShadow().ladderPhysics().minimap(null)),this.addPackage(i);const r=new ee("Boost");r.addBlock(new A(w.BoostLeft,e,"foreground/boost/left",C.Action).boost(-1,0).nonSolid().noShadow().minimap(null)),r.addBlock(new A(w.BoostUp,e,"foreground/boost/up",C.Action).boost(0,-1).nonSolid().noShadow().minimap(null)),r.addBlock(new A(w.BoostRight,e,"foreground/boost/right",C.Action).boost(1,0).nonSolid().noShadow().minimap(null)),r.addBlock(new A(w.BoostDown,e,"foreground/boost/down",C.Action).boost(0,1).nonSolid().noShadow().minimap(null)),this.addPackage(r);const s=new ee("Crown");s.addBlock(new A(w.Crown,e,"foreground/crown",C.Action).nonSolid()),this.addPackage(s);const o=new ee("Coins");o.addBlock(new A(w.Coin,e,"foreground/coins/coin",C.Action).nonSolid().noShadow().animated(13,3,4).abovePlayers().minimap(null)),o.addBlock(new A(w.BlueCoin,e,"foreground/coins/blue_coin",C.Action).nonSolid().noShadow().animated(13,3,4).abovePlayers().minimap(null)),this.addPackage(o);const l=new ee("Spawn");l.addBlock(new A(w.SpawnPoint,e,"foreground/spawn/spawn_point",C.Action).nonSolid().noShadow().minimap(null)),l.addBlock(new A(w.Checkpoint,e,"foreground/spawn/checkpoint",C.Action).nonSolid().noShadow().minimap(null)),this.addPackage(l);const h=new ee("Portal");h.addBlock(new A(w.Portal,e,"foreground/portal/left",C.Action).nonSolid().animated(15,6,3)),h.addBlock(new A(w.PortalInvisible,e,"foreground/portal/invisible",C.Action).nonSolid().noShadow().minimap(null)),this.addPackage(h);const f=new ee("Liquids");f.addBlock(new A(w.Water,e,"foreground/liquids/water",C.Action).nonSolid().liquidPhysics().abovePlayers().noShadow()),f.addBlock(new A(w.WaterSurface,e,"foreground/liquids/water_surface",C.Action).nonSolid().abovePlayers().noShadow().animated(8,15,0)),this.addPackage(f);const g=new ee("Keys");g.addBlock(new A(w.KeyRed,e,"foreground/keys/key_red",C.Action).nonSolid()),g.addBlock(new A(w.KeyGreen,e,"foreground/keys/key_green",C.Action).nonSolid()),g.addBlock(new A(w.KeyBlue,e,"foreground/keys/key_blue",C.Action).nonSolid()),this.addPackage(g);const a=new ee("Doors");a.addBlock(new A(w.KeyDoorRed,e,"foreground/keys/key_door_red",C.Action)),a.addBlock(new A(w.KeyDoorGreen,e,"foreground/keys/key_door_green",C.Action)),a.addBlock(new A(w.KeyDoorBlue,e,"foreground/keys/key_door_blue",C.Action)),a.addBlock(new A(w.CoinDoor,e,"foreground/coin_doors_and_gates/coin_door",C.Action).number(!1)),a.addBlock(new A(w.BlueCoinDoor,e,"foreground/coin_doors_and_gates/blue_coin_door",C.Action).number(!0)),this.addPackage(a);const c=new ee("Gates");c.addBlock(new A(w.KeyGateRed,e,"foreground/keys/key_gate_red",C.Action).nonSolid().noShadow()),c.addBlock(new A(w.KeyGateGreen,e,"foreground/keys/key_gate_green",C.Action).nonSolid().noShadow()),c.addBlock(new A(w.KeyGateBlue,e,"foreground/keys/key_gate_blue",C.Action).nonSolid().noShadow()),c.addBlock(new A(w.CoinGate,e,"foreground/coin_doors_and_gates/coin_gate",C.Action).nonSolid().noShadow().number(!0)),c.addBlock(new A(w.BlueCoinGate,e,"foreground/coin_doors_and_gates/blue_coin_gate",C.Action).nonSolid().noShadow().number(!0)),this.addPackage(c);const p=new ee("Switches");p.addBlock(new A(w.LocalSwitch,e,"foreground/switches/local_switch",C.Action).nonSolid().noShadow().minimap(null).number(!0)),p.addBlock(new A(w.LocalSwitchActivator,e,"foreground/switches/local_setter",C.Action).nonSolid().noShadow().minimap(null).number(!0)),p.addBlock(new A(w.LocalSwitchResetter,e,"foreground/switches/local_resetter",C.Action).nonSolid().noShadow().minimap(null)),p.addBlock(new A(w.LocalSwitchDoor,e,"foreground/switches/local_door",C.Action).number(!0)),p.addBlock(new A(w.LocalSwitchGate,e,"foreground/switches/local_gate",C.Action).nonSolid().number(!0).noShadow()),p.addBlock(new A(w.GlobalSwitch,e,"foreground/switches/global_switch",C.Action).nonSolid().noShadow().minimap(null).number(!0)),p.addBlock(new A(w.GlobalSwitchActivator,e,"foreground/switches/global_setter",C.Action).nonSolid().noShadow().minimap(null).number(!0)),p.addBlock(new A(w.GlobalSwitchResetter,e,"foreground/switches/global_resetter",C.Action).nonSolid().noShadow().minimap(null)),p.addBlock(new A(w.GlobalSwitchDoor,e,"foreground/switches/global_door",C.Action).number(!0)),p.addBlock(new A(w.GlobalSwitchGate,e,"foreground/switches/global_gate",C.Action).nonSolid().number(!0).noShadow()),this.addPackage(p);const _=new ee("Death");_.addBlock(new A(w.DeathDoor,e,"foreground/death/death_door",C.Action).number(!1).minimap(null)),_.addBlock(new A(w.DeathGate,e,"foreground/death/death_gate",C.Action).number(!0).nonSolid().noShadow().minimap(null)),this.addPackage(_);const y=new ee("Hazards");y.addBlock(new A(w.Spikes,e,"foreground/hazards/spikes",C.Action).nonSolid().hazard().noShadow().minimap(null)),y.addBlock(new A(w.SpikesCenter,e,"foreground/hazards/spikes_center",C.Action).nonSolid().hazard().noShadow().minimap(null)),y.addBlock(new A(w.Fire,e,"foreground/hazards/fire",C.Action).nonSolid().hazard().abovePlayers().noShadow().minimap(null).animated(12,3,4)),this.addPackage(y);const S=new ee("Basic");S.addBlock(new A(w.BasicGray,e,"foreground/basic/gray",C.Blocks)),S.addBlock(new A(w.BasicBlue,e,"foreground/basic/blue",C.Blocks)),S.addBlock(new A(w.BasicMagenta,e,"foreground/basic/magenta",C.Blocks)),S.addBlock(new A(w.BasicRed,e,"foreground/basic/red",C.Blocks)),S.addBlock(new A(w.BasicYellow,e,"foreground/basic/yellow",C.Blocks)),S.addBlock(new A(w.BasicGreen,e,"foreground/basic/green",C.Blocks)),S.addBlock(new A(w.BasicCyan,e,"foreground/basic/cyan",C.Blocks)),S.addBlock(new A(w.BasicGrayBg,t,"background/basic/gray",C.Backgrounds)),S.addBlock(new A(w.BasicBlueBg,t,"background/basic/blue",C.Backgrounds)),S.addBlock(new A(w.BasicMagentaBg,t,"background/basic/magenta",C.Backgrounds)),S.addBlock(new A(w.BasicRedBg,t,"background/basic/red",C.Backgrounds)),S.addBlock(new A(w.BasicYellowBg,t,"background/basic/yellow",C.Backgrounds)),S.addBlock(new A(w.BasicGreenBg,t,"background/basic/green",C.Backgrounds)),S.addBlock(new A(w.BasicCyanBg,t,"background/basic/cyan",C.Backgrounds)),this.addPackage(S);const x=new ee("Beveled");x.addBlock(new A(w.BeveledMagenta,e,"foreground/beveled/magenta",C.Blocks)),x.addBlock(new A(w.BeveledGreen,e,"foreground/beveled/green",C.Blocks)),x.addBlock(new A(w.BeveledBlue,e,"foreground/beveled/blue",C.Blocks)),x.addBlock(new A(w.BeveledRed,e,"foreground/beveled/red",C.Blocks)),x.addBlock(new A(w.BeveledYellow,e,"foreground/beveled/yellow",C.Blocks)),x.addBlock(new A(w.BeveledGray,e,"foreground/beveled/gray",C.Blocks)),this.addPackage(x);const v=new ee("Bricks");v.addBlock(new A(w.BricksBrown,e,"foreground/bricks/brown",C.Blocks)),v.addBlock(new A(w.BricksTeal,e,"foreground/bricks/teal",C.Blocks)),v.addBlock(new A(w.BricksPurple,e,"foreground/bricks/purple",C.Blocks)),v.addBlock(new A(w.BricksGreen,e,"foreground/bricks/green",C.Blocks)),v.addBlock(new A(w.BricksRed,e,"foreground/bricks/red",C.Blocks)),v.addBlock(new A(w.BricksOlive,e,"foreground/bricks/olive",C.Blocks)),v.addBlock(new A(w.BricksBrownBg,t,"background/bricks/brown",C.Backgrounds)),v.addBlock(new A(w.BricksTealBg,t,"background/bricks/teal",C.Backgrounds)),v.addBlock(new A(w.BricksPurpleBg,t,"background/bricks/purple",C.Backgrounds)),v.addBlock(new A(w.BricksGreenBg,t,"background/bricks/green",C.Backgrounds)),v.addBlock(new A(w.BricksRedBg,t,"background/bricks/red",C.Backgrounds)),v.addBlock(new A(w.BricksOliveBg,t,"background/bricks/olive",C.Backgrounds)),this.addPackage(v);const P=new ee("Normal");P.addBlock(new A(w.NormalGrayBg,t,"background/normal/gray",C.Backgrounds)),P.addBlock(new A(w.NormalBlueBg,t,"background/normal/blue",C.Backgrounds)),P.addBlock(new A(w.NormalMagentaBg,t,"background/normal/magenta",C.Backgrounds)),P.addBlock(new A(w.NormalRedBg,t,"background/normal/red",C.Backgrounds)),P.addBlock(new A(w.NormalYellowBg,t,"background/normal/yellow",C.Backgrounds)),P.addBlock(new A(w.NormalGreenBg,t,"background/normal/green",C.Backgrounds)),P.addBlock(new A(w.NormalCyanBg,t,"background/normal/cyan",C.Backgrounds)),this.addPackage(P);const E=new ee("Dark");E.addBlock(new A(w.DarkGrayBg,t,"background/dark/gray",C.Backgrounds)),E.addBlock(new A(w.DarkBlueBg,t,"background/dark/blue",C.Backgrounds)),E.addBlock(new A(w.DarkMagentaBg,t,"background/dark/magenta",C.Backgrounds)),E.addBlock(new A(w.DarkRedBg,t,"background/dark/red",C.Backgrounds)),E.addBlock(new A(w.DarkYellowBg,t,"background/dark/yellow",C.Backgrounds)),E.addBlock(new A(w.DarkGreenBg,t,"background/dark/green",C.Backgrounds)),E.addBlock(new A(w.DarkCyanBg,t,"background/dark/cyan",C.Backgrounds)),this.addPackage(E);const I=new ee("Checker");I.addBlock(new A(w.CheckerGrayBg,t,"background/checker/gray",C.Backgrounds)),I.addBlock(new A(w.CheckerBlueBg,t,"background/checker/blue",C.Backgrounds)),I.addBlock(new A(w.CheckerMagentaBg,t,"background/checker/magenta",C.Backgrounds)),I.addBlock(new A(w.CheckerRedBg,t,"background/checker/red",C.Backgrounds)),I.addBlock(new A(w.CheckerYellowBg,t,"background/checker/yellow",C.Backgrounds)),I.addBlock(new A(w.CheckerGreenBg,t,"background/checker/green",C.Backgrounds)),I.addBlock(new A(w.CheckerCyanBg,t,"background/checker/cyan",C.Backgrounds)),this.addPackage(I);const F=new ee("Pastel");F.addBlock(new A(w.PastelLightTanBg,t,"background/pastel/light_tan",C.Backgrounds)),F.addBlock(new A(w.PastelLightGreenBg,t,"background/pastel/light_green",C.Backgrounds)),F.addBlock(new A(w.PastelReefBg,t,"background/pastel/reef",C.Backgrounds)),F.addBlock(new A(w.PastelLightCyanBg,t,"background/pastel/light_cyan",C.Backgrounds)),F.addBlock(new A(w.PastelBlueBg,t,"background/pastel/blue",C.Backgrounds)),F.addBlock(new A(w.PastelLightSalmonPinkBg,t,"background/pastel/light_salmon_pink",C.Backgrounds)),this.addPackage(F);const M=new ee("Grass");M.addBlock(new A(w.BricksGrassLeftEdge,e,"foreground/grass/grass_left_edge",C.Blocks)),M.addBlock(new A(w.BricksGrass,e,"foreground/grass/grass",C.Blocks)),M.addBlock(new A(w.BricksGrassRightEdge,e,"foreground/grass/grass_right_edge",C.Blocks)),this.addPackage(M);const O=new ee("Metal");O.addBlock(new A(w.MetalSilver,e,"foreground/metal/silver",C.Blocks)),O.addBlock(new A(w.MetalCopper,e,"foreground/metal/copper",C.Blocks)),O.addBlock(new A(w.MetalGold,e,"foreground/metal/gold",C.Blocks)),this.addPackage(O);const L=new ee("Generic");L.addBlock(new A(w.HazardStripes,e,"foreground/generic/hazard_stripes",C.Blocks)),L.addBlock(new A(w.FaceBlock,e,"foreground/generic/face_block",C.Blocks)),L.addBlock(new A(w.BlackBlock,e,"foreground/generic/black_block",C.Blocks).minimap(4278190080)),L.addBlock(new A(w.FullBlackBlock,e,"foreground/generic/full_black_block",C.Blocks).minimap(0)),this.addPackage(L);const W=new ee("Secrets");W.addBlock(new A(w.SecretAppear,e,"foreground/secrets/appear",C.Blocks).minimap(null)),W.addBlock(new A(w.SecretDisappear,e,"foreground/secrets/disappear",C.Blocks).nonSolid().noShadow().minimap(0)),this.addPackage(W);const H=new ee("Factory");H.addBlock(new A(w.FactoryMetalCrate,e,"foreground/factory/metal_crate",C.Blocks)),H.addBlock(new A(w.FactoryStone,e,"foreground/factory/stone",C.Blocks)),H.addBlock(new A(w.FactoryWood,e,"foreground/factory/wood",C.Blocks)),H.addBlock(new A(w.FactoryWoodenCrate,e,"foreground/factory/wood_crate",C.Blocks)),H.addBlock(new A(w.FactoryScales,e,"foreground/factory/scales",C.Blocks)),this.addPackage(H);const q=new ee("Glass");q.addBlock(new A(w.GlassRed,e,"foreground/glass/red",C.Blocks)),q.addBlock(new A(w.GlassOrange,e,"foreground/glass/orange",C.Blocks)),q.addBlock(new A(w.GlassYellow,e,"foreground/glass/yellow",C.Blocks)),q.addBlock(new A(w.GlassGreen,e,"foreground/glass/green",C.Blocks)),q.addBlock(new A(w.GlassCyan,e,"foreground/glass/cyan",C.Blocks)),q.addBlock(new A(w.GlassBlue,e,"foreground/glass/blue",C.Blocks)),q.addBlock(new A(w.GlassPurple,e,"foreground/glass/purple",C.Blocks)),q.addBlock(new A(w.GlassMagenta,e,"foreground/glass/magenta",C.Blocks)),this.addPackage(q);const K=new ee("Meadow");K.addBlock(new A(w.MeadowGrassLeft,e,"decoration/meadow/grass_left",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),K.addBlock(new A(w.MeadowGrassMiddle,e,"decoration/meadow/grass_middle",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),K.addBlock(new A(w.MeadowGrassRight,e,"decoration/meadow/grass_right",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),K.addBlock(new A(w.MeadowBushLeft,e,"decoration/meadow/bush_left",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),K.addBlock(new A(w.MeadowBushMiddle,e,"decoration/meadow/bush_middle",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),K.addBlock(new A(w.MeadowBushRight,e,"decoration/meadow/bush_right",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),K.addBlock(new A(w.MeadowYellowFlower,e,"decoration/meadow/yellow_flower",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),K.addBlock(new A(w.MeadowSmallBush,e,"decoration/meadow/small_bush",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),this.addPackage(K);const J=new ee("Easter Eggs");J.addBlock(new A(w.EasterEggsBlue,e,"decoration/easter_eggs/blue",C.Decorations).nonSolid().noShadow().minimap(null)),J.addBlock(new A(w.EasterEggsPink,e,"decoration/easter_eggs/pink",C.Decorations).nonSolid().noShadow().minimap(null)),J.addBlock(new A(w.EasterEggsYellow,e,"decoration/easter_eggs/yellow",C.Decorations).nonSolid().noShadow().minimap(null)),J.addBlock(new A(w.EasterEggsRed,e,"decoration/easter_eggs/red",C.Decorations).nonSolid().noShadow().minimap(null)),J.addBlock(new A(w.EasterEggsGreen,e,"decoration/easter_eggs/green",C.Decorations).nonSolid().noShadow().minimap(null)),this.addPackage(J);const X=new ee("Candy");X.addBlock(new A(w.CandyPink,e,"foreground/candy/pink",C.Blocks)),X.addBlock(new A(w.CandyBlue,e,"foreground/candy/blue",C.Blocks)),X.addBlock(new A(w.CandyPlatformPink,e,"foreground/candy/platform_pink",C.Blocks).platform()),X.addBlock(new A(w.CandyPlatformRed,e,"foreground/candy/platform_red",C.Blocks).platform()),X.addBlock(new A(w.CandyPlatformCyan,e,"foreground/candy/platform_cyan",C.Blocks).platform()),X.addBlock(new A(w.CandyPlatformGreen,e,"foreground/candy/platform_green",C.Blocks).platform()),X.addBlock(new A(w.CandyCane,e,"foreground/candy/cane",C.Blocks)),X.addBlock(new A(w.CandyLicorice,e,"foreground/candy/licorice",C.Blocks)),X.addBlock(new A(w.CandyChocolate,e,"foreground/candy/chocolate",C.Blocks)),X.addBlock(new A(w.CandyCreamSmall,e,"decoration/candy/cream_small",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),X.addBlock(new A(w.CandyCreamLarge,e,"decoration/candy/cream_large",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),X.addBlock(new A(w.CandyGumdropRed,e,"decoration/candy/gumdrop_red",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),X.addBlock(new A(w.CandyGumdropGreen,e,"decoration/candy/gumdrop_green",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),X.addBlock(new A(w.CandyGumdropPink,e,"decoration/candy/gumdrop_pink",C.Decorations).nonSolid().noShadow().abovePlayers().minimap(null)),X.addBlock(new A(w.CandyPinkBg,t,"background/candy/pink",C.Backgrounds)),X.addBlock(new A(w.CandyBlueBg,t,"background/candy/blue",C.Backgrounds)),this.addPackage(X),this.generateMinimapColors()}static addPackage(e){this.blockPackages.push(e);for(const t of e.blocks)this.blocks[t.id]=t}static addSmiley(e){this.smileys[e.id]=e}static generateMinimapColors(){for(const e of Object.values(this.blocks))e.minimapColor===void 0&&e.generateMinimapColor()}static generateMinimapColorsArray(){const e={};for(const t of Object.values(this.blocks))e[t.id]=t.minimapColor==null?null:this.toUint32(t.minimapColor??0);return e}static toUint32(e){return(e|0)>=0?e|0:(e|0)+4294967296}static getBlocks(){return Object.values(this.blocks)}static getSmileys(){return Object.values(this.smileys)}}m(ht,"blockPackages",[]),m(ht,"blocks",[]),m(ht,"smileys",[]);function sa(n,e){const{tag:t,id:i,className:r}=na(n),s=e?document.createElementNS(e,t):document.createElement(t);return i&&(s.id=i),r&&(e?s.setAttribute("class",r):s.className=r),s}function na(n){const e=n.split(/([.#])/);let t="",i="";for(let r=1;r<e.length;r+=2)switch(e[r]){case".":t+=` ${e[r+1]}`;break;case"#":i=e[r+1]}return{className:t.trim(),tag:e[0]||"div",id:i}}function ye(n,e){const t=Ue(n),i=Ue(e);return e===i&&i.__redom_view&&(e=i.__redom_view),i.parentNode&&(pn(e,i,t),t.removeChild(i)),e}function pn(n,e,t){const i=e.__redom_lifecycle;if(Ms(i)){e.__redom_lifecycle={};return}let r=t;for(e.__redom_mounted&&Ii(e,"onunmount");r;){const s=r.__redom_lifecycle||{};for(const o in i)s[o]&&(s[o]-=i[o]);Ms(s)&&(r.__redom_lifecycle=null),r=r.parentNode}}function Ms(n){if(n==null)return!0;for(const e in n)if(n[e])return!1;return!0}const oa=["onmount","onremount","onunmount"],aa=typeof window<"u"&&"ShadowRoot"in window;function Y(n,e,t,i){const r=Ue(n),s=Ue(e);e===s&&s.__redom_view&&(e=s.__redom_view),e!==s&&(s.__redom_view=e);const o=s.__redom_mounted,l=s.parentNode;if(o&&l!==r&&pn(e,s,l),t!=null)if(i){const h=Ue(t);h.__redom_mounted&&Ii(h,"onunmount"),r.replaceChild(s,h)}else r.insertBefore(s,Ue(t));else r.appendChild(s);return la(e,s,r,l),e}function Ii(n,e){e==="onmount"||e==="onremount"?n.__redom_mounted=!0:e==="onunmount"&&(n.__redom_mounted=!1);const t=n.__redom_lifecycle;if(!t)return;const i=n.__redom_view;let r=0;i&&i[e]&&i[e]();for(const s in t)s&&r++;if(r){let s=n.firstChild;for(;s;){const o=s.nextSibling;Ii(s,e),s=o}}}function la(n,e,t,i){const r=e.__redom_lifecycle||(e.__redom_lifecycle={}),s=t===i;let o=!1;for(const f of oa)s||n!==e&&f in n&&(r[f]=(r[f]||0)+1),r[f]&&(o=!0);if(!o){e.__redom_lifecycle={};return}let l=t,h=!1;for((s||l&&l.__redom_mounted)&&(Ii(e,s?"onremount":"onmount"),h=!0);l;){const f=l.parentNode,g=l.__redom_lifecycle||(l.__redom_lifecycle={});for(const a in r)g[a]=(g[a]||0)+r[a];if(h)break;(l.nodeType===Node.DOCUMENT_NODE||aa&&l instanceof ShadowRoot||f&&f.__redom_mounted)&&(Ii(l,s?"onremount":"onmount"),h=!0),l=f}}function Pe(n,e,t){const i=Ue(n);if(typeof e=="object")for(const r in e)zs(i,r,e[r]);else zs(i,e,t)}function zs(n,e,t){n.style[e]=t??""}const Os="http://www.w3.org/1999/xlink";function mn(n,e,t,i){const r=Ue(n);if(typeof e=="object")for(const o in e)mn(r,o,e[o],i);else{const o=r instanceof SVGElement,l=typeof t=="function";if(e==="style"&&typeof t=="object")Pe(r,t);else if(o&&l)r[e]=t;else if(e==="dataset")wn(r,t);else if(!o&&(e in r||l)&&e!=="list")r[e]=t;else{if(o&&e==="xlink"){gn(r,t);return}i&&e==="class"&&(t=r.className+" "+t),t==null?r.removeAttribute(e):r.setAttribute(e,t)}}}function gn(n,e,t){if(typeof e=="object")for(const i in e)gn(n,i,e[i]);else t!=null?n.setAttributeNS(Os,e,t):n.removeAttributeNS(Os,e,t)}function wn(n,e,t){if(typeof e=="object")for(const i in e)wn(n,i,e[i]);else t!=null?n.dataset[e]=t:delete n.dataset[e]}function ca(n){return document.createTextNode(n??"")}function yn(n,e,t){for(const i of e){if(i!==0&&!i)continue;const r=typeof i;r==="function"?i(n):r==="string"||r==="number"?n.appendChild(ca(i)):_n(Ue(i))?Y(n,i):i.length?yn(n,i,t):r==="object"&&mn(n,i,null,t)}}function Ue(n){return n.nodeType&&n||!n.el&&n||Ue(n.el)}function _n(n){return n&&n.nodeType}function Mr(n,...e){let t;const i=typeof n;if(i==="string")t=sa(n);else if(i==="function"){const r=n;t=new r(...e)}else throw new Error("At least one argument required");return yn(Ue(t),e,!0),t}const T=Mr;Mr.extend=function(...e){return Mr.bind(this,...e)};function bn(n,...e){const t=Ue(n);let i=Sn(n,e,t.firstChild);for(;i;){const r=i.nextSibling;ye(n,i),i=r}}function Sn(n,e,t){let i=t;const r=Array(e.length);for(let s=0;s<e.length;s++)r[s]=e[s]&&Ue(e[s]);for(let s=0;s<e.length;s++){const o=e[s];if(!o)continue;const l=r[s];if(l===i){i=i.nextSibling;continue}if(_n(l)){const h=i&&i.nextSibling,g=o.__redom_index!=null&&h===r[s+1];Y(n,o,i,g),g&&(i=h);continue}o.length!=null&&(i=Sn(n,o,i))}return i}class _i{load(){return Promise.resolve()}activate(){}deactivate(){}resize(){}update(e){}render(){}isLocked(){return!1}}class ua extends _i{constructor(t){super();m(this,"el");this.el=T("div",{class:"loading-screen"},[T("div",{class:"status"},t)])}activate(){Y(G.el,this.el)}deactivate(){ye(G.el,this.el)}}const ha="0.5.0-alpha",da="pixelwalker3",fa=960,pa=540,ma=!1,ga=!1,wa="6LdD-qkpAAAAACv27wO3p7n_cKcO7TrIWQpdXVZr",ya={game:{host:"game.pixelwalker.net",secure:!0},api:"https://api.pixelwalker.net"},_a={version:ha,roomType:da,gameWidth:fa,gameHeight:pa,showStats:ma,enableScreenshots:ga,recaptchaSiteKey:wa,endpoints:ya},Vt=_a;function zr(n="ws"){const e=Vt.endpoints.game;return`${n}s://${e.host}`}var z=(n=>(n[n.String=0]="String",n[n.Byte=1]="Byte",n[n.Int16=2]="Int16",n[n.Int32=3]="Int32",n[n.Int64=4]="Int64",n[n.Float=5]="Float",n[n.Double=6]="Double",n[n.Boolean=7]="Boolean",n[n.ByteArray=8]="ByteArray",n))(z||{});class $i{constructor(e,t){m(this,"type");m(this,"value");this.type=e,this.value=t}}class ke{constructor(e){m(this,"type",0);m(this,"entries",[]);if(isNaN(e)||e%1!=0||e<-2147483648||e>2147483647)throw new Error("ID must be a 32-bit integer.");this.type=e}get count(){return this.entries.length}add(e,t=void 0){switch(e instanceof Uint8Array&&this.entries.push(new $i(z.ByteArray,e)),typeof e){case"string":this.entries.push(new $i(z.String,e));break;case"number":const i=t===void 0?this.autoNumberEntryType(e):t;this.entries.push(new $i(i,e));break;case"boolean":this.entries.push(new $i(z.Boolean,e));break}}getEntrySafe(e,t){if(this.entries[t].type!==e)throw new Error("Invalid entry type!");return this.entries[t].value}getEntryType(e){return this.entries[e].type}getValue(e){return this.entries[e].value}getString(e){return this.getEntrySafe(z.String,e)}getByte(e){return this.getEntrySafe(z.Byte,e)}getInt16(e){return this.getEntrySafe(z.Int16,e)}getInt32(e){return this.getEntrySafe(z.Int32,e)}getInt64(e){return this.getEntrySafe(z.Int64,e)}getFloat(e){return this.getEntrySafe(z.Float,e)}getDouble(e){return this.getEntrySafe(z.Double,e)}getBoolean(e){return this.getEntrySafe(z.Boolean,e)}getByteArray(e){return this.getEntrySafe(z.ByteArray,e)}autoNumberEntryType(e){return e%1===0?e>0&&e<256?z.Byte:e>-32768&&e<32767?z.Int16:e>-2147483648&&e<2147483647?z.Int32:z.Int64:e>-34028235e31&&e<34028235e31?z.Float:z.Double}toString(){return JSON.stringify({type:this.type,entries:this.entries})}}var V=(n=>(n[n.PlayerInit=0]="PlayerInit",n[n.UpdateRights=1]="UpdateRights",n[n.WorldMetadata=2]="WorldMetadata",n[n.WorldCleared=3]="WorldCleared",n[n.WorldReloaded=4]="WorldReloaded",n[n.WorldBlockPlaced=5]="WorldBlockPlaced",n[n.ChatMessage=6]="ChatMessage",n[n.SystemMessage=7]="SystemMessage",n[n.PlayerJoined=8]="PlayerJoined",n[n.PlayerLeft=9]="PlayerLeft",n[n.PlayerMoved=10]="PlayerMoved",n[n.PlayerFace=11]="PlayerFace",n[n.PlayerGodMode=12]="PlayerGodMode",n[n.PlayerModMode=13]="PlayerModMode",n[n.PlayerCheckpoint=14]="PlayerCheckpoint",n[n.PlayerRespawn=15]="PlayerRespawn",n[n.PlayerReset=16]="PlayerReset",n[n.PlayerCrown=17]="PlayerCrown",n[n.PlayerKeyPressed=18]="PlayerKeyPressed",n[n.PlayerCounters=19]="PlayerCounters",n[n.PlayerWin=20]="PlayerWin",n[n.PlayerLocalSwitchChanged=21]="PlayerLocalSwitchChanged",n[n.PlayerLocalSwitchReset=22]="PlayerLocalSwitchReset",n[n.GlobalSwitchChanged=23]="GlobalSwitchChanged",n[n.GlobalSwitchReset=24]="GlobalSwitchReset",n))(V||{});const dr=class dr{constructor(e){m(this,"state");m(this,"keyActivationTimes",[0,0,0]);this.state=e}tick(){let e=!1;for(const t in this.keyActivationTimes){const i=Date.now()-this.keyActivationTimes[t]<dr.KeyTime;for(const r of this.state.playersIncludingMe)if(r.activeKeys[t]!=i){if(r.activeKeys[t]=i,this.state.world.collidesWith(r)){r.activeKeys[t]=!i;continue}r.isMe&&(e=!0)}}e&&this.state.worldRenderer.updateAllChunks()}activateKey(e){this.keyActivationTimes[e]!==void 0&&(this.keyActivationTimes[e]=Date.now())}sendKey(e){if(this.keyActivationTimes[e]===void 0)return;const t=new ke(V.PlayerKeyPressed);t.add(e,z.Byte),G.pwio.send(t)}isKeyActiveForPlayer(e,t){return t.activeKeys[e]===void 0?!1:t.activeKeys[e]}};m(dr,"KeyTime",5e3);let Or=dr;class ba{constructor(e,t,i){m(this,"el");this.el=T("span",{style:{display:"block",fontFamily:"inter",fontSize:"10px",position:"absolute",top:"0",left:"0",overflow:"hidden",pointerEvents:"none",padding:"0 5px",textTransform:"uppercase",color:i,textShadow:`
                    0px 0px 2px rgba(0,0,0,1),
                    0px 0px 2px rgba(0,0,0,1),
                    0px 0px 2px rgba(0,0,0,1),
                    0px 0px 2px rgba(0,0,0,1),
                    0px 0px 2px rgba(0,0,0,1),
                    0px 0px 2px rgba(0,0,0,1)`}},e)}setPosition(e,t){Pe(this.el,{transform:`translate(${Math.round(e)}px, ${Math.round(t)}px)`})}setVisibility(e){Pe(this.el,{visibility:e?"visible":"hidden"})}}class Ri{constructor(e,t){this.x=e,this.y=t}toString(){return`(${this.x}, ${this.y})`}isPoint(e){return this.x===e.x&&this.y===e.y}is(e,t){return this.x===e&&this.y===t}}class Sa extends Ri{constructor(e,t){super(Math.floor(e),Math.floor(t))}}class xa{static unique(e){return[...new Set(e)]}}class ka{static isEqual(e,t){var i=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(i.length!=r.length)return!1;for(var s=0;s<i.length;s++){let o=e[i[s]],l=t[i[s]],h=this.isObject(o)&&this.isObject(l);if(h&&!this.isEqual(o,l)||!h&&o!==l)return!1}return!0}static isObject(e){return e!=null&&typeof e=="object"}}class xn{constructor(){m(this,"vertexShader");m(this,"fragmentShader");m(this,"program")}createAndCompile(e,t,i){this.create(e),this.compile(e,t,i)}create(e){this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram()}compile(e,t,i){if(e.shaderSource(this.vertexShader,t),e.compileShader(this.vertexShader),e.shaderSource(this.fragmentShader,i),e.compileShader(this.fragmentShader),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),e.linkProgram(this.program),e.getShaderParameter(this.vertexShader,e.COMPILE_STATUS))if(e.getShaderParameter(this.fragmentShader,e.COMPILE_STATUS)){if(!e.getProgramParameter(this.program,e.LINK_STATUS))throw console.error("Unable to initialize the shader program: "+e.getProgramInfoLog(this.program)),new Error("Unable to initialize the shader program: "+e.getProgramInfoLog(this.program))}else throw e.deleteShader(this.fragmentShader),console.error("Fragment shader compilation error:"+e.getShaderInfoLog(this.fragmentShader)),new Error("Fragment shader compilation error:"+e.getShaderInfoLog(this.fragmentShader));else throw e.deleteShader(this.vertexShader),console.error("Vertex shader compilation error:"+e.getShaderInfoLog(this.vertexShader)),new Error("Vertex shader compilation error:"+e.getShaderInfoLog(this.vertexShader))}useProgram(e){e.useProgram(this.program)}cleanup(e){e.deleteShader(this.vertexShader),e.deleteShader(this.fragmentShader),e.deleteProgram(this.program),this.vertexShader=null,this.fragmentShader=null,this.program=null}}const va=`#version 300 es

precision highp float;

in vec3 a_position;
in vec4 a_texCoord;
in vec4 a_extra;
in float a_chunkIndex;

uniform mat3 u_matrix;

out vec2 v_position;
out vec4 v_texCoord;
out vec4 v_extra;
out float v_chunkIndex;

void main() {
  v_texCoord = a_texCoord;
  v_position = a_position.xy;
  v_extra = a_extra;
  v_chunkIndex = a_chunkIndex;
  gl_Position = vec4((u_matrix * vec3(a_position.xy, 1.0)).xy, -a_position.z * 0.01, 1.0);
}`,Ba=`#version 300 es

precision highp float;

in vec2 v_position;
in vec4 v_texCoord;
in vec4 v_extra;
in float v_chunkIndex;

uniform sampler2D u_texture;
uniform float u_animationFrame;
uniform float u_blockAnimationFrames[625];

out vec4 outColor;

const float tileSize = 16.0;
const vec2 shadowOffset = vec2(2.0);

vec4 sampleTexture(vec2 size, vec2 offsetTexCoord) {
  vec4 color = vec4(0);
  if (all(lessThan(v_texCoord.xy, vec2(tileSize)))) {
    vec2 uv = offsetTexCoord / size;
    color = texture(u_texture, uv);
  }
  return color;
}

vec4 applyShadow(vec4 color, float shadow, vec2 offsetTexCoord, vec2 size) {
  if (all(greaterThan(v_texCoord.xy, shadowOffset))) {
    vec2 shadowTexCoord = offsetTexCoord - shadowOffset;
    vec2 shadowUv = shadowTexCoord / size;
    vec4 shadowColor = vec4(0.0, 0.0, 0.0, texture(u_texture, shadowUv).a * shadow);
    color = mix(color, shadowColor, 1.0 - color.a);
  }
  return color;
}

void main() {
  vec2 blockPos = vec2(floor(v_position.x / tileSize), floor(v_position.y / tileSize));

  float shadow = v_extra.x;

  float totalFrames = v_extra.y;
  float frameTime = v_extra.z;
  float frameStagger = (blockPos.x + blockPos.y) * v_extra.w;
  float frame = mod((u_animationFrame + frameStagger + 0.5) / frameTime, totalFrames) + floor(u_blockAnimationFrames[int(v_chunkIndex)]);

  vec2 offsetTexCoord = vec2(v_texCoord.x + (v_texCoord.z + floor(frame)) * tileSize, v_texCoord.y + v_texCoord.w * tileSize);
  vec2 size = vec2(textureSize(u_texture, 0));
  vec4 color = sampleTexture(size, offsetTexCoord);

  if (shadow > 0.0) {
    color = applyShadow(color, shadow, offsetTexCoord, size);
  }
  outColor = color;
}

`;class Aa extends xn{constructor(){super(...arguments);m(this,"aPositionLoc",-1);m(this,"aTexCoordLoc",-1);m(this,"aExtraLoc",-1);m(this,"aChunkIndexLoc",-1);m(this,"uTextureLoc",null);m(this,"uMatrixLoc",null);m(this,"uAnimationFrameLoc",null);m(this,"uBlockAnimationFramesLoc",null)}initialize(t){this.createAndCompile(t,va,Ba),this.aPositionLoc=t.getAttribLocation(this.program,"a_position"),this.aTexCoordLoc=t.getAttribLocation(this.program,"a_texCoord"),this.aExtraLoc=t.getAttribLocation(this.program,"a_extra"),this.aChunkIndexLoc=t.getAttribLocation(this.program,"a_chunkIndex"),this.uTextureLoc=t.getUniformLocation(this.program,"u_texture"),this.uMatrixLoc=t.getUniformLocation(this.program,"u_matrix"),this.uAnimationFrameLoc=t.getUniformLocation(this.program,"u_animationFrame"),this.uBlockAnimationFramesLoc=t.getUniformLocation(this.program,"u_blockAnimationFrames")}}const Ca=`#version 300 es

precision mediump float;

in vec2 a_texCoord;
in vec3 a_position;
in vec4 a_color;
uniform mat3 u_matrix;
out vec2 v_texCoord;
out vec4 v_color;

void main() {
  v_texCoord = a_texCoord;
  v_color = a_color;
  gl_Position = vec4((u_matrix * vec3(a_position.xy, 1.0)).xy, -a_position.z * 0.001, 1.0);
}`,Pa=`#version 300 es

precision mediump float;

in vec2 v_texCoord;
in vec4 v_color;
uniform sampler2D u_texture;
out vec4 outColor;

void main() {
  vec2 size = vec2(textureSize(u_texture, 0));
  vec2 offsetTexCoord = vec2(v_texCoord.x, v_texCoord.y);
  vec2 uv = v_texCoord / size;
  outColor = texture(u_texture, uv) * v_color;
}
`;class Ta extends xn{constructor(){super(...arguments);m(this,"aPositionLoc",-1);m(this,"aTexCoordLoc",-1);m(this,"aColorLoc",-1);m(this,"uTextureLoc",null);m(this,"uMatrixLoc",null)}initialize(t){this.createAndCompile(t,Ca,Pa),this.aPositionLoc=t.getAttribLocation(this.program,"a_position"),this.aTexCoordLoc=t.getAttribLocation(this.program,"a_texCoord"),this.aColorLoc=t.getAttribLocation(this.program,"a_color"),this.uTextureLoc=t.getUniformLocation(this.program,"u_texture"),this.uMatrixLoc=t.getUniformLocation(this.program,"u_matrix")}}class ui{static initialize(e){this.BLOCK.initialize(e),this.SPRITE.initialize(e)}static cleanup(e){this.BLOCK.cleanup(e),this.SPRITE.cleanup(e)}}m(ui,"BLOCK",new Aa),m(ui,"SPRITE",new Ta);class os{constructor(e){m(this,"state");m(this,"gl");m(this,"vertexBuffer");m(this,"triangleCount");m(this,"texCoordBuffer");m(this,"colorBuffer");this.state=e}initialize(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.texCoordBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer()}updateBuffers(e,t,i){const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,this.vertexBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e),r.DYNAMIC_DRAW),this.triangleCount=e.length/3,r.bindBuffer(r.ARRAY_BUFFER,this.texCoordBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.DYNAMIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,this.colorBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.DYNAMIC_DRAW)}renderVertices(e=1){const t=this.gl,i=ui.SPRITE;i.useProgram(t),t.uniformMatrix3fv(i.uMatrixLoc,!1,new Float32Array(this.state.camera.getViewMatrix())),t.uniform1i(i.uTextureLoc,e),t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffer),t.vertexAttribPointer(i.aTexCoordLoc,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.aTexCoordLoc),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.vertexAttribPointer(i.aColorLoc,4,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.aColorLoc),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(i.aPositionLoc,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.aPositionLoc),t.drawArrays(t.TRIANGLES,0,this.triangleCount),t.useProgram(null)}genSpriteData(e,t,i,r,s,o=[1,1,1,1]){const l=Z.getSpriteAtlasPosition(e);return this.genAttribData(t,i,r,s,l.x,l.y,l.w,l.h,0,o)}genAttribData(e,t,i,r,s,o,l,h,f,g=[1,1,1,1]){const a=[],c=[],p=[];let _=Math.round(e)+i,y=Math.round(t)+r;a.push(_,y,20,_,h+y,20,l+_,y,20,l+_,y,20,_,h+y,20,l+_,h+y,20);const S=f*l;c.push(s+S,o,s+S,h+o,s+S+l,o,s+S+l,o,s+S,h+o,s+S+l,h+o);for(let x=0;x<6;x++)p.push(...g);return{vertices:a,texCoords:c,colors:p}}}const nt=class nt extends os{constructor(t){super(t.worldRenderer.state);m(this,"worldRenderChunk");m(this,"atlasPos",{x:0,y:0});this.worldRenderChunk=t}initialize(t){super.initialize(t),this.atlasPos=Z.getTileAtlasPosition("extra/numbers")}updateBuffers(){const t=this.worldRenderChunk.size,i=this.worldRenderChunk.chunkPosX,r=this.worldRenderChunk.chunkPosY,s=[],o=[],l=[];for(let h=0;h<t;h++)for(let f=0;f<t;f++){const g=i*t+f,a=r*t+h;if(!this.worldRenderChunk.worldRenderer.state.world.isInBounds(g,a))continue;let c;const p=this.worldRenderChunk.worldRenderer.state.world.foregroundBlocks[g][a],_=A.getById(p.id),y=this.worldRenderChunk.worldRenderer.state.player.counters;switch(p.id){case w.CoinDoor:case w.CoinGate:c={number:p.coins-y.goldCoins,hasShadow:_.hasNumberShadow,color:p.id==w.CoinDoor?[0,0,0,1]:[1,1,1,1],disappearAt:0};break;case w.BlueCoinDoor:case w.BlueCoinGate:c={number:p.coins-y.blueCoins,hasShadow:_.hasNumberShadow,color:[1,1,1,1],disappearAt:0};break;case w.LocalSwitch:case w.LocalSwitchDoor:case w.LocalSwitchGate:case w.LocalSwitchActivator:case w.GlobalSwitch:case w.GlobalSwitchDoor:case w.GlobalSwitchGate:case w.GlobalSwitchActivator:c={number:p.switchId,hasShadow:_.hasNumberShadow,color:[1,1,1,1],disappearAt:-1};break;case w.DeathDoor:case w.DeathGate:c={number:p.deaths-y.deaths,hasShadow:_.hasNumberShadow,color:p.id==w.DeathDoor?[0,0,0,1]:[1,1,1,1],disappearAt:0};break}if(!c||c.number<=c.disappearAt)continue;const S=(this.worldRenderChunk.chunkPosX*t+f)*Ze.TILE_SIZE+Ze.TILE_SIZE-this.getNumberWidth(c.number),x=(this.worldRenderChunk.chunkPosY*t+h)*Ze.TILE_SIZE+Ze.TILE_SIZE-nt.NUM_HEIGHT,v=this.convertToDigits(c.number);let P=0;for(let E=0;E<v.length;E++){const I=v[E],F=this.genAttribData(S+P,x,0,0,this.atlasPos.x+6*I,this.atlasPos.y+(c.hasShadow?0:nt.NUM_HEIGHT),this.getNumberWidth(I),nt.NUM_HEIGHT,0,c.color);P+=this.getDigitWidth(I)-1,s.push(...F.vertices),o.push(...F.texCoords),l.push(...F.colors)}}super.updateBuffers(s,o,l)}renderVertices(){super.renderVertices(0)}convertToDigits(t){return t.toString().split("").map(Number)}getDigitWidth(t){switch(t){case 1:return nt.NUM_HALF_WIDTH;default:return nt.NUM_WIDTH}}getNumberWidth(t){const i=this.convertToDigits(t);let r=1;for(const s of i)r+=this.getDigitWidth(s)-1;return r}};m(nt,"NUM_WIDTH",6),m(nt,"NUM_HALF_WIDTH",4),m(nt,"NUM_HEIGHT",7);let Gr=nt;const Pi=class Pi{constructor(e,t,i){m(this,"worldRenderer");m(this,"blockNumberRenderer",null);m(this,"size",Ze.CHUNK_SIZE);m(this,"chunkPosX");m(this,"chunkPosY");m(this,"vertexBuffer",[]);m(this,"vertexBufferTriangleCount",[]);m(this,"texCoordBuffer",[]);m(this,"extraBuffer",[]);m(this,"chunkIndexBuffer",[]);m(this,"isDirty",[!1,!1,!1,!1]);m(this,"blockFrameArrays",[new Float32Array(625),new Float32Array(625),new Float32Array(625)]);this.worldRenderer=e,this.chunkPosX=t,this.chunkPosY=i}initialize(e){this.createLayerBuffers(e,N.Background),this.createLayerBuffers(e,N.Foreground),this.createLayerBuffers(e,N.AbovePlayers),this.blockNumberRenderer=new Gr(this),this.blockNumberRenderer.initialize(e),this.markRenderLayerAsDirty(N.Numbers)}createLayerBuffers(e,t){this.vertexBuffer[t]=e.createBuffer(),this.texCoordBuffer[t]=e.createBuffer(),this.extraBuffer[t]=e.createBuffer(),this.chunkIndexBuffer[t]=e.createBuffer(),this.markRenderLayerAsDirty(t)}updateBuffers(e){this.worldRenderer.bufferUpdatesThisFrame>=Ze.MAX_BUFFER_UPDATES_PER_FRAME||(this.isDirty[N.Numbers]&&(this.blockNumberRenderer.updateBuffers(),this.isDirty[N.Numbers]=!1,this.worldRenderer.bufferUpdatesThisFrame++),this.updateLayerBuffers(e,N.Background),this.updateLayerBuffers(e,N.Foreground),this.updateLayerBuffers(e,N.AbovePlayers),e.bindBuffer(e.ARRAY_BUFFER,null))}updateLayerBuffers(e,t){const i=Ze.TILE_SIZE,r=this.size;if(!this.isDirty[t])return;const s=[],o=[],l=[],h=[],f=t==N.Background?this.worldRenderer.state.world.backgroundBlocks:this.worldRenderer.state.world.foregroundBlocks;for(let g=0;g<r;g++)for(let a=0;a<r;a++){const c=this.chunkPosX*r+a,p=this.chunkPosY*r+g;if(!this.worldRenderer.state.world.isInBounds(c,p))continue;const _=c*i,y=p*i,S=f[c][p],x=A.getById(S.id);let v=Z.getTileAtlasPosition(x.tileset),P=x.shadow?Pi.ShadowValue:0;const E=this.worldRenderer.state.world.getBlockTransform(S.id,c,p,v);if(E.renderSet==!1)continue;v=E.atlasCoords,E.shadowSet!==void 0&&(P=E.shadowSet?Pi.ShadowValue:0);const I=E.renderLayerSet??x.renderLayer;if(t!=I)continue;const F=P>0&&S.id>0;this.addTileVertices(s,_,y,4,i,F),this.addTileTextureCoords(o,i,v.x,v.y,F),this.addTileChunkIndex(l,g*r+a),this.addTileExtras(h,P,x.frames,x.frameTime,x.frameStaggerMult)}this.vertexBufferTriangleCount[t]=s.length/3,this.setBufferDataFloat32(e,this.vertexBuffer[t],s,e.DYNAMIC_DRAW),this.setBufferDataFloat32(e,this.texCoordBuffer[t],o,e.DYNAMIC_DRAW),this.setBufferDataFloat32(e,this.chunkIndexBuffer[t],l,e.DYNAMIC_DRAW),this.setBufferDataFloat32(e,this.extraBuffer[t],h,e.DYNAMIC_DRAW),this.worldRenderer.bufferUpdatesThisFrame++,this.isDirty[t]=!1}renderLayer(e,t,i){if(t==N.Numbers){this.blockNumberRenderer.renderVertices();return}this.updateBuffers(e);const r=ui.BLOCK;r.useProgram(e),e.uniformMatrix3fv(r.uMatrixLoc,!1,i),e.uniform1i(r.uTextureLoc,0),e.uniform1f(r.uAnimationFrameLoc,this.worldRenderer.globalAnimationFrame),e.uniform1fv(r.uBlockAnimationFramesLoc,this.blockFrameArrays[t]),this.bindAndEnableVertexAttribArray(e,this.vertexBuffer[t],r.aPositionLoc,3,e.FLOAT),this.bindAndEnableVertexAttribArray(e,this.texCoordBuffer[t],r.aTexCoordLoc,4,e.FLOAT),this.bindAndEnableVertexAttribArray(e,this.chunkIndexBuffer[t],r.aChunkIndexLoc,1,e.FLOAT),this.bindAndEnableVertexAttribArray(e,this.extraBuffer[t],r.aExtraLoc,4,e.FLOAT),e.drawArrays(e.TRIANGLES,0,this.vertexBufferTriangleCount[t]),e.useProgram(null)}updateBlockAnimationFrames(e){const t=this.size,i=this.blockFrameArrays[e];for(let r=0;r<t;r++)for(let s=0;s<t;s++){const o=this.chunkPosX*t+s,l=this.chunkPosY*t+r;this.worldRenderer.state.world.isInBounds(o,l)&&(i[r*t+s]=this.worldRenderer.foregroundBlockFrames[o][l].frame)}}markRenderLayerAsDirty(e){this.isDirty[e]=!0}addTileVertices(e,t,i,r,s,o){const l=o?2:0;e.push(t,i,r,t+s+l,i,r,t,i+s+l,r,t+s+l,i,r,t,i+s+l,r,t+s+l,i+s+l,r)}addTileTextureCoords(e,t,i,r,s){const o=i/t,l=r/t,h=s?2:0;e.push(0,0,o,l,t+h,0,o,l,0,t+h,o,l,t+h,0,o,l,0,t+h,o,l,t+h,t+h,o,l)}addTileExtras(e,t,i,r,s){for(let o=0;o<6;o++)e.push(t,i,r,s)}addTileChunkIndex(e,t){for(let i=0;i<6;i++)e.push(t)}setBufferDataFloat32(e,t,i,r){e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),r)}bindAndEnableVertexAttribArray(e,t,i,r,s,o=0){e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(i,r,s,!1,o,0),e.enableVertexAttribArray(i)}};m(Pi,"ShadowValue",.3);let Ur=Pi;class Ea{constructor(){m(this,"frame",0);m(this,"startFrame",0);m(this,"endFrame",0)}startAnim(e,t){this.isAnimating||(this.frame=e,this.startFrame=e,this.endFrame=e+(t-1))}progressAnim(e){this.frame+=e,this.frame>this.endFrame&&this.reset()}reset(){this.frame=0,this.startFrame=0,this.endFrame=0}get isAnimating(){return this.startFrame<this.endFrame}}const xe=class xe{constructor(e){m(this,"gl");m(this,"state");m(this,"globalAnimationFrame",0);m(this,"foregroundBlockFrames",[]);m(this,"chunks",[]);m(this,"bufferUpdatesThisFrame",0);this.state=e}initialize(e){this.gl=e,this.initializeChunks(),this.foregroundBlockFrames=[];for(let t=0;t<this.state.world.width;t++){this.foregroundBlockFrames[t]=[];for(let i=0;i<this.state.world.height;i++)this.foregroundBlockFrames[t][i]=new Ea}}initializeChunks(){this.chunks=[];const e=Math.ceil(this.state.world.width/xe.CHUNK_SIZE),t=Math.ceil(this.state.world.height/xe.CHUNK_SIZE);for(let i=0;i<e;i++){this.chunks[i]=[];for(let r=0;r<t;r++){const s=new Ur(this,i,r);s.initialize(this.gl),this.chunks[i][r]=s}}this.updateAllChunks()}getChunkAt(e,t){return e<0||e>=this.chunks.length||t<0||t>=this.chunks[e].length?null:this.chunks[e][t]}updateAllChunks(e=[0,1,2,3]){const t=Math.ceil(this.state.world.width/xe.CHUNK_SIZE),i=Math.ceil(this.state.world.height/xe.CHUNK_SIZE);for(let r=0;r<t;r++)for(let s=0;s<i;s++)for(const o of e)this.updateChunkAt(r,s,o)}updateChunkAtBlockPos(e,t,i){const r=Math.floor(e/xe.CHUNK_SIZE),s=Math.floor(t/xe.CHUNK_SIZE);for(const o of i)this.updateChunkAt(r,s,o)}updateChunkAt(e,t,i){const r=this.getChunkAt(e,t);r&&r.markRenderLayerAsDirty(i)}preRender(){this.bufferUpdatesThisFrame=0}render(e){const t=this.gl;for(const i of e)this.renderChunksInLayer(i);t.useProgram(null)}renderChunksInLayer(e){const t=this.getVisibleChunks(),i=this.state.camera.getViewMatrix();for(const r of t)r.renderLayer(this.gl,e,i)}getVisibleChunks(){const e=[];for(let t=0;t<this.chunks.length;t++)for(let i=0;i<this.chunks[t].length;i++){const r=xe.CHUNK_SIZE*xe.TILE_SIZE,s=t*r,o=i*r;this.state.camera.isRectInView(s,o,r,r)&&e.push(this.chunks[t][i])}return e}advanceGlobalAnimations(){this.globalAnimationFrame++}advanceBlockAnimations(){const e=this.getVisibleChunks();for(const t of e){for(let i=0;i<xe.CHUNK_SIZE;i++)for(let r=0;r<xe.CHUNK_SIZE;r++){const s=t.chunkPosX*xe.CHUNK_SIZE+i,o=t.chunkPosY*xe.CHUNK_SIZE+r;this.updateBlockAnimations(s,o,Q.Foreground)}t.updateBlockAnimationFrames(N.Foreground),t.updateBlockAnimationFrames(N.AbovePlayers)}}updateBlockAnimations(e,t,i){let r=this.state.world.getBlockData(e,t,i);const s=this.foregroundBlockFrames[e][t];switch(r.id){case w.Water:{s.isAnimating?s.progressAnim(.08):Math.random()<3e-4&&s.startAnim(1+Math.floor(Math.random()*4)*5,5);break}}}};m(xe,"TILE_SIZE",16),m(xe,"CHUNK_SIZE",25),m(xe,"MAX_BUFFER_UPDATES_PER_FRAME",64);let Ze=xe;class Ne{constructor(e){m(this,"id");m(this,"extra",{});this.id=e}addToMessage(e){e.add(this.id,z.Int32)}isSameAs(e){return this.id===e.id}isRotatable(){return"rotation"in this}get infoBubbleContent(){}}class Je{static mod(e,t){return(e%t+t)%t}static clamp(e,t,i){return Math.min(i,Math.max(t,e))}static clampToZeroInRange(e,t){return e<t&&e>-t?0:e}}class Wt extends Ne{constructor(t,i){super(t);m(this,"rotation");this.rotation=Je.clamp(i,0,3)}addToMessage(t){super.addToMessage(t),t.add(this.rotation,z.Int32)}isSameAs(t){return t instanceof Wt?this.id===t.id&&this.rotation===t.rotation:!1}}const Ti=class Ti extends Wt{constructor(t,i,r,s){super(t,i);m(this,"portalId");m(this,"portalTargetId");this.portalId=Je.clamp(r,0,999),this.portalTargetId=Je.clamp(s,0,999)}addToMessage(t){super.addToMessage(t),t.add(this.portalId,z.Int32),t.add(this.portalTargetId,z.Int32)}isSameAs(t){return t instanceof Ti?this.id===t.id&&this.rotation===t.rotation&&this.portalId===t.portalId&&this.portalTargetId===t.portalTargetId:!1}get portalTextureName(){switch(this.rotation){default:case 0:return"foreground/portal/left";case 1:return"foreground/portal/up";case 2:return"foreground/portal/right";case 3:return"foreground/portal/down"}}get infoBubbleContent(){return`Portal: ${this.portalId} -> ${this.portalTargetId}`}};m(Ti,"selectedPortalId",0),m(Ti,"selectedPortalTargetId",0);let Ye=Ti;class sr{constructor(e=0,t=0,i=16,r=16){m(this,"x");m(this,"y");m(this,"width");m(this,"height");this.x=e,this.y=t,this.width=i,this.height=r}intersects(e){return this.x<e.x+e.width&&this.x+this.width>e.x&&this.y<e.y+e.height&&this.y+this.height>e.y}add(e){return new sr(this.x+e.x,this.y+e.y,this.width+e.width,this.height+e.height)}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getTop(){return this.y}getBottom(){return this.y+this.height}getLeft(){return this.x}getRight(){return this.x+this.width}}const Ei=class Ei{constructor(e,t=200,i=200){m(this,"state");m(this,"width");m(this,"height");m(this,"foregroundBlocks",[]);m(this,"backgroundBlocks",[]);m(this,"totalCoinCounter",{gold:0,blue:0});if(t>1e3||i>1e3)throw new Error("Unsupported world size: "+t+"x"+i+". That's way too big, dude. >:(");this.state=e,this.width=t,this.height=i}clear(e=!1){this.totalCoinCounter={gold:0,blue:0};for(let t=0;t<this.width;t++){this.foregroundBlocks[t]=[],this.backgroundBlocks[t]=[];for(let i=0;i<this.height;i++){const r=t==0||i==0||t==this.width-1||i==this.height-1;this.foregroundBlocks[t][i]=r?new Ne(w.BasicGray):new Ne(w.Empty),this.backgroundBlocks[t][i]=new Ne(w.Empty)}}e||(this.state.worldRenderer.updateAllChunks(),this.state.ui.minimap.reset(),this.state.ui.counters.updateCoinCount(),this.state.ui.counters.updateBlueCoinCount())}sendBlockData(e,t,i,r){if(!this.canPlaceBlock(e,t,i,r))return;const s=new ke(V.WorldBlockPlaced);s.add(e,z.Int32),s.add(t,z.Int32),s.add(i,z.Int32),r.addToMessage(s),G.pwio.send(s)}setBlockData(e,t,i,r,s=!1){if(!this.canPlaceBlock(e,t,i,r))return;const o=i==Q.Foreground?this.foregroundBlocks:this.backgroundBlocks,l=A.getById(r.id),h=this.getBlockData(e,t,i),f=A.getById(h.id);if(o[e][t]=r,this.updateCoins(h,e,t,!s),s)return;const g=xa.unique([...r.id!==w.Empty?[l.renderLayer]:[],...h.id!==w.Empty?[f.renderLayer]:[],...l.hasNumber||f.hasNumber?[N.Numbers]:[]]);this.state.worldRenderer.foregroundBlockFrames[e][t].reset(),this.state.worldRenderer.updateChunkAtBlockPos(e,t,g),this.state.ui.minimap.updateBlock(e,t)}canPlaceBlock(e,t,i,r){if(!this.isInBounds(e,t))return!1;const s=i==Q.Foreground?this.foregroundBlocks:this.backgroundBlocks;return!ka.isEqual(s[e][t],r)}updateCoins(e,t,i,r=!0){const s=this.foregroundBlocks[t][i];let o=!1,l=!1;s.id==w.Coin?(this.totalCoinCounter.gold++,o=!0):s.id==w.BlueCoin&&(this.totalCoinCounter.blue++,o=!0),e.id==w.Coin?(this.totalCoinCounter.gold--,o=!0,e.extra.collected===!0&&(this.state.player.counters.goldCoins--,l=!0)):e.id==w.BlueCoin&&(this.totalCoinCounter.blue--,o=!0,e.extra.collected===!0&&(this.state.player.counters.blueCoins--,l=!0)),l&&this.state.worldRenderer.updateAllChunks([N.Foreground,N.Numbers]),r&&o&&(this.state.ui.counters.updateCoinCount(),this.state.ui.counters.updateBlueCoinCount())}getBlockData(e,t,i){return e=Math.floor(e),t=Math.floor(t),this.isInBounds(e,t)?(i==Q.Foreground?this.foregroundBlocks:this.backgroundBlocks)[e][t]:new Ne(w.Empty)}getPortalTargets(e){const t=[];for(let i=0;i<this.width;i++)for(let r=0;r<this.height;r++){const s=this.getBlockData(i,r,Q.Foreground);s instanceof Ye&&s.portalId==e&&t.push({pos:new Ri(i,r),portal:s})}return t}getTopMostPlacementLayer(e,t){return this.foregroundBlocks[e][t].id!=w.Empty?Q.Foreground:Q.Background}isInBounds(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height}canvasPosToBlockPos(e,t){const{camX:i,camY:r}=this.state.camera.getPosition(),s=Ze.TILE_SIZE,o=Math.floor((e+i)/s),l=Math.floor((t+r)/s);return new Sa(o,l)}tick(){this.state.worldRenderer.advanceGlobalAnimations(),this.state.worldRenderer.advanceBlockAnimations()}collidesWith(e){const t=Ze.TILE_SIZE;if(e.x<0||e.y<0||e.x+e.width>this.width*t||e.y+e.height>this.height*t)return!0;if(e.isFlying)return e.overlapA=-1,!1;let i=e.x>>4,r=e.y>>4,s=(e.x+e.width)/t,o=(e.y+e.height)/t,l=!1;for(let h=r;h<o;h++)for(let f=i;f<s;f++){const g=this.getBlockData(f,h,Q.Foreground),a=A.getById(g.id);let c=0;const p=new sr(f*t,h*t,t,t),_=new sr(e.x,e.y,e.width,e.height);if(p.intersects(_)){switch(g instanceof Wt&&(c=g.rotation),a.id){case w.SecretAppear:case w.SecretDisappear:e.isMe&&!g.extra.revealed&&(g.extra.revealed=!0,this.state.worldRenderer.updateChunkAtBlockPos(f,h,[a.renderLayer]));break}switch(a.collisionType){case"full":default:switch(g.id){case w.KeyDoorRed:if(this.state.keys.isKeyActiveForPlayer(0,e))continue;break;case w.KeyDoorGreen:if(this.state.keys.isKeyActiveForPlayer(1,e))continue;break;case w.KeyDoorBlue:if(this.state.keys.isKeyActiveForPlayer(2,e))continue;break;case w.CoinDoor:if(e.counters.delayedGoldCoins>=this.foregroundBlocks[f][h].coins)continue;break;case w.BlueCoinDoor:if(e.counters.delayedBlueCoins>=this.foregroundBlocks[f][h].coins)continue;break;case w.DeathDoor:if(e.counters.delayedDeaths>=this.foregroundBlocks[f][h].deaths)continue;break;case w.LocalSwitchDoor:if(e.delayedLocalSwitches[g.switchId]==1)continue;break;case w.GlobalSwitchDoor:if(e.delayedGlobalSwitches[g.switchId]==1)continue;break}break;case"none":switch(g.id){case w.KeyGateRed:if(this.state.keys.isKeyActiveForPlayer(0,e))return!0;break;case w.KeyGateGreen:if(this.state.keys.isKeyActiveForPlayer(1,e))return!0;break;case w.KeyGateBlue:if(this.state.keys.isKeyActiveForPlayer(2,e))return!0;break;case w.CoinGate:if(e.counters.delayedGoldCoins>=this.foregroundBlocks[f][h].coins)return!0;break;case w.BlueCoinGate:if(e.counters.delayedBlueCoins>=this.foregroundBlocks[f][h].coins)return!0;break;case w.DeathGate:if(e.counters.delayedDeaths>=this.foregroundBlocks[f][h].deaths)return!0;break;case w.LocalSwitchGate:if(e.delayedLocalSwitches[g.switchId]==1)return!0;break;case w.GlobalSwitchGate:if(e.delayedGlobalSwitches[g.switchId]==1)return!0;break}continue;case"platform":if(console.log(e.speedY==0,e.speedX==0,e.oy+15>h*t),(e.speedY<0||h<=e.overlapA||e.speedY==0&&e.speedX==0&&e.oy+15>h*t)&&c==0){(h!=r||e.overlapA==-1)&&(e.overlapA=h),l=!0;continue}break}return!0}}return l||(e.overlapA=-1),e.overlapB=-1,e.overlapC=-1,e.overlapD=-1,!1}getBlockTransform(e,t,i,r){var g,a;let s={x:r.x,y:r.y,w:r.w,h:r.h},o={x:0,y:0},l,h,f;switch(e){case w.KeyDoorRed:case w.KeyGateRed:this.state.keys.isKeyActiveForPlayer(0,this.state.player)&&(o.x=1,h=e==w.KeyGateRed);break;case w.KeyDoorGreen:case w.KeyGateGreen:this.state.keys.isKeyActiveForPlayer(1,this.state.player)&&(o.x=1,h=e==w.KeyGateGreen);break;case w.KeyDoorBlue:case w.KeyGateBlue:this.state.keys.isKeyActiveForPlayer(2,this.state.player)&&(o.x=1,h=e==w.KeyGateBlue);break;case w.Coin:case w.BlueCoin:this.foregroundBlocks[t][i].extra.collected&&(this.state.canEdit||this.state.player.isInModMode?(o.x=13,f=N.Foreground,h=!1):l=!1);break;case w.CoinDoor:case w.CoinGate:this.state.player.counters.goldCoins>=this.foregroundBlocks[t][i].coins&&(o.x=1,h=e==w.CoinGate);break;case w.BlueCoinDoor:case w.BlueCoinGate:this.state.player.counters.blueCoins>=this.foregroundBlocks[t][i].coins&&(o.x=1,h=e==w.BlueCoinGate);break;case w.DeathDoor:case w.DeathGate:this.state.player.counters.deaths>=this.foregroundBlocks[t][i].deaths&&(o.x=1,h=e==w.DeathGate);break;case w.SecretAppear:!this.foregroundBlocks[t][i].extra.revealed&&!this.state.player.isFlying&&(l=!1);break;case w.SecretDisappear:!this.foregroundBlocks[t][i].extra.revealed&&!this.state.player.isFlying&&(o.x=1,h=!0);break;case w.Portal:const c=this.foregroundBlocks[t][i];s=Z.getTileAtlasPosition(c.portalTextureName);break;case w.PortalInvisible:if(!this.state.player.isFlying)l=!1;else{const v=this.foregroundBlocks[t][i];o.x=v.rotation}break;case w.Checkpoint:((g=this.state.checkPoint)==null?void 0:g.x)==t&&((a=this.state.checkPoint)==null?void 0:a.y)==i&&(o.x=1);break;case w.Spikes:const p=this.foregroundBlocks[t][i];o.x=p.rotation;break;case w.LocalSwitch:case w.LocalSwitchDoor:case w.LocalSwitchGate:{const v=this.foregroundBlocks[t][i],P=this.state.player.switches[v.switchId];o.x=P*(e==w.LocalSwitchGate?-1:1),e!=w.LocalSwitch&&P==1&&(h=e==w.LocalSwitchGate)}break;case w.LocalSwitchActivator:const _=this.foregroundBlocks[t][i];o.x=_.switchState,this.state.player.switches[_.switchId]==_.switchState&&(o.x+=2);break;case w.LocalSwitchResetter:const y=this.foregroundBlocks[t][i];o.x=y.switchState;break;case w.GlobalSwitch:case w.GlobalSwitchDoor:case w.GlobalSwitchGate:{const v=this.foregroundBlocks[t][i],P=this.state.switches[v.switchId];o.x=P*(e==w.GlobalSwitchGate?-1:1),e!=w.GlobalSwitch&&P==1&&(h=e==w.GlobalSwitchGate)}break;case w.GlobalSwitchActivator:const S=this.foregroundBlocks[t][i];o.x=S.switchState,this.state.switches[S.switchId]==S.switchState&&(o.x+=2);break;case w.GlobalSwitchResetter:const x=this.foregroundBlocks[t][i];o.x=x.switchState;break}return s.x+=o.x*Ei.TileSize,s.y+=o.y*Ei.TileSize,{atlasCoords:s,renderSet:l,shadowSet:h,renderLayerSet:f}}};m(Ei,"TileSize",16);let it=Ei;function pt(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function kn(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Xe={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},hi={duration:.5,overwrite:!1,delay:0},as,Be,oe,Qe=1e8,re=1/Qe,Nr=Math.PI*2,Da=Nr/4,Ia=0,vn=Math.sqrt,Ra=Math.cos,La=Math.sin,Se=function(e){return typeof e=="string"},pe=function(e){return typeof e=="function"},wt=function(e){return typeof e=="number"},ls=function(e){return typeof e>"u"},ft=function(e){return typeof e=="object"},Ee=function(e){return e!==!1},cs=function(){return typeof window<"u"},Ji=function(e){return pe(e)||Se(e)},Bn=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Ae=Array.isArray,Yr=/(?:-?\.?\d|\.)+/gi,An=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ri=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,vr=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Cn=/[+-]=-?[.\d]+/,Pn=/[^,'"\[\]\s]+/gi,Fa=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ae,ot,Kr,us,We={},nr={},Tn,En=function(e){return(nr=qt(e,We))&&Le},hs=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Li=function(e,t){return!t&&console.warn(e)},Dn=function(e,t){return e&&(We[e]=t)&&nr&&(nr[e]=t)||We},Fi=function(){return 0},Ma={suppressEvents:!0,isStart:!0,kill:!1},tr={suppressEvents:!0,kill:!1},za={suppressEvents:!0},ds={},Ct=[],Xr={},In,Oe={},Br={},Gs=30,ir=[],fs="",ps=function(e){var t=e[0],i,r;if(ft(t)||pe(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=ir.length;r--&&!ir[r].targetTest(t););i=ir[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new io(e[r],i)))||e.splice(r,1);return e},Ut=function(e){return e._gsap||ps(et(e))[0]._gsap},Rn=function(e,t,i){return(i=e[t])&&pe(i)?e[t]():ls(i)&&e.getAttribute&&e.getAttribute(t)||i},De=function(e,t){return(e=e.split(",")).forEach(t)||e},me=function(e){return Math.round(e*1e5)/1e5||0},be=function(e){return Math.round(e*1e7)/1e7||0},oi=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+r:i==="-"?e-r:i==="*"?e*r:e/r},Oa=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},or=function(){var e=Ct.length,t=Ct.slice(0),i,r;for(Xr={},Ct.length=0,i=0;i<e;i++)r=t[i],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},Ln=function(e,t,i,r){Ct.length&&!Be&&or(),e.render(t,i,r||Be&&t<0&&(e._initted||e._startAt)),Ct.length&&!Be&&or()},Fn=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Pn).length<2?t:Se(e)?e.trim():e},Mn=function(e){return e},tt=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Ga=function(e){return function(t,i){for(var r in i)r in t||r==="duration"&&e||r==="ease"||(t[r]=i[r])}},qt=function(e,t){for(var i in t)e[i]=t[i];return e},Us=function n(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=ft(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},ar=function(e,t){var i={},r;for(r in e)r in t||(i[r]=e[r]);return i},Bi=function(e){var t=e.parent||ae,i=e.keyframes?Ga(Ae(e.keyframes)):tt;if(Ee(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},Ua=function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0},zn=function(e,t,i,r,s){i===void 0&&(i="_first"),r===void 0&&(r="_last");var o=e[r],l;if(s)for(l=t[s];o&&o[s]>l;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},mr=function(e,t,i,r){i===void 0&&(i="_first"),r===void 0&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[i]===t&&(e[i]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},Dt=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Nt=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},Na=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Vr=function(e,t,i,r){return e._startAt&&(Be?e._startAt.revert(tr):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},Ya=function n(e){return!e||e._ts&&n(e.parent)},Ns=function(e){return e._repeat?di(e._tTime,e=e.duration()+e._rDelay)*e:0},di=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},lr=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},gr=function(e){return e._end=be(e._start+(e._tDur/Math.abs(e._ts||e._rts||re)||0))},wr=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=be(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),gr(e),i._dirty||Nt(i,e)),e},On=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=lr(e.rawTime(),t),(!t._dur||Wi(0,t.totalDuration(),i)-t._tTime>re)&&t.render(i,!0)),Nt(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-re}},lt=function(e,t,i,r){return t.parent&&Dt(t),t._start=be((wt(i)?i:i||e!==ae?He(e,i,t):e._time)+t._delay),t._end=be(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),zn(e,t,"_first","_last",e._sort?"_start":0),Wr(t)||(e._recent=t),r||On(e,t),e._ts<0&&wr(e,e._tTime),e},Gn=function(e,t){return(We.ScrollTrigger||hs("scrollTrigger",t))&&We.ScrollTrigger.create(t,e)},Un=function(e,t,i,r,s){if(gs(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!Be&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&In!==Ge.frame)return Ct.push(e),e._lazy=[s,r],1},Ka=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},Wr=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},Xa=function(e,t,i,r){var s=e.ratio,o=t<0||!t&&(!e._start&&Ka(e)&&!(!e._initted&&Wr(e))||(e._ts<0||e._dp._ts<0)&&!Wr(e))?0:1,l=e._rDelay,h=0,f,g,a;if(l&&e._repeat&&(h=Wi(0,e._tDur,t),g=di(h,l),e._yoyo&&g&1&&(o=1-o),g!==di(e._tTime,l)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||Be||r||e._zTime===re||!t&&e._zTime){if(!e._initted&&Un(e,t,r,i,h))return;for(a=e._zTime,e._zTime=t||(i?re:0),i||(i=t&&!a),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=h,f=e._pt;f;)f.r(o,f.d),f=f._next;t<0&&Vr(e,t,i,!0),e._onUpdate&&!i&&Ke(e,"onUpdate"),h&&e._repeat&&!i&&e.parent&&Ke(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&Dt(e,1),!i&&!Be&&(Ke(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Va=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},fi=function(e,t,i,r){var s=e._repeat,o=be(t)||0,l=e._tTime/e._tDur;return l&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:be(o*(s+1)+e._rDelay*s):o,l>0&&!r&&wr(e,e._tTime=e._tDur*l),e.parent&&gr(e),i||Nt(e.parent,e),e},Ys=function(e){return e instanceof Ce?Nt(e):fi(e,e._dur)},Wa={_start:0,endTime:Fi,totalDuration:Fi},He=function n(e,t,i){var r=e.labels,s=e._recent||Wa,o=e.duration()>=Qe?s.endTime(!1):e._dur,l,h,f;return Se(t)&&(isNaN(t)||t in r)?(h=t.charAt(0),f=t.substr(-1)==="%",l=t.indexOf("="),h==="<"||h===">"?(l>=0&&(t=t.replace(/=/,"")),(h==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(f?(l<0?s:i).totalDuration()/100:1)):l<0?(t in r||(r[t]=o),r[t]):(h=parseFloat(t.charAt(l-1)+t.substr(l+1)),f&&i&&(h=h/100*(Ae(i)?i[0]:i).totalDuration()),l>1?n(e,t.substr(0,l-1),i)+h:o+h)):t==null?o:+t},Ai=function(e,t,i){var r=wt(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s],l,h;if(r&&(o.duration=t[1]),o.parent=i,e){for(l=o,h=i;h&&!("immediateRender"in l);)l=h.vars.defaults||{},h=Ee(h.vars.inherit)&&h.parent;o.immediateRender=Ee(l.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new we(t[0],o,t[s+1])},Rt=function(e,t){return e||e===0?t(e):t},Wi=function(e,t,i){return i<e?e:i>t?t:i},ve=function(e,t){return!Se(e)||!(t=Fa.exec(e))?"":t[1]},qa=function(e,t,i){return Rt(i,function(r){return Wi(e,t,r)})},qr=[].slice,Nn=function(e,t){return e&&ft(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&ft(e[0]))&&!e.nodeType&&e!==ot},ja=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(r){var s;return Se(r)&&!t||Nn(r,1)?(s=i).push.apply(s,et(r)):i.push(r)})||i},et=function(e,t,i){return oe&&!t&&oe.selector?oe.selector(e):Se(e)&&!i&&(Kr||!pi())?qr.call((t||us).querySelectorAll(e),0):Ae(e)?ja(e,i):Nn(e)?qr.call(e,0):e?[e]:[]},jr=function(e){return e=et(e)[0]||Li("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return et(t,i.querySelectorAll?i:i===e?Li("Invalid scope")||us.createElement("div"):e)}},Yn=function(e){return e.sort(function(){return .5-Math.random()})},Kn=function(e){if(pe(e))return e;var t=ft(e)?e:{each:e},i=Yt(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},l=r>0&&r<1,h=isNaN(r)||l,f=t.axis,g=r,a=r;return Se(r)?g=a={center:.5,edges:.5,end:1}[r]||0:!l&&h&&(g=r[0],a=r[1]),function(c,p,_){var y=(_||t).length,S=o[y],x,v,P,E,I,F,M,O,L;if(!S){if(L=t.grid==="auto"?0:(t.grid||[1,Qe])[1],!L){for(M=-Qe;M<(M=_[L++].getBoundingClientRect().left)&&L<y;);L<y&&L--}for(S=o[y]=[],x=h?Math.min(L,y)*g-.5:r%L,v=L===Qe?0:h?y*a/L-.5:r/L|0,M=0,O=Qe,F=0;F<y;F++)P=F%L-x,E=v-(F/L|0),S[F]=I=f?Math.abs(f==="y"?E:P):vn(P*P+E*E),I>M&&(M=I),I<O&&(O=I);r==="random"&&Yn(S),S.max=M-O,S.min=O,S.v=y=(parseFloat(t.amount)||parseFloat(t.each)*(L>y?y-1:f?f==="y"?y/L:L:Math.max(L,y/L))||0)*(r==="edges"?-1:1),S.b=y<0?s-y:s,S.u=ve(t.amount||t.each)||0,i=i&&y<0?Qn(i):i}return y=(S[c]-S.min)/S.max||0,be(S.b+(i?i(y):y)*S.v)+S.u}},Hr=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=be(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+(wt(i)?0:ve(i))}},Xn=function(e,t){var i=Ae(e),r,s;return!i&&ft(e)&&(r=i=e.radius||Qe,e.values?(e=et(e.values),(s=!wt(e[0]))&&(r*=r)):e=Hr(e.increment)),Rt(t,i?pe(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var l=parseFloat(s?o.x:o),h=parseFloat(s?o.y:0),f=Qe,g=0,a=e.length,c,p;a--;)s?(c=e[a].x-l,p=e[a].y-h,c=c*c+p*p):c=Math.abs(e[a]-l),c<f&&(f=c,g=a);return g=!r||f<=r?e[g]:o,s||g===o||wt(o)?g:g+ve(o)}:Hr(e))},Vn=function(e,t,i,r){return Rt(Ae(e)?!t:i===!0?!!(i=0):!r,function(){return Ae(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*r)/r})},Ha=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(s,o){return o(s)},r)}},$a=function(e,t){return function(i){return e(parseFloat(i))+(t||ve(i))}},Ja=function(e,t,i){return qn(e,t,0,1,i)},Wn=function(e,t,i){return Rt(i,function(r){return e[~~t(r)]})},Za=function n(e,t,i){var r=t-e;return Ae(e)?Wn(e,n(0,e.length),t):Rt(i,function(s){return(r+(s-e)%r)%r+e})},Qa=function n(e,t,i){var r=t-e,s=r*2;return Ae(e)?Wn(e,n(0,e.length-1),t):Rt(i,function(o){return o=(s+(o-e)%s)%s||0,e+(o>r?s-o:o)})},Mi=function(e){for(var t=0,i="",r,s,o,l;~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),l=e.charAt(r+7)==="[",s=e.substr(r+7,o-r-7).match(l?Pn:Yr),i+=e.substr(t,r-t)+Vn(l?s:+s[0],l?0:+s[1],+s[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},qn=function(e,t,i,r,s){var o=t-e,l=r-i;return Rt(s,function(h){return i+((h-e)/o*l||0)})},el=function n(e,t,i,r){var s=isNaN(e+t)?0:function(p){return(1-p)*e+p*t};if(!s){var o=Se(e),l={},h,f,g,a,c;if(i===!0&&(r=1)&&(i=null),o)e={p:e},t={p:t};else if(Ae(e)&&!Ae(t)){for(g=[],a=e.length,c=a-2,f=1;f<a;f++)g.push(n(e[f-1],e[f]));a--,s=function(_){_*=a;var y=Math.min(c,~~_);return g[y](_-y)},i=t}else r||(e=qt(Ae(e)?[]:{},e));if(!g){for(h in t)ms.call(l,e,h,"get",t[h]);s=function(_){return _s(_,l)||(o?e.p:e)}}}return Rt(i,s)},Ks=function(e,t,i){var r=e.labels,s=Qe,o,l,h;for(o in r)l=r[o]-t,l<0==!!i&&l&&s>(l=Math.abs(l))&&(h=o,s=l);return h},Ke=function(e,t,i){var r=e.vars,s=r[t],o=oe,l=e._ctx,h,f,g;if(s)return h=r[t+"Params"],f=r.callbackScope||e,i&&Ct.length&&or(),l&&(oe=l),g=h?s.apply(f,h):s.call(f),oe=o,g},ki=function(e){return Dt(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Be),e.progress()<1&&Ke(e,"onInterrupt"),e},si,jn=[],Hn=function(e){if(e)if(e=!e.name&&e.default||e,cs()||e.headless){var t=e.name,i=pe(e),r=t&&!i&&e.init?function(){this._props=[]}:e,s={init:Fi,render:_s,add:ms,kill:gl,modifier:ml,rawVars:0},o={targetTest:0,get:0,getSetter:ys,aliases:{},register:0};if(pi(),e!==r){if(Oe[t])return;tt(r,tt(ar(e,s),o)),qt(r.prototype,qt(s,ar(e,o))),Oe[r.prop=t]=r,e.targetTest&&(ir.push(r),ds[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Dn(t,r),e.register&&e.register(Le,r,Ie)}else jn.push(e)},ie=255,vi={aqua:[0,ie,ie],lime:[0,ie,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ie],navy:[0,0,128],white:[ie,ie,ie],olive:[128,128,0],yellow:[ie,ie,0],orange:[ie,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ie,0,0],pink:[ie,192,203],cyan:[0,ie,ie],transparent:[ie,ie,ie,0]},Ar=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*ie+.5|0},$n=function(e,t,i){var r=e?wt(e)?[e>>16,e>>8&ie,e&ie]:0:vi.black,s,o,l,h,f,g,a,c,p,_;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),vi[e])r=vi[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),l=e.charAt(3),e="#"+s+s+o+o+l+l+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&ie,r&ie,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&ie,e&ie]}else if(e.substr(0,3)==="hsl"){if(r=_=e.match(Yr),!t)h=+r[0]%360/360,f=+r[1]/100,g=+r[2]/100,o=g<=.5?g*(f+1):g+f-g*f,s=g*2-o,r.length>3&&(r[3]*=1),r[0]=Ar(h+1/3,s,o),r[1]=Ar(h,s,o),r[2]=Ar(h-1/3,s,o);else if(~e.indexOf("="))return r=e.match(An),i&&r.length<4&&(r[3]=1),r}else r=e.match(Yr)||vi.transparent;r=r.map(Number)}return t&&!_&&(s=r[0]/ie,o=r[1]/ie,l=r[2]/ie,a=Math.max(s,o,l),c=Math.min(s,o,l),g=(a+c)/2,a===c?h=f=0:(p=a-c,f=g>.5?p/(2-a-c):p/(a+c),h=a===s?(o-l)/p+(o<l?6:0):a===o?(l-s)/p+2:(s-o)/p+4,h*=60),r[0]=~~(h+.5),r[1]=~~(f*100+.5),r[2]=~~(g*100+.5)),i&&r.length<4&&(r[3]=1),r},Jn=function(e){var t=[],i=[],r=-1;return e.split(Pt).forEach(function(s){var o=s.match(ri)||[];t.push.apply(t,o),i.push(r+=o.length+1)}),t.c=i,t},Xs=function(e,t,i){var r="",s=(e+r).match(Pt),o=t?"hsla(":"rgba(",l=0,h,f,g,a;if(!s)return e;if(s=s.map(function(c){return(c=$n(c,t,1))&&o+(t?c[0]+","+c[1]+"%,"+c[2]+"%,"+c[3]:c.join(","))+")"}),i&&(g=Jn(e),h=i.c,h.join(r)!==g.c.join(r)))for(f=e.replace(Pt,"1").split(ri),a=f.length-1;l<a;l++)r+=f[l]+(~h.indexOf(l)?s.shift()||o+"0,0,0,0)":(g.length?g:s.length?s:i).shift());if(!f)for(f=e.split(Pt),a=f.length-1;l<a;l++)r+=f[l]+s[l];return r+f[a]},Pt=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in vi)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),tl=/hsl[a]?\(/,Zn=function(e){var t=e.join(" "),i;if(Pt.lastIndex=0,Pt.test(t))return i=tl.test(t),e[1]=Xs(e[1],i),e[0]=Xs(e[0],i,Jn(e[1])),!0},zi,Ge=function(){var n=Date.now,e=500,t=33,i=n(),r=i,s=1e3/240,o=s,l=[],h,f,g,a,c,p,_=function y(S){var x=n()-r,v=S===!0,P,E,I,F;if((x>e||x<0)&&(i+=x-t),r+=x,I=r-i,P=I-o,(P>0||v)&&(F=++a.frame,c=I-a.time*1e3,a.time=I=I/1e3,o+=P+(P>=s?4:s-P),E=1),v||(h=f(y)),E)for(p=0;p<l.length;p++)l[p](I,c,F,S)};return a={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(S){return c/(1e3/(S||60))},wake:function(){Tn&&(!Kr&&cs()&&(ot=Kr=window,us=ot.document||{},We.gsap=Le,(ot.gsapVersions||(ot.gsapVersions=[])).push(Le.version),En(nr||ot.GreenSockGlobals||!ot.gsap&&ot||{}),jn.forEach(Hn)),g=typeof requestAnimationFrame<"u"&&requestAnimationFrame,h&&a.sleep(),f=g||function(S){return setTimeout(S,o-a.time*1e3+1|0)},zi=1,_(2))},sleep:function(){(g?cancelAnimationFrame:clearTimeout)(h),zi=0,f=Fi},lagSmoothing:function(S,x){e=S||1/0,t=Math.min(x||33,e)},fps:function(S){s=1e3/(S||240),o=a.time*1e3+s},add:function(S,x,v){var P=x?function(E,I,F,M){S(E,I,F,M),a.remove(P)}:S;return a.remove(S),l[v?"unshift":"push"](P),pi(),P},remove:function(S,x){~(x=l.indexOf(S))&&l.splice(x,1)&&p>=x&&p--},_listeners:l},a}(),pi=function(){return!zi&&Ge.wake()},$={},il=/^[\d.\-M][\d.\-,\s]/,rl=/["']/g,sl=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),r=i[0],s=1,o=i.length,l,h,f;s<o;s++)h=i[s],l=s!==o-1?h.lastIndexOf(","):h.length,f=h.substr(0,l),t[r]=isNaN(f)?f.replace(rl,"").trim():+f,r=h.substr(l+1).trim();return t},nl=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)},ol=function(e){var t=(e+"").split("("),i=$[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[sl(t[1])]:nl(e).split(",").map(Fn)):$._CE&&il.test(e)?$._CE("",e):i},Qn=function(e){return function(t){return 1-e(1-t)}},eo=function n(e,t){for(var i=e._first,r;i;)i instanceof Ce?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},Yt=function(e,t){return e&&(pe(e)?e:$[e]||ol(e))||t},Ht=function(e,t,i,r){i===void 0&&(i=function(h){return 1-t(1-h)}),r===void 0&&(r=function(h){return h<.5?t(h*2)/2:1-t((1-h)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:r},o;return De(e,function(l){$[l]=We[l]=s,$[o=l.toLowerCase()]=i;for(var h in s)$[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=$[l+"."+h]=s[h]}),s},to=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Cr=function n(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/Nr*(Math.asin(1/r)||0),l=function(g){return g===1?1:r*Math.pow(2,-10*g)*La((g-o)*s)+1},h=e==="out"?l:e==="in"?function(f){return 1-l(1-f)}:to(l);return s=Nr/s,h.config=function(f,g){return n(e,f,g)},h},Pr=function n(e,t){t===void 0&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},r=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:to(i);return r.config=function(s){return n(e,s)},r};De("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;Ht(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});$.Linear.easeNone=$.none=$.Linear.easeIn;Ht("Elastic",Cr("in"),Cr("out"),Cr());(function(n,e){var t=1/e,i=2*t,r=2.5*t,s=function(l){return l<t?n*l*l:l<i?n*Math.pow(l-1.5/e,2)+.75:l<r?n*(l-=2.25/e)*l+.9375:n*Math.pow(l-2.625/e,2)+.984375};Ht("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);Ht("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});Ht("Circ",function(n){return-(vn(1-n*n)-1)});Ht("Sine",function(n){return n===1?1:-Ra(n*Da)+1});Ht("Back",Pr("in"),Pr("out"),Pr());$.SteppedEase=$.steps=We.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,r=e+(t?0:1),s=t?1:0,o=1-re;return function(l){return((r*Wi(0,o,l)|0)+s)*i}}};hi.ease=$["quad.out"];De("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return fs+=n+","+n+"Params,"});var io=function(e,t){this.id=Ia++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Rn,this.set=t?t.getSetter:ys},Oi=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,fi(this,+t.duration,1,1),this.data=t.data,oe&&(this._ctx=oe,oe.data.push(this)),zi||Ge.wake()}var e=n.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,fi(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(pi(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(wr(this,i),!s._dp||s.parent||On(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&lt(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===re||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),Ln(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+Ns(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+Ns(this),r):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,r):this._repeat?di(this._tTime,s)+1:1},e.timeScale=function(i,r){if(!arguments.length)return this._rts===-re?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?lr(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-re?0:this._rts,this.totalTime(Wi(-Math.abs(this._delay),this._tDur,s),r!==!1),gr(this),Na(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(pi(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==re&&(this._tTime-=re)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&lt(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(Ee(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?lr(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=za);var r=Be;return Be=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),Be=r,this},e.globalTime=function(i){for(var r=this,s=arguments.length?i:r.rawTime();r;)s=r._start+s/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,Ys(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,Ys(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime(He(this,i),Ee(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,Ee(r))},e.play=function(i,r){return i!=null&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return i!=null&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return i!=null&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-re:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-re,this},e.isActive=function(){var i=this.parent||this._dp,r=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=r&&s<this.endTime(!0)-re)},e.eventCallback=function(i,r,s){var o=this.vars;return arguments.length>1?(r?(o[i]=r,s&&(o[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=r)):delete o[i],this):o[i]},e.then=function(i){var r=this;return new Promise(function(s){var o=pe(i)?i:Mn,l=function(){var f=r.then;r.then=null,pe(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=f),s(o),r.then=f};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?l():r._prom=l})},e.kill=function(){ki(this)},n}();tt(Oi.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-re,_prom:0,_ps:!1,_rts:1});var Ce=function(n){kn(e,n);function e(i,r){var s;return i===void 0&&(i={}),s=n.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=Ee(i.sortChildren),ae&&lt(i.parent||ae,pt(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&Gn(pt(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(r,s,o){return Ai(0,arguments,this),this},t.from=function(r,s,o){return Ai(1,arguments,this),this},t.fromTo=function(r,s,o,l){return Ai(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,Bi(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new we(r,s,He(this,o),1),this},t.call=function(r,s,o){return lt(this,we.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,l,h,f,g){return o.duration=s,o.stagger=o.stagger||l,o.onComplete=f,o.onCompleteParams=g,o.parent=this,new we(r,o,He(this,h)),this},t.staggerFrom=function(r,s,o,l,h,f,g){return o.runBackwards=1,Bi(o).immediateRender=Ee(o.immediateRender),this.staggerTo(r,s,o,l,h,f,g)},t.staggerFromTo=function(r,s,o,l,h,f,g,a){return l.startAt=o,Bi(l).immediateRender=Ee(l.immediateRender),this.staggerTo(r,s,l,h,f,g,a)},t.render=function(r,s,o){var l=this._time,h=this._dirty?this.totalDuration():this._tDur,f=this._dur,g=r<=0?0:be(r),a=this._zTime<0!=r<0&&(this._initted||!f),c,p,_,y,S,x,v,P,E,I,F,M;if(this!==ae&&g>h&&r>=0&&(g=h),g!==this._tTime||o||a){if(l!==this._time&&f&&(g+=this._time-l,r+=this._time-l),c=g,E=this._start,P=this._ts,x=!P,a&&(f||(l=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(F=this._yoyo,S=f+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(S*100+r,s,o);if(c=be(g%S),g===h?(y=this._repeat,c=f):(y=~~(g/S),y&&y===g/S&&(c=f,y--),c>f&&(c=f)),I=di(this._tTime,S),!l&&this._tTime&&I!==y&&this._tTime-I*S-this._dur<=0&&(I=y),F&&y&1&&(c=f-c,M=1),y!==I&&!this._lock){var O=F&&I&1,L=O===(F&&y&1);if(y<I&&(O=!O),l=O?0:g%f?f:g,this._lock=1,this.render(l||(M?0:be(y*S)),s,!f)._lock=0,this._tTime=g,!s&&this.parent&&Ke(this,"onRepeat"),this.vars.repeatRefresh&&!M&&(this.invalidate()._lock=1),l&&l!==this._time||x!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(f=this._dur,h=this._tDur,L&&(this._lock=2,l=O?f:-1e-4,this.render(l,!0),this.vars.repeatRefresh&&!M&&this.invalidate()),this._lock=0,!this._ts&&!x)return this;eo(this,M)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=Va(this,be(l),be(c)),v&&(g-=c-(c=v._start))),this._tTime=g,this._time=c,this._act=!P,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,l=0),!l&&c&&!s&&!y&&(Ke(this,"onStart"),this._tTime!==g))return this;if(c>=l&&r>=0)for(p=this._first;p;){if(_=p._next,(p._act||c>=p._start)&&p._ts&&v!==p){if(p.parent!==this)return this.render(r,s,o);if(p.render(p._ts>0?(c-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(c-p._start)*p._ts,s,o),c!==this._time||!this._ts&&!x){v=0,_&&(g+=this._zTime=-re);break}}p=_}else{p=this._last;for(var W=r<0?r:c;p;){if(_=p._prev,(p._act||W<=p._end)&&p._ts&&v!==p){if(p.parent!==this)return this.render(r,s,o);if(p.render(p._ts>0?(W-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(W-p._start)*p._ts,s,o||Be&&(p._initted||p._startAt)),c!==this._time||!this._ts&&!x){v=0,_&&(g+=this._zTime=W?-re:re);break}}p=_}}if(v&&!s&&(this.pause(),v.render(c>=l?0:-re)._zTime=c>=l?1:-1,this._ts))return this._start=E,gr(this),this.render(r,s,o);this._onUpdate&&!s&&Ke(this,"onUpdate",!0),(g===h&&this._tTime>=this.totalDuration()||!g&&l)&&(E===this._start||Math.abs(P)!==Math.abs(this._ts))&&(this._lock||((r||!f)&&(g===h&&this._ts>0||!g&&this._ts<0)&&Dt(this,1),!s&&!(r<0&&!l)&&(g||l||!h)&&(Ke(this,g===h&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(g<h&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(wt(s)||(s=He(this,s,r)),!(r instanceof Oi)){if(Ae(r))return r.forEach(function(l){return o.add(l,s)}),this;if(Se(r))return this.addLabel(r,s);if(pe(r))r=we.delayedCall(0,r);else return this}return this!==r?lt(this,r,s):this},t.getChildren=function(r,s,o,l){r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),l===void 0&&(l=-Qe);for(var h=[],f=this._first;f;)f._start>=l&&(f instanceof we?s&&h.push(f):(o&&h.push(f),r&&h.push.apply(h,f.getChildren(!0,s,o)))),f=f._next;return h},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return Se(r)?this.removeLabel(r):pe(r)?this.killTweensOf(r):(mr(this,r),r===this._recent&&(this._recent=this._last),Nt(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=be(Ge.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=He(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var l=we.delayedCall(0,s||Fi,o);return l.data="isPause",this._hasPause=1,lt(this,l,He(this,r))},t.removePause=function(r){var s=this._first;for(r=He(this,r);s;)s._start===r&&s.data==="isPause"&&Dt(s),s=s._next},t.killTweensOf=function(r,s,o){for(var l=this.getTweensOf(r,o),h=l.length;h--;)kt!==l[h]&&l[h].kill(r,s);return this},t.getTweensOf=function(r,s){for(var o=[],l=et(r),h=this._first,f=wt(s),g;h;)h instanceof we?Oa(h._targets,l)&&(f?(!kt||h._initted&&h._ts)&&h.globalTime(0)<=s&&h.globalTime(h.totalDuration())>s:!s||h.isActive())&&o.push(h):(g=h.getTweensOf(l,s)).length&&o.push.apply(o,g),h=h._next;return o},t.tweenTo=function(r,s){s=s||{};var o=this,l=He(o,r),h=s,f=h.startAt,g=h.onStart,a=h.onStartParams,c=h.immediateRender,p,_=we.to(o,tt({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:l,overwrite:"auto",duration:s.duration||Math.abs((l-(f&&"time"in f?f.time:o._time))/o.timeScale())||re,onStart:function(){if(o.pause(),!p){var S=s.duration||Math.abs((l-(f&&"time"in f?f.time:o._time))/o.timeScale());_._dur!==S&&fi(_,S,0,1).render(_._time,!0,!0),p=1}g&&g.apply(_,a||[])}},s));return c?_.render(0):_},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,tt({startAt:{time:He(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),Ks(this,He(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),Ks(this,He(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+re)},t.shiftChildren=function(r,s,o){o===void 0&&(o=0);for(var l=this._first,h=this.labels,f;l;)l._start>=o&&(l._start+=r,l._end+=r),l=l._next;if(s)for(f in h)h[f]>=o&&(h[f]+=r);return Nt(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Nt(this)},t.totalDuration=function(r){var s=0,o=this,l=o._last,h=Qe,f,g,a;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(a=o.parent;l;)f=l._prev,l._dirty&&l.totalDuration(),g=l._start,g>h&&o._sort&&l._ts&&!o._lock?(o._lock=1,lt(o,l,g-l._delay,1)._lock=0):h=g,g<0&&l._ts&&(s-=g,(!a&&!o._dp||a&&a.smoothChildTiming)&&(o._start+=g/o._ts,o._time-=g,o._tTime-=g),o.shiftChildren(-g,!1,-1/0),h=0),l._end>s&&l._ts&&(s=l._end),l=f;fi(o,o===ae&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(ae._ts&&(Ln(ae,lr(r,ae)),In=Ge.frame),Ge.frame>=Gs){Gs+=Xe.autoSleep||120;var s=ae._first;if((!s||!s._ts)&&Xe.autoSleep&&Ge._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Ge.sleep()}}},e}(Oi);tt(Ce.prototype,{_lock:0,_hasPause:0,_forcing:0});var al=function(e,t,i,r,s,o,l){var h=new Ie(this._pt,e,t,0,1,lo,null,s),f=0,g=0,a,c,p,_,y,S,x,v;for(h.b=i,h.e=r,i+="",r+="",(x=~r.indexOf("random("))&&(r=Mi(r)),o&&(v=[i,r],o(v,e,t),i=v[0],r=v[1]),c=i.match(vr)||[];a=vr.exec(r);)_=a[0],y=r.substring(f,a.index),p?p=(p+1)%5:y.substr(-5)==="rgba("&&(p=1),_!==c[g++]&&(S=parseFloat(c[g-1])||0,h._pt={_next:h._pt,p:y||g===1?y:",",s:S,c:_.charAt(1)==="="?oi(S,_)-S:parseFloat(_)-S,m:p&&p<4?Math.round:0},f=vr.lastIndex);return h.c=f<r.length?r.substring(f,r.length):"",h.fp=l,(Cn.test(r)||x)&&(h.e=0),this._pt=h,h},ms=function(e,t,i,r,s,o,l,h,f,g){pe(r)&&(r=r(s||0,e,o));var a=e[t],c=i!=="get"?i:pe(a)?f?e[t.indexOf("set")||!pe(e["get"+t.substr(3)])?t:"get"+t.substr(3)](f):e[t]():a,p=pe(a)?f?dl:oo:ws,_;if(Se(r)&&(~r.indexOf("random(")&&(r=Mi(r)),r.charAt(1)==="="&&(_=oi(c,r)+(ve(c)||0),(_||_===0)&&(r=_))),!g||c!==r||$r)return!isNaN(c*r)&&r!==""?(_=new Ie(this._pt,e,t,+c||0,r-(c||0),typeof a=="boolean"?pl:ao,0,p),f&&(_.fp=f),l&&_.modifier(l,this,e),this._pt=_):(!a&&!(t in e)&&hs(t,r),al.call(this,e,t,c,r,p,h||Xe.stringFilter,f))},ll=function(e,t,i,r,s){if(pe(e)&&(e=Ci(e,s,t,i,r)),!ft(e)||e.style&&e.nodeType||Ae(e)||Bn(e))return Se(e)?Ci(e,s,t,i,r):e;var o={},l;for(l in e)o[l]=Ci(e[l],s,t,i,r);return o},ro=function(e,t,i,r,s,o){var l,h,f,g;if(Oe[e]&&(l=new Oe[e]).init(s,l.rawVars?t[e]:ll(t[e],r,s,o,i),i,r,o)!==!1&&(i._pt=h=new Ie(i._pt,s,e,0,1,l.render,l,0,l.priority),i!==si))for(f=i._ptLookup[i._targets.indexOf(s)],g=l._props.length;g--;)f[l._props[g]]=h;return l},kt,$r,gs=function n(e,t,i){var r=e.vars,s=r.ease,o=r.startAt,l=r.immediateRender,h=r.lazy,f=r.onUpdate,g=r.runBackwards,a=r.yoyoEase,c=r.keyframes,p=r.autoRevert,_=e._dur,y=e._startAt,S=e._targets,x=e.parent,v=x&&x.data==="nested"?x.vars.targets:S,P=e._overwrite==="auto"&&!as,E=e.timeline,I,F,M,O,L,W,H,q,K,J,X,ce,ge;if(E&&(!c||!s)&&(s="none"),e._ease=Yt(s,hi.ease),e._yEase=a?Qn(Yt(a===!0?s:a,hi.ease)):0,a&&e._yoyo&&!e._repeat&&(a=e._yEase,e._yEase=e._ease,e._ease=a),e._from=!E&&!!r.runBackwards,!E||c&&!r.stagger){if(q=S[0]?Ut(S[0]).harness:0,ce=q&&r[q.prop],I=ar(r,ds),y&&(y._zTime<0&&y.progress(1),t<0&&g&&l&&!p?y.render(-1,!0):y.revert(g&&_?tr:Ma),y._lazy=0),o){if(Dt(e._startAt=we.set(S,tt({data:"isStart",overwrite:!1,parent:x,immediateRender:!0,lazy:!y&&Ee(h),startAt:null,delay:0,onUpdate:f&&function(){return Ke(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Be||!l&&!p)&&e._startAt.revert(tr),l&&_&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(g&&_&&!y){if(t&&(l=!1),M=tt({overwrite:!1,data:"isFromStart",lazy:l&&!y&&Ee(h),immediateRender:l,stagger:0,parent:x},I),ce&&(M[q.prop]=ce),Dt(e._startAt=we.set(S,M)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Be?e._startAt.revert(tr):e._startAt.render(-1,!0)),e._zTime=t,!l)n(e._startAt,re,re);else if(!t)return}for(e._pt=e._ptCache=0,h=_&&Ee(h)||h&&!_,F=0;F<S.length;F++){if(L=S[F],H=L._gsap||ps(S)[F]._gsap,e._ptLookup[F]=J={},Xr[H.id]&&Ct.length&&or(),X=v===S?F:v.indexOf(L),q&&(K=new q).init(L,ce||I,e,X,v)!==!1&&(e._pt=O=new Ie(e._pt,L,K.name,0,1,K.render,K,0,K.priority),K._props.forEach(function(Fe){J[Fe]=O}),K.priority&&(W=1)),!q||ce)for(M in I)Oe[M]&&(K=ro(M,I,e,X,L,v))?K.priority&&(W=1):J[M]=O=ms.call(e,L,M,"get",I[M],X,v,0,r.stringFilter);e._op&&e._op[F]&&e.kill(L,e._op[F]),P&&e._pt&&(kt=e,ae.killTweensOf(L,J,e.globalTime(t)),ge=!e.parent,kt=0),e._pt&&h&&(Xr[H.id]=1)}W&&co(e),e._onInit&&e._onInit(e)}e._onUpdate=f,e._initted=(!e._op||e._pt)&&!ge,c&&t<=0&&E.render(Qe,!0,!0)},cl=function(e,t,i,r,s,o,l,h){var f=(e._pt&&e._ptCache||(e._ptCache={}))[t],g,a,c,p;if(!f)for(f=e._ptCache[t]=[],c=e._ptLookup,p=e._targets.length;p--;){if(g=c[p][t],g&&g.d&&g.d._pt)for(g=g.d._pt;g&&g.p!==t&&g.fp!==t;)g=g._next;if(!g)return $r=1,e.vars[t]="+=0",gs(e,l),$r=0,h?Li(t+" not eligible for reset"):1;f.push(g)}for(p=f.length;p--;)a=f[p],g=a._pt||a,g.s=(r||r===0)&&!s?r:g.s+(r||0)+o*g.c,g.c=i-g.s,a.e&&(a.e=me(i)+ve(a.e)),a.b&&(a.b=g.s+ve(a.b))},ul=function(e,t){var i=e[0]?Ut(e[0]).harness:0,r=i&&i.aliases,s,o,l,h;if(!r)return t;s=qt({},t);for(o in r)if(o in s)for(h=r[o].split(","),l=h.length;l--;)s[h[l]]=s[o];return s},hl=function(e,t,i,r){var s=t.ease||r||"power1.inOut",o,l;if(Ae(t))l=i[e]||(i[e]=[]),t.forEach(function(h,f){return l.push({t:f/(t.length-1)*100,v:h,e:s})});else for(o in t)l=i[o]||(i[o]=[]),o==="ease"||l.push({t:parseFloat(e),v:t[o],e:s})},Ci=function(e,t,i,r,s){return pe(e)?e.call(t,i,r,s):Se(e)&&~e.indexOf("random(")?Mi(e):e},so=fs+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",no={};De(so+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return no[n]=1});var we=function(n){kn(e,n);function e(i,r,s,o){var l;typeof r=="number"&&(s.duration=r,r=s,s=null),l=n.call(this,o?r:Bi(r))||this;var h=l.vars,f=h.duration,g=h.delay,a=h.immediateRender,c=h.stagger,p=h.overwrite,_=h.keyframes,y=h.defaults,S=h.scrollTrigger,x=h.yoyoEase,v=r.parent||ae,P=(Ae(i)||Bn(i)?wt(i[0]):"length"in r)?[i]:et(i),E,I,F,M,O,L,W,H;if(l._targets=P.length?ps(P):Li("GSAP target "+i+" not found. https://gsap.com",!Xe.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=p,_||c||Ji(f)||Ji(g)){if(r=l.vars,E=l.timeline=new Ce({data:"nested",defaults:y||{},targets:v&&v.data==="nested"?v.vars.targets:P}),E.kill(),E.parent=E._dp=pt(l),E._start=0,c||Ji(f)||Ji(g)){if(M=P.length,W=c&&Kn(c),ft(c))for(O in c)~so.indexOf(O)&&(H||(H={}),H[O]=c[O]);for(I=0;I<M;I++)F=ar(r,no),F.stagger=0,x&&(F.yoyoEase=x),H&&qt(F,H),L=P[I],F.duration=+Ci(f,pt(l),I,L,P),F.delay=(+Ci(g,pt(l),I,L,P)||0)-l._delay,!c&&M===1&&F.delay&&(l._delay=g=F.delay,l._start+=g,F.delay=0),E.to(L,F,W?W(I,L,P):0),E._ease=$.none;E.duration()?f=g=0:l.timeline=0}else if(_){Bi(tt(E.vars.defaults,{ease:"none"})),E._ease=Yt(_.ease||r.ease||"none");var q=0,K,J,X;if(Ae(_))_.forEach(function(ce){return E.to(P,ce,">")}),E.duration();else{F={};for(O in _)O==="ease"||O==="easeEach"||hl(O,_[O],F,_.easeEach);for(O in F)for(K=F[O].sort(function(ce,ge){return ce.t-ge.t}),q=0,I=0;I<K.length;I++)J=K[I],X={ease:J.e,duration:(J.t-(I?K[I-1].t:0))/100*f},X[O]=J.v,E.to(P,X,q),q+=X.duration;E.duration()<f&&E.to({},{duration:f-E.duration()})}}f||l.duration(f=E.duration())}else l.timeline=0;return p===!0&&!as&&(kt=pt(l),ae.killTweensOf(P),kt=0),lt(v,pt(l),s),r.reversed&&l.reverse(),r.paused&&l.paused(!0),(a||!f&&!_&&l._start===be(v._time)&&Ee(a)&&Ya(pt(l))&&v.data!=="nested")&&(l._tTime=-re,l.render(Math.max(0,-g)||0)),S&&Gn(pt(l),S),l}var t=e.prototype;return t.render=function(r,s,o){var l=this._time,h=this._tDur,f=this._dur,g=r<0,a=r>h-re&&!g?h:r<re?0:r,c,p,_,y,S,x,v,P,E;if(!f)Xa(this,r,s,o);else if(a!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==g){if(c=a,P=this.timeline,this._repeat){if(y=f+this._rDelay,this._repeat<-1&&g)return this.totalTime(y*100+r,s,o);if(c=be(a%y),a===h?(_=this._repeat,c=f):(_=~~(a/y),_&&_===be(a/y)&&(c=f,_--),c>f&&(c=f)),x=this._yoyo&&_&1,x&&(E=this._yEase,c=f-c),S=di(this._tTime,y),c===l&&!o&&this._initted&&_===S)return this._tTime=a,this;_!==S&&(P&&this._yEase&&eo(P,x),this.vars.repeatRefresh&&!x&&!this._lock&&this._time!==y&&this._initted&&(this._lock=o=1,this.render(be(y*_),!0).invalidate()._lock=0))}if(!this._initted){if(Un(this,g?r:c,o,s,a))return this._tTime=0,this;if(l!==this._time&&!(o&&this.vars.repeatRefresh&&_!==S))return this;if(f!==this._dur)return this.render(r,s,o)}if(this._tTime=a,this._time=c,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(E||this._ease)(c/f),this._from&&(this.ratio=v=1-v),c&&!l&&!s&&!_&&(Ke(this,"onStart"),this._tTime!==a))return this;for(p=this._pt;p;)p.r(v,p.d),p=p._next;P&&P.render(r<0?r:P._dur*P._ease(c/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(g&&Vr(this,r,s,o),Ke(this,"onUpdate")),this._repeat&&_!==S&&this.vars.onRepeat&&!s&&this.parent&&Ke(this,"onRepeat"),(a===this._tDur||!a)&&this._tTime===a&&(g&&!this._onUpdate&&Vr(this,r,!0,!0),(r||!f)&&(a===this._tDur&&this._ts>0||!a&&this._ts<0)&&Dt(this,1),!s&&!(g&&!l)&&(a||l||x)&&(Ke(this,a===h?"onComplete":"onReverseComplete",!0),this._prom&&!(a<h&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,l,h){zi||Ge.wake(),this._ts||this.play();var f=Math.min(this._dur,(this._dp._time-this._start)*this._ts),g;return this._initted||gs(this,f),g=this._ease(f/this._dur),cl(this,r,s,o,l,g,f,h)?this.resetTo(r,s,o,l,1):(wr(this,0),this.parent||zn(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?ki(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,kt&&kt.vars.overwrite!==!0)._first||ki(this),this.parent&&o!==this.timeline.totalDuration()&&fi(this,this._dur*this.timeline._tDur/o,0,1),this}var l=this._targets,h=r?et(r):l,f=this._ptLookup,g=this._pt,a,c,p,_,y,S,x;if((!s||s==="all")&&Ua(l,h))return s==="all"&&(this._pt=0),ki(this);for(a=this._op=this._op||[],s!=="all"&&(Se(s)&&(y={},De(s,function(v){return y[v]=1}),s=y),s=ul(l,s)),x=l.length;x--;)if(~h.indexOf(l[x])){c=f[x],s==="all"?(a[x]=s,_=c,p={}):(p=a[x]=a[x]||{},_=s);for(y in _)S=c&&c[y],S&&((!("kill"in S.d)||S.d.kill(y)===!0)&&mr(this,S,"_pt"),delete c[y]),p!=="all"&&(p[y]=1)}return this._initted&&!this._pt&&g&&ki(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return Ai(1,arguments)},e.delayedCall=function(r,s,o,l){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:l})},e.fromTo=function(r,s,o){return Ai(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return ae.killTweensOf(r,s,o)},e}(Oi);tt(we.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});De("staggerTo,staggerFrom,staggerFromTo",function(n){we[n]=function(){var e=new Ce,t=qr.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var ws=function(e,t,i){return e[t]=i},oo=function(e,t,i){return e[t](i)},dl=function(e,t,i,r){return e[t](r.fp,i)},fl=function(e,t,i){return e.setAttribute(t,i)},ys=function(e,t){return pe(e[t])?oo:ls(e[t])&&e.setAttribute?fl:ws},ao=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},pl=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},lo=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},_s=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},ml=function(e,t,i,r){for(var s=this._pt,o;s;)o=s._next,s.p===r&&s.modifier(e,t,i),s=o},gl=function(e){for(var t=this._pt,i,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?mr(this,t,"_pt"):t.dep||(i=1),t=r;return!i},wl=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},co=function(e){for(var t=e._pt,i,r,s,o;t;){for(i=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=i}e._pt=s},Ie=function(){function n(t,i,r,s,o,l,h,f,g){this.t=i,this.s=s,this.c=o,this.p=r,this.r=l||ao,this.d=h||this,this.set=f||ws,this.pr=g||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(i,r,s){this.mSet=this.mSet||this.set,this.set=wl,this.m=i,this.mt=s,this.tween=r},n}();De(fs+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return ds[n]=1});We.TweenMax=We.TweenLite=we;We.TimelineLite=We.TimelineMax=Ce;ae=new Ce({sortChildren:!1,defaults:hi,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Xe.stringFilter=Zn;var Kt=[],rr={},yl=[],Vs=0,_l=0,Tr=function(e){return(rr[e]||yl).map(function(t){return t()})},Jr=function(){var e=Date.now(),t=[];e-Vs>2&&(Tr("matchMediaInit"),Kt.forEach(function(i){var r=i.queries,s=i.conditions,o,l,h,f;for(l in r)o=ot.matchMedia(r[l]).matches,o&&(h=1),o!==s[l]&&(s[l]=o,f=1);f&&(i.revert(),h&&t.push(i))}),Tr("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(r){return i.add(null,r)})}),Vs=e,Tr("matchMedia"))},uo=function(){function n(t,i){this.selector=i&&jr(i),this.data=[],this._r=[],this.isReverted=!1,this.id=_l++,t&&this.add(t)}var e=n.prototype;return e.add=function(i,r,s){pe(i)&&(s=r,r=i,i=pe);var o=this,l=function(){var f=oe,g=o.selector,a;return f&&f!==o&&f.data.push(o),s&&(o.selector=jr(s)),oe=o,a=r.apply(o,arguments),pe(a)&&o._r.push(a),oe=f,o.selector=g,o.isReverted=!1,a};return o.last=l,i===pe?l(o,function(h){return o.add(null,h)}):i?o[i]=l:l},e.ignore=function(i){var r=oe;oe=null,i(this),oe=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof n?i.push.apply(i,r.getTweens()):r instanceof we&&!(r.parent&&r.parent.data==="nested")&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var s=this;if(i?function(){for(var l=s.getTweens(),h=s.data.length,f;h--;)f=s.data[h],f.data==="isFlip"&&(f.revert(),f.getChildren(!0,!0,!1).forEach(function(g){return l.splice(l.indexOf(g),1)}));for(l.map(function(g){return{g:g._dur||g._delay||g._sat&&!g._sat.vars.immediateRender?g.globalTime(0):-1/0,t:g}}).sort(function(g,a){return a.g-g.g||-1/0}).forEach(function(g){return g.t.revert(i)}),h=s.data.length;h--;)f=s.data[h],f instanceof Ce?f.data!=="nested"&&(f.scrollTrigger&&f.scrollTrigger.revert(),f.kill()):!(f instanceof we)&&f.revert&&f.revert(i);s._r.forEach(function(g){return g(i,s)}),s.isReverted=!0}():this.data.forEach(function(l){return l.kill&&l.kill()}),this.clear(),r)for(var o=Kt.length;o--;)Kt[o].id===this.id&&Kt.splice(o,1)},e.revert=function(i){this.kill(i||{})},n}(),bl=function(){function n(t){this.contexts=[],this.scope=t,oe&&oe.data.push(this)}var e=n.prototype;return e.add=function(i,r,s){ft(i)||(i={matches:i});var o=new uo(0,s||this.scope),l=o.conditions={},h,f,g;oe&&!o.selector&&(o.selector=oe.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=i;for(f in i)f==="all"?g=1:(h=ot.matchMedia(i[f]),h&&(Kt.indexOf(o)<0&&Kt.push(o),(l[f]=h.matches)&&(g=1),h.addListener?h.addListener(Jr):h.addEventListener("change",Jr)));return g&&r(o,function(a){return o.add(null,a)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},n}(),cr={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return Hn(r)})},timeline:function(e){return new Ce(e)},getTweensOf:function(e,t){return ae.getTweensOf(e,t)},getProperty:function(e,t,i,r){Se(e)&&(e=et(e)[0]);var s=Ut(e||{}).get,o=i?Mn:Fn;return i==="native"&&(i=""),e&&(t?o((Oe[t]&&Oe[t].get||s)(e,t,i,r)):function(l,h,f){return o((Oe[l]&&Oe[l].get||s)(e,l,h,f))})},quickSetter:function(e,t,i){if(e=et(e),e.length>1){var r=e.map(function(g){return Le.quickSetter(g,t,i)}),s=r.length;return function(g){for(var a=s;a--;)r[a](g)}}e=e[0]||{};var o=Oe[t],l=Ut(e),h=l.harness&&(l.harness.aliases||{})[t]||t,f=o?function(g){var a=new o;si._pt=0,a.init(e,i?g+i:g,si,0,[e]),a.render(1,a),si._pt&&_s(1,si)}:l.set(e,h);return o?f:function(g){return f(e,h,i?g+i:g,l,1)}},quickTo:function(e,t,i){var r,s=Le.to(e,qt((r={},r[t]="+=0.1",r.paused=!0,r),i||{})),o=function(h,f,g){return s.resetTo(t,h,f,g)};return o.tween=s,o},isTweening:function(e){return ae.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Yt(e.ease,hi.ease)),Us(hi,e||{})},config:function(e){return Us(Xe,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,r=e.plugins,s=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach(function(l){return l&&!Oe[l]&&!We[l]&&Li(t+" effect requires "+l+" plugin.")}),Br[t]=function(l,h,f){return i(et(l),tt(h||{},s),f)},o&&(Ce.prototype[t]=function(l,h,f){return this.add(Br[t](l,ft(h)?h:(f=h)&&{},this),f)})},registerEase:function(e,t){$[e]=Yt(t)},parseEase:function(e,t){return arguments.length?Yt(e,t):$},getById:function(e){return ae.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new Ce(e),r,s;for(i.smoothChildTiming=Ee(e.smoothChildTiming),ae.remove(i),i._dp=0,i._time=i._tTime=ae._time,r=ae._first;r;)s=r._next,(t||!(!r._dur&&r instanceof we&&r.vars.onComplete===r._targets[0]))&&lt(i,r,r._start-r._delay),r=s;return lt(ae,i,0),i},context:function(e,t){return e?new uo(e,t):oe},matchMedia:function(e){return new bl(e)},matchMediaRefresh:function(){return Kt.forEach(function(e){var t=e.conditions,i,r;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||Jr()},addEventListener:function(e,t){var i=rr[e]||(rr[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=rr[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap:Za,wrapYoyo:Qa,distribute:Kn,random:Vn,snap:Xn,normalize:Ja,getUnit:ve,clamp:qa,splitColor:$n,toArray:et,selector:jr,mapRange:qn,pipe:Ha,unitize:$a,interpolate:el,shuffle:Yn},install:En,effects:Br,ticker:Ge,updateRoot:Ce.updateRoot,plugins:Oe,globalTimeline:ae,core:{PropTween:Ie,globals:Dn,Tween:we,Timeline:Ce,Animation:Oi,getCache:Ut,_removeLinkedListItem:mr,reverting:function(){return Be},context:function(e){return e&&oe&&(oe.data.push(e),e._ctx=oe),oe},suppressOverwrites:function(e){return as=e}}};De("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return cr[n]=we[n]});Ge.add(Ce.updateRoot);si=cr.to({},{duration:0});var Sl=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},xl=function(e,t){var i=e._targets,r,s,o;for(r in t)for(s=i.length;s--;)o=e._ptLookup[s][r],o&&(o=o.d)&&(o._pt&&(o=Sl(o,r)),o&&o.modifier&&o.modifier(t[r],e,i[s],r))},Er=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(l){var h,f;if(Se(s)&&(h={},De(s,function(g){return h[g]=1}),s=h),t){h={};for(f in s)h[f]=t(s[f]);s=h}xl(l,s)}}}},Le=cr.registerPlugin({name:"attr",init:function(e,t,i,r,s){var o,l,h;this.tween=i;for(o in t)h=e.getAttribute(o)||"",l=this.add(e,"setAttribute",(h||0)+"",t[o],r,s,0,0,o),l.op=o,l.b=h,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)Be?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Er("roundProps",Hr),Er("modifiers"),Er("snap",Xn))||cr;we.version=Ce.version=Le.version="3.12.5";Tn=1;cs()&&pi();$.Power0;$.Power1;$.Power2;$.Power3;$.Power4;$.Linear;$.Quad;$.Cubic;$.Quart;$.Quint;$.Strong;$.Elastic;$.Back;$.SteppedEase;$.Bounce;$.Sine;$.Expo;$.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ws,vt,ai,bs,Gt,qs,Ss,kl=function(){return typeof window<"u"},yt={},zt=180/Math.PI,li=Math.PI/180,ei=Math.atan2,js=1e8,xs=/([A-Z])/g,vl=/(left|right|width|margin|padding|x)/i,Bl=/[\s,\(]\S/,ut={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Zr=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Al=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Cl=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},Pl=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},ho=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},fo=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},Tl=function(e,t,i){return e.style[t]=i},El=function(e,t,i){return e.style.setProperty(t,i)},Dl=function(e,t,i){return e._gsap[t]=i},Il=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},Rl=function(e,t,i,r,s){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(s,o)},Ll=function(e,t,i,r,s){var o=e._gsap;o[t]=i,o.renderTransform(s,o)},le="transform",Re=le+"Origin",Fl=function n(e,t){var i=this,r=this.target,s=r.style,o=r._gsap;if(e in yt&&s){if(this.tfm=this.tfm||{},e!=="transform")e=ut[e]||e,~e.indexOf(",")?e.split(",").forEach(function(l){return i.tfm[l]=gt(r,l)}):this.tfm[e]=o.x?o[e]:gt(r,e),e===Re&&(this.tfm.zOrigin=o.zOrigin);else return ut.transform.split(",").forEach(function(l){return n.call(i,l,t)});if(this.props.indexOf(le)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Re,t,"")),e=le}(s||t)&&this.props.push(e,t,s[e])},po=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Ml=function(){var e=this.props,t=this.target,i=t.style,r=t._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(xs,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=Ss(),(!s||!s.isStart)&&!i[le]&&(po(i),r.zOrigin&&i[Re]&&(i[Re]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},mo=function(e,t){var i={target:e,props:[],revert:Ml,save:Fl};return e._gsap||Le.core.getCache(e),t&&t.split(",").forEach(function(r){return i.save(r)}),i},go,Qr=function(e,t){var i=vt.createElementNS?vt.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):vt.createElement(e);return i&&i.style?i:vt.createElement(e)},dt=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(xs,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,mi(t)||t,1)||""},Hs="O,Moz,ms,Ms,Webkit".split(","),mi=function(e,t,i){var r=t||Gt,s=r.style,o=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(Hs[o]+e in s););return o<0?null:(o===3?"ms":o>=0?Hs[o]:"")+e},es=function(){kl()&&window.document&&(Ws=window,vt=Ws.document,ai=vt.documentElement,Gt=Qr("div")||{style:{}},Qr("div"),le=mi(le),Re=le+"Origin",Gt.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",go=!!mi("perspective"),Ss=Le.core.reverting,bs=1)},Dr=function n(e){var t=Qr("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,s=this.style.cssText,o;if(ai.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),ai.removeChild(t),this.style.cssText=s,o},$s=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},wo=function(e){var t;try{t=e.getBBox()}catch{t=Dr.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Dr||(t=Dr.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+$s(e,["x","cx","x1"])||0,y:+$s(e,["y","cy","y1"])||0,width:0,height:0}:t},yo=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&wo(e))},jt=function(e,t){if(t){var i=e.style,r;t in yt&&t!==Re&&(t=le),i.removeProperty?(r=t.substr(0,2),(r==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(r==="--"?t:t.replace(xs,"-$1").toLowerCase())):i.removeAttribute(t)}},Bt=function(e,t,i,r,s,o){var l=new Ie(e._pt,t,i,0,1,o?fo:ho);return e._pt=l,l.b=r,l.e=s,e._props.push(i),l},Js={deg:1,rad:1,turn:1},zl={grid:1,flex:1},It=function n(e,t,i,r){var s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",l=Gt.style,h=vl.test(t),f=e.tagName.toLowerCase()==="svg",g=(f?"client":"offset")+(h?"Width":"Height"),a=100,c=r==="px",p=r==="%",_,y,S,x;if(r===o||!s||Js[r]||Js[o])return s;if(o!=="px"&&!c&&(s=n(e,t,i,"px")),x=e.getCTM&&yo(e),(p||o==="%")&&(yt[t]||~t.indexOf("adius")))return _=x?e.getBBox()[h?"width":"height"]:e[g],me(p?s/_*a:s/100*_);if(l[h?"width":"height"]=a+(c?o:r),y=~t.indexOf("adius")||r==="em"&&e.appendChild&&!f?e:e.parentNode,x&&(y=(e.ownerSVGElement||{}).parentNode),(!y||y===vt||!y.appendChild)&&(y=vt.body),S=y._gsap,S&&p&&S.width&&h&&S.time===Ge.time&&!S.uncache)return me(s/S.width*a);if(p&&(t==="height"||t==="width")){var v=e.style[t];e.style[t]=a+r,_=e[g],v?e.style[t]=v:jt(e,t)}else(p||o==="%")&&!zl[dt(y,"display")]&&(l.position=dt(e,"position")),y===e&&(l.position="static"),y.appendChild(Gt),_=Gt[g],y.removeChild(Gt),l.position="absolute";return h&&p&&(S=Ut(y),S.time=Ge.time,S.width=y[g]),me(c?_*s/a:_&&s?a/_*s:0)},gt=function(e,t,i,r){var s;return bs||es(),t in ut&&t!=="transform"&&(t=ut[t],~t.indexOf(",")&&(t=t.split(",")[0])),yt[t]&&t!=="transform"?(s=Ui(e,r),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:hr(dt(e,Re))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=ur[t]&&ur[t](e,t,i)||dt(e,t)||Rn(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?It(e,t,s,i)+i:s},Ol=function(e,t,i,r){if(!i||i==="none"){var s=mi(t,e,1),o=s&&dt(e,s,1);o&&o!==i?(t=s,i=o):t==="borderColor"&&(i=dt(e,"borderTopColor"))}var l=new Ie(this._pt,e.style,t,0,1,lo),h=0,f=0,g,a,c,p,_,y,S,x,v,P,E,I;if(l.b=i,l.e=r,i+="",r+="",r==="auto"&&(y=e.style[t],e.style[t]=r,r=dt(e,t)||r,y?e.style[t]=y:jt(e,t)),g=[i,r],Zn(g),i=g[0],r=g[1],c=i.match(ri)||[],I=r.match(ri)||[],I.length){for(;a=ri.exec(r);)S=a[0],v=r.substring(h,a.index),_?_=(_+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(_=1),S!==(y=c[f++]||"")&&(p=parseFloat(y)||0,E=y.substr((p+"").length),S.charAt(1)==="="&&(S=oi(p,S)+E),x=parseFloat(S),P=S.substr((x+"").length),h=ri.lastIndex-P.length,P||(P=P||Xe.units[t]||E,h===r.length&&(r+=P,l.e+=P)),E!==P&&(p=It(e,t,y,P)||0),l._pt={_next:l._pt,p:v||f===1?v:",",s:p,c:x-p,m:_&&_<4||t==="zIndex"?Math.round:0});l.c=h<r.length?r.substring(h,r.length):""}else l.r=t==="display"&&r==="none"?fo:ho;return Cn.test(r)&&(l.e=0),this._pt=l,l},Zs={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Gl=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return(i==="top"||i==="bottom"||r==="left"||r==="right")&&(e=i,i=r,r=e),t[0]=Zs[i]||i,t[1]=Zs[r]||r,t.join(" ")},Ul=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,r=i.style,s=t.u,o=i._gsap,l,h,f;if(s==="all"||s===!0)r.cssText="",h=1;else for(s=s.split(","),f=s.length;--f>-1;)l=s[f],yt[l]&&(h=1,l=l==="transformOrigin"?Re:le),jt(i,l);h&&(jt(i,le),o&&(o.svg&&i.removeAttribute("transform"),Ui(i,1),o.uncache=1,po(r)))}},ur={clearProps:function(e,t,i,r,s){if(s.data!=="isFromStart"){var o=e._pt=new Ie(e._pt,t,i,0,0,Ul);return o.u=r,o.pr=-10,o.tween=s,e._props.push(i),1}}},Gi=[1,0,0,1,0,0],_o={},bo=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},Qs=function(e){var t=dt(e,le);return bo(t)?Gi:t.substr(7).match(An).map(me)},ks=function(e,t){var i=e._gsap||Ut(e),r=e.style,s=Qs(e),o,l,h,f;return i.svg&&e.getAttribute("transform")?(h=e.transform.baseVal.consolidate().matrix,s=[h.a,h.b,h.c,h.d,h.e,h.f],s.join(",")==="1,0,0,1,0,0"?Gi:s):(s===Gi&&!e.offsetParent&&e!==ai&&!i.svg&&(h=r.display,r.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(f=1,l=e.nextElementSibling,ai.appendChild(e)),s=Qs(e),h?r.display=h:jt(e,"display"),f&&(l?o.insertBefore(e,l):o?o.appendChild(e):ai.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},ts=function(e,t,i,r,s,o){var l=e._gsap,h=s||ks(e,!0),f=l.xOrigin||0,g=l.yOrigin||0,a=l.xOffset||0,c=l.yOffset||0,p=h[0],_=h[1],y=h[2],S=h[3],x=h[4],v=h[5],P=t.split(" "),E=parseFloat(P[0])||0,I=parseFloat(P[1])||0,F,M,O,L;i?h!==Gi&&(M=p*S-_*y)&&(O=E*(S/M)+I*(-y/M)+(y*v-S*x)/M,L=E*(-_/M)+I*(p/M)-(p*v-_*x)/M,E=O,I=L):(F=wo(e),E=F.x+(~P[0].indexOf("%")?E/100*F.width:E),I=F.y+(~(P[1]||P[0]).indexOf("%")?I/100*F.height:I)),r||r!==!1&&l.smooth?(x=E-f,v=I-g,l.xOffset=a+(x*p+v*y)-x,l.yOffset=c+(x*_+v*S)-v):l.xOffset=l.yOffset=0,l.xOrigin=E,l.yOrigin=I,l.smooth=!!r,l.origin=t,l.originIsAbsolute=!!i,e.style[Re]="0px 0px",o&&(Bt(o,l,"xOrigin",f,E),Bt(o,l,"yOrigin",g,I),Bt(o,l,"xOffset",a,l.xOffset),Bt(o,l,"yOffset",c,l.yOffset)),e.setAttribute("data-svg-origin",E+" "+I)},Ui=function(e,t){var i=e._gsap||new io(e);if("x"in i&&!t&&!i.uncache)return i;var r=e.style,s=i.scaleX<0,o="px",l="deg",h=getComputedStyle(e),f=dt(e,Re)||"0",g,a,c,p,_,y,S,x,v,P,E,I,F,M,O,L,W,H,q,K,J,X,ce,ge,Fe,Jt,Lt,se,ue,bi,qe,rt;return g=a=c=y=S=x=v=P=E=0,p=_=1,i.svg=!!(e.getCTM&&yo(e)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(r[le]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[le]!=="none"?h[le]:"")),r.scale=r.rotate=r.translate="none"),M=ks(e,i.svg),i.svg&&(i.uncache?(Fe=e.getBBox(),f=i.xOrigin-Fe.x+"px "+(i.yOrigin-Fe.y)+"px",ge=""):ge=!t&&e.getAttribute("data-svg-origin"),ts(e,ge||f,!!ge||i.originIsAbsolute,i.smooth!==!1,M)),I=i.xOrigin||0,F=i.yOrigin||0,M!==Gi&&(H=M[0],q=M[1],K=M[2],J=M[3],g=X=M[4],a=ce=M[5],M.length===6?(p=Math.sqrt(H*H+q*q),_=Math.sqrt(J*J+K*K),y=H||q?ei(q,H)*zt:0,v=K||J?ei(K,J)*zt+y:0,v&&(_*=Math.abs(Math.cos(v*li))),i.svg&&(g-=I-(I*H+F*K),a-=F-(I*q+F*J))):(rt=M[6],bi=M[7],Lt=M[8],se=M[9],ue=M[10],qe=M[11],g=M[12],a=M[13],c=M[14],O=ei(rt,ue),S=O*zt,O&&(L=Math.cos(-O),W=Math.sin(-O),ge=X*L+Lt*W,Fe=ce*L+se*W,Jt=rt*L+ue*W,Lt=X*-W+Lt*L,se=ce*-W+se*L,ue=rt*-W+ue*L,qe=bi*-W+qe*L,X=ge,ce=Fe,rt=Jt),O=ei(-K,ue),x=O*zt,O&&(L=Math.cos(-O),W=Math.sin(-O),ge=H*L-Lt*W,Fe=q*L-se*W,Jt=K*L-ue*W,qe=J*W+qe*L,H=ge,q=Fe,K=Jt),O=ei(q,H),y=O*zt,O&&(L=Math.cos(O),W=Math.sin(O),ge=H*L+q*W,Fe=X*L+ce*W,q=q*L-H*W,ce=ce*L-X*W,H=ge,X=Fe),S&&Math.abs(S)+Math.abs(y)>359.9&&(S=y=0,x=180-x),p=me(Math.sqrt(H*H+q*q+K*K)),_=me(Math.sqrt(ce*ce+rt*rt)),O=ei(X,ce),v=Math.abs(O)>2e-4?O*zt:0,E=qe?1/(qe<0?-qe:qe):0),i.svg&&(ge=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!bo(dt(e,le)),ge&&e.setAttribute("transform",ge))),Math.abs(v)>90&&Math.abs(v)<270&&(s?(p*=-1,v+=y<=0?180:-180,y+=y<=0?180:-180):(_*=-1,v+=v<=0?180:-180)),t=t||i.uncache,i.x=g-((i.xPercent=g&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-g)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=a-((i.yPercent=a&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-a)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=c+o,i.scaleX=me(p),i.scaleY=me(_),i.rotation=me(y)+l,i.rotationX=me(S)+l,i.rotationY=me(x)+l,i.skewX=v+l,i.skewY=P+l,i.transformPerspective=E+o,(i.zOrigin=parseFloat(f.split(" ")[2])||!t&&i.zOrigin||0)&&(r[Re]=hr(f)),i.xOffset=i.yOffset=0,i.force3D=Xe.force3D,i.renderTransform=i.svg?Yl:go?So:Nl,i.uncache=0,i},hr=function(e){return(e=e.split(" "))[0]+" "+e[1]},Ir=function(e,t,i){var r=ve(t);return me(parseFloat(t)+parseFloat(It(e,"x",i+"px",r)))+r},Nl=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,So(e,t)},Ft="0deg",xi="0px",Mt=") ",So=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,l=i.y,h=i.z,f=i.rotation,g=i.rotationY,a=i.rotationX,c=i.skewX,p=i.skewY,_=i.scaleX,y=i.scaleY,S=i.transformPerspective,x=i.force3D,v=i.target,P=i.zOrigin,E="",I=x==="auto"&&e&&e!==1||x===!0;if(P&&(a!==Ft||g!==Ft)){var F=parseFloat(g)*li,M=Math.sin(F),O=Math.cos(F),L;F=parseFloat(a)*li,L=Math.cos(F),o=Ir(v,o,M*L*-P),l=Ir(v,l,-Math.sin(F)*-P),h=Ir(v,h,O*L*-P+P)}S!==xi&&(E+="perspective("+S+Mt),(r||s)&&(E+="translate("+r+"%, "+s+"%) "),(I||o!==xi||l!==xi||h!==xi)&&(E+=h!==xi||I?"translate3d("+o+", "+l+", "+h+") ":"translate("+o+", "+l+Mt),f!==Ft&&(E+="rotate("+f+Mt),g!==Ft&&(E+="rotateY("+g+Mt),a!==Ft&&(E+="rotateX("+a+Mt),(c!==Ft||p!==Ft)&&(E+="skew("+c+", "+p+Mt),(_!==1||y!==1)&&(E+="scale("+_+", "+y+Mt),v.style[le]=E||"translate(0, 0)"},Yl=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,l=i.y,h=i.rotation,f=i.skewX,g=i.skewY,a=i.scaleX,c=i.scaleY,p=i.target,_=i.xOrigin,y=i.yOrigin,S=i.xOffset,x=i.yOffset,v=i.forceCSS,P=parseFloat(o),E=parseFloat(l),I,F,M,O,L;h=parseFloat(h),f=parseFloat(f),g=parseFloat(g),g&&(g=parseFloat(g),f+=g,h+=g),h||f?(h*=li,f*=li,I=Math.cos(h)*a,F=Math.sin(h)*a,M=Math.sin(h-f)*-c,O=Math.cos(h-f)*c,f&&(g*=li,L=Math.tan(f-g),L=Math.sqrt(1+L*L),M*=L,O*=L,g&&(L=Math.tan(g),L=Math.sqrt(1+L*L),I*=L,F*=L)),I=me(I),F=me(F),M=me(M),O=me(O)):(I=a,O=c,F=M=0),(P&&!~(o+"").indexOf("px")||E&&!~(l+"").indexOf("px"))&&(P=It(p,"x",o,"px"),E=It(p,"y",l,"px")),(_||y||S||x)&&(P=me(P+_-(_*I+y*M)+S),E=me(E+y-(_*F+y*O)+x)),(r||s)&&(L=p.getBBox(),P=me(P+r/100*L.width),E=me(E+s/100*L.height)),L="matrix("+I+","+F+","+M+","+O+","+P+","+E+")",p.setAttribute("transform",L),v&&(p.style[le]=L)},Kl=function(e,t,i,r,s){var o=360,l=Se(s),h=parseFloat(s)*(l&&~s.indexOf("rad")?zt:1),f=h-r,g=r+f+"deg",a,c;return l&&(a=s.split("_")[1],a==="short"&&(f%=o,f!==f%(o/2)&&(f+=f<0?o:-o)),a==="cw"&&f<0?f=(f+o*js)%o-~~(f/o)*o:a==="ccw"&&f>0&&(f=(f-o*js)%o-~~(f/o)*o)),e._pt=c=new Ie(e._pt,t,i,r,f,Al),c.e=g,c.u="deg",e._props.push(i),c},en=function(e,t){for(var i in t)e[i]=t[i];return e},Xl=function(e,t,i){var r=en({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=i.style,l,h,f,g,a,c,p,_;r.svg?(f=i.getAttribute("transform"),i.setAttribute("transform",""),o[le]=t,l=Ui(i,1),jt(i,le),i.setAttribute("transform",f)):(f=getComputedStyle(i)[le],o[le]=t,l=Ui(i,1),o[le]=f);for(h in yt)f=r[h],g=l[h],f!==g&&s.indexOf(h)<0&&(p=ve(f),_=ve(g),a=p!==_?It(i,h,f,_):parseFloat(f),c=parseFloat(g),e._pt=new Ie(e._pt,l,h,a,c-a,Zr),e._pt.u=_||0,e._props.push(h));en(l,r)};De("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",s="Left",o=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(l){return e<2?n+l:"border"+l+n});ur[e>1?"border"+n:n]=function(l,h,f,g,a){var c,p;if(arguments.length<4)return c=o.map(function(_){return gt(l,_,f)}),p=c.join(" "),p.split(c[0]).length===5?c[0]:p;c=(g+"").split(" "),p={},o.forEach(function(_,y){return p[_]=c[y]=c[y]||c[(y-1)/2|0]}),l.init(h,p,a)}});var xo={name:"css",register:es,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,s){var o=this._props,l=e.style,h=i.vars.startAt,f,g,a,c,p,_,y,S,x,v,P,E,I,F,M,O;bs||es(),this.styles=this.styles||mo(e),O=this.styles.props,this.tween=i;for(y in t)if(y!=="autoRound"&&(g=t[y],!(Oe[y]&&ro(y,t,i,r,e,s)))){if(p=typeof g,_=ur[y],p==="function"&&(g=g.call(i,r,e,s),p=typeof g),p==="string"&&~g.indexOf("random(")&&(g=Mi(g)),_)_(this,e,y,g,i)&&(M=1);else if(y.substr(0,2)==="--")f=(getComputedStyle(e).getPropertyValue(y)+"").trim(),g+="",Pt.lastIndex=0,Pt.test(f)||(S=ve(f),x=ve(g)),x?S!==x&&(f=It(e,y,f,x)+x):S&&(g+=S),this.add(l,"setProperty",f,g,r,s,0,0,y),o.push(y),O.push(y,0,l[y]);else if(p!=="undefined"){if(h&&y in h?(f=typeof h[y]=="function"?h[y].call(i,r,e,s):h[y],Se(f)&&~f.indexOf("random(")&&(f=Mi(f)),ve(f+"")||f==="auto"||(f+=Xe.units[y]||ve(gt(e,y))||""),(f+"").charAt(1)==="="&&(f=gt(e,y))):f=gt(e,y),c=parseFloat(f),v=p==="string"&&g.charAt(1)==="="&&g.substr(0,2),v&&(g=g.substr(2)),a=parseFloat(g),y in ut&&(y==="autoAlpha"&&(c===1&&gt(e,"visibility")==="hidden"&&a&&(c=0),O.push("visibility",0,l.visibility),Bt(this,l,"visibility",c?"inherit":"hidden",a?"inherit":"hidden",!a)),y!=="scale"&&y!=="transform"&&(y=ut[y],~y.indexOf(",")&&(y=y.split(",")[0]))),P=y in yt,P){if(this.styles.save(y),E||(I=e._gsap,I.renderTransform&&!t.parseTransform||Ui(e,t.parseTransform),F=t.smoothOrigin!==!1&&I.smooth,E=this._pt=new Ie(this._pt,l,le,0,1,I.renderTransform,I,0,-1),E.dep=1),y==="scale")this._pt=new Ie(this._pt,I,"scaleY",I.scaleY,(v?oi(I.scaleY,v+a):a)-I.scaleY||0,Zr),this._pt.u=0,o.push("scaleY",y),y+="X";else if(y==="transformOrigin"){O.push(Re,0,l[Re]),g=Gl(g),I.svg?ts(e,g,0,F,0,this):(x=parseFloat(g.split(" ")[2])||0,x!==I.zOrigin&&Bt(this,I,"zOrigin",I.zOrigin,x),Bt(this,l,y,hr(f),hr(g)));continue}else if(y==="svgOrigin"){ts(e,g,1,F,0,this);continue}else if(y in _o){Kl(this,I,y,c,v?oi(c,v+g):g);continue}else if(y==="smoothOrigin"){Bt(this,I,"smooth",I.smooth,g);continue}else if(y==="force3D"){I[y]=g;continue}else if(y==="transform"){Xl(this,g,e);continue}}else y in l||(y=mi(y)||y);if(P||(a||a===0)&&(c||c===0)&&!Bl.test(g)&&y in l)S=(f+"").substr((c+"").length),a||(a=0),x=ve(g)||(y in Xe.units?Xe.units[y]:S),S!==x&&(c=It(e,y,f,x)),this._pt=new Ie(this._pt,P?I:l,y,c,(v?oi(c,v+a):a)-c,!P&&(x==="px"||y==="zIndex")&&t.autoRound!==!1?Pl:Zr),this._pt.u=x||0,S!==x&&x!=="%"&&(this._pt.b=f,this._pt.r=Cl);else if(y in l)Ol.call(this,e,y,f,v?v+g:g);else if(y in e)this.add(e,y,f||e[y],v?v+g:g,r,s);else if(y!=="parseTransform"){hs(y,g);continue}P||(y in l?O.push(y,0,l[y]):O.push(y,1,f||e[y])),o.push(y)}}M&&co(this)},render:function(e,t){if(t.tween._time||!Ss())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:gt,aliases:ut,getSetter:function(e,t,i){var r=ut[t];return r&&r.indexOf(",")<0&&(t=r),t in yt&&t!==Re&&(e._gsap.x||gt(e,"x"))?i&&qs===i?t==="scale"?Il:Dl:(qs=i||{})&&(t==="scale"?Rl:Ll):e.style&&!ls(e.style[t])?Tl:~t.indexOf("-")?El:ys(e,t)},core:{_removeProperty:jt,_getMatrix:ks}};Le.utils.checkPrefix=mi;Le.core.getStyleSaver=mo;(function(n,e,t,i){var r=De(n+","+e+","+t,function(s){yt[s]=1});De(e,function(s){Xe.units[s]="deg",_o[s]=1}),ut[r[13]]=n+","+e,De(i,function(s){var o=s.split(":");ut[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");De("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Xe.units[n]="px"});Le.registerPlugin(xo);var Tt=Le.registerPlugin(xo)||Le;Tt.core.Tween;const St=class St{constructor(e,t){m(this,"el");m(this,"createdAt");m(this,"fadingOut",!1);this.player=e,this.createdAt=Date.now(),this.el=T("div.chat-bubble",[T("div.content",t),T("div.arrow")])}setPosition(e,t){const i=e+St.X_OFFSET;this.el.style.left=`${i}px`,this.el.style.top=`${t}px`}setVisibility(e){Pe(this.el,{visibility:e?"visible":"hidden"})}tick(){Date.now()-this.createdAt>St.DURATION&&!this.fadingOut&&(this.fadingOut=!0,Tt.to(this.el,{duration:St.FADE_DURATION,opacity:0,onComplete:this.remove.bind(this)}))}remove(){this.player.removeChatBubble(this)}};m(St,"DURATION",1e4),m(St,"FADE_DURATION",.75),m(St,"X_OFFSET",12);let is=St;const Vl=10,Wl=15,ql=7.752,jl=2,Hl=26,$l=16,Jl={base:.9813195279915707,noModifier:.9045276172161356,ladder:.9045276172161356,water:.9512631926190678},Zl={water:-.5},fe={msPerTick:Vl,maxMsPerTick:Wl,variableMultiplier:ql,gravity:jl,jumpHeight:Hl,boostSpeed:$l,drag:Jl,buoyancy:Zl};class Ql{constructor(){m(this,"frame",0);m(this,"x",0);m(this,"y",0);m(this,"isDead",!1)}}class vs extends Ql{constructor(t,i){super();m(this,"angle",0);m(this,"speed",0);this.player=t,this.frame=Math.floor(Math.random()*3)+1,this.x=t.x+8,this.y=t.y+8,this.angle=i,this.speed=Math.random()+.8}tick(){this.player.isDead||(this.isDead=!0);let t=this.angle*Math.PI/180;this.x+=Math.cos(t)*this.speed,this.y+=Math.sin(t)*this.speed,this.speed-=.05,this.speed<0&&(this.speed=0,this.isDead=!0)}static createDeathExplosion(t){const i=[];for(let r=0;r<360;r+=12){let s=Math.random()*5;i.push(new vs(t,(r+s)%360))}return i}}let tn=class{constructor(e){m(this,"player");m(this,"hasChanged",!1);m(this,"goldCoins",0);m(this,"blueCoins",0);m(this,"deaths",0);m(this,"delayedGoldCoins",0);m(this,"delayedBlueCoins",0);m(this,"delayedDeaths",0);this.player=e}delayAll(){this.delay("goldCoins","delayedGoldCoins"),this.delay("blueCoins","delayedBlueCoins"),this.delay("deaths","delayedDeaths")}delay(e,t){if(this[t]!==this[e]){const i=this[t];this[t]=this[e],this.player.state.world.collidesWith(this.player)&&(this[t]=i)}}};class rn{constructor(e,t=!1){m(this,"state");m(this,"initialized",!1);m(this,"id",0);m(this,"connectUserId","");m(this,"username","player");m(this,"isAdmin",!1);m(this,"lastPortalPos",null);m(this,"x",0);m(this,"y",0);m(this,"width",16);m(this,"height",16);m(this,"overlapA",-1);m(this,"overlapB",-1);m(this,"overlapC",-1);m(this,"overlapD",-1);m(this,"activeKeys",{red:!1,green:!1,blue:!1});m(this,"_speedX",0);m(this,"_speedY",0);m(this,"_modifierX",0);m(this,"_modifierY",0);m(this,"morX",0);m(this,"morY",0);m(this,"moX",0);m(this,"moY",0);m(this,"mx",0);m(this,"my",0);m(this,"ox",0);m(this,"oy",0);m(this,"pastPos",null);m(this,"reminderX",0);m(this,"reminderY",0);m(this,"currentSpeedX",0);m(this,"currentSpeedY",0);m(this,"horizontal",0);m(this,"vertical",0);m(this,"spaceDown",!1);m(this,"spaceJustDown",!1);m(this,"lastHorizontal",0);m(this,"lastVertical",0);m(this,"lastSpaceDown",!1);m(this,"lastSpaceJustDown",!1);m(this,"justTeleported",!1);m(this,"lastJump",0);m(this,"tickId",0);m(this,"queue",[]);m(this,"isInGodMode",!1);m(this,"isInModMode",!1);m(this,"face",0);m(this,"aura",0);m(this,"isDead",!1);m(this,"isRespawning",!1);m(this,"deathFrame",0);m(this,"staffAuraFrame",0);m(this,"hasWinnerCrown",!1);m(this,"counters",new tn(this));m(this,"switches",new Uint8Array(1e3));m(this,"delayedLocalSwitches",new Uint8Array(1e3));m(this,"delayedGlobalSwitches",new Uint8Array(1e3));m(this,"isMe");m(this,"usernameLabel");m(this,"chatBubbles",[]);this.state=e,this.isMe=t,this.queue=[0,0]}get usernameColor(){return this.isAdmin?"#FFD700":"#FFFFFF"}get blockX(){return Math.round(this.x/it.TileSize)}get blockY(){return Math.round(this.y/it.TileSize)}get isFlying(){return this.isInGodMode||this.isInModMode}get minimapColor(){return this.isInModMode?16766720:this.isMe?65280:16777215}mountUsernameLabel(){this.usernameLabel=new ba(this.username,this.isMe,this.usernameColor),Y(this.state.usernameLabels,this.usernameLabel)}unmountUsernameLabel(){this.usernameLabel&&ye(this.state.usernameLabels,this.usernameLabel)}addChatBubble(e){const t=new is(this,e);Y(this.state.chatBubbles,t),this.chatBubbles.unshift(t),this.chatBubbles.length>3&&this.removeChatBubble(this.chatBubbles.pop())}removeChatBubble(e){ye(this.state.chatBubbles,e),this.chatBubbles=this.chatBubbles.filter(t=>t!==e)}clearChatBubbles(){for(const e of this.chatBubbles)ye(this.state.chatBubbles,e);this.chatBubbles=[]}updateUsernameLabelAndChatBubbles(e){var r,s;const t=this.state.camera.getPosition();(r=this.usernameLabel)==null||r.setVisibility(e),(s=this.usernameLabel)==null||s.setPosition(this.x-t.camX+this.width/2-this.usernameLabel.el.clientWidth/2,this.y-t.camY+this.height+1);let i=0;for(const o of this.chatBubbles)o.tick(),o.setVisibility(e),o.setPosition(this.x-t.camX+this.width/2-o.el.clientWidth/2,this.y-t.camY-o.el.clientHeight-5-i),i+=o.el.clientHeight+7}tick(){this.initialized&&(this.tickStaffAuraFrame(),this.tickDeath(),this.tickPhysics(),this.sendUpdateCountersPacket())}tickDeath(){if(this.isDead)if(this.isFlying)this.isDead=!1;else{this.deathFrame+=.3,this.isMe&&this.deathFrame>16&&!this.isRespawning&&(G.pwio.send(new ke(V.PlayerRespawn)),this.isRespawning=!0);return}}tickPhysics(){if(this.isDead)return;const e=fe.gravity,t=fe.drag.base,i=fe.drag.noModifier,r=fe.drag.ladder,s=fe.drag.water;let o=this.queue.shift();const l=this.x+8>>4,h=this.y+8>>4,f=this.state.world.getBlockData(l,h,Q.Foreground),g=f.id,a=A.getById(g);this.queue.push(g),(g==w.GravityDot||a.isLadder)&&(o=this.queue.shift(),this.queue.push(g));const c=o?A.getById(o):void 0;if(this.morX=0,this.morY=0,this.moX=0,this.moY=0,!this.isFlying){if(a.isLadder||a.isBoost)this.morX=0,this.morY=0;else switch(g){case w.GravityLeft:this.morX=-e,this.morY=0;break;case w.GravityUp:this.morX=0,this.morY=-e;break;case w.GravityRight:this.morX=e,this.morY=0;break;case w.GravityDown:this.morX=0,this.morY=e;break;case w.GravityDot:this.morX=0,this.morY=0;break;case w.Water:this.morX=0,this.morY=-1;break;default:this.morX=0,this.morY=e;break}if(c!=null&&c.isLadder||c!=null&&c.isBoost)this.moX=0,this.moY=0;else switch(o){case w.GravityLeft:this.moX=-e,this.moY=0;break;case w.GravityUp:this.moX=0,this.moY=-e;break;case w.GravityRight:this.moX=e,this.moY=0;break;case w.GravityDown:this.moX=0,this.moY=e;break;case w.GravityDot:this.moX=0,this.moY=0;break;case w.Water:this.moX=0,this.moY=fe.buoyancy.water;break;default:this.moX=0,this.moY=e;break}}c!=null&&c.isLiquid?(this.mx=this.horizontal,this.my=this.vertical):this.moY!=0?(this.mx=this.horizontal,this.my=0):this.moX!=0?(this.mx=0,this.my=this.vertical):(this.mx=this.horizontal,this.my=this.vertical),this.modifierX=this.moX+this.mx,this.modifierY=this.moY+this.my,(this._speedX||this._modifierX)&&(this._speedX+=this._modifierX,this.isFlying?this._speedX*=t:this.mx==0&&this.moY!=0||this._speedX<0&&this.mx>0||this._speedX>0&&this.mx<0?(this._speedX*=t,this._speedX*=i):a.isLadder?(this._speedX*=t,this._speedX*=r):g==w.Water?(this._speedX*=t,this._speedX*=s):this._speedX*=t,this._speedX=Je.clamp(this._speedX,-16,16),this._speedX=Je.clampToZeroInRange(this._speedX,1e-4)),(this._speedY||this._modifierY)&&(this._speedY+=this._modifierY,this.isFlying?this._speedY*=t:this.my==0&&this.moX!=0||this._speedY<0&&this.my>0||this._speedY>0&&this.my<0?(this._speedY*=t,this._speedY*=i):a.isLadder?(this._speedY*=t,this._speedY*=r):g==w.Water?(this._speedY*=t,this._speedY*=s):this._speedY*=t,this._speedY=Je.clamp(this._speedY,-16,16),this._speedY=Je.clampToZeroInRange(this._speedY,1e-4)),!this.isFlying&&a.isBoost&&(a.boostX!=0&&(this._speedX=fe.boostSpeed*a.boostX),a.boostY!=0&&(this._speedY=fe.boostSpeed*a.boostY)),this.reminderX=this.x%1,this.currentSpeedX=this._speedX,this.reminderY=this.y%1,this.currentSpeedY=this._speedY;let p=!1,_=!1;for(this.justTeleported=!1;this.currentSpeedX!=0&&!p||this.currentSpeedY!=0&&!_;){this.isMe&&this.processPortals(f,l,h),this.ox=this.x,this.oy=this.y;let F=this.currentSpeedX,M=this.currentSpeedY;this.currentSpeedX>0?this.currentSpeedX+this.reminderX>=1?(this.x+=1-this.reminderX,this.x>>=0,this.currentSpeedX-=1-this.reminderX,this.reminderX=0):(this.x+=this.currentSpeedX,this.currentSpeedX=0):this.currentSpeedX<0&&(this.reminderX+this.currentSpeedX<0&&(this.reminderX!=0||a.isBoost)?(this.currentSpeedX+=this.reminderX,this.x-=this.reminderX,this.x>>=0,this.reminderX=1):(this.x+=this.currentSpeedX,this.currentSpeedX=0)),this.state.world.collidesWith(this)&&(this.x=this.ox,this._speedX>0&&this.morX>0,this._speedX<0&&this.morX<0,this._speedX=0,this.currentSpeedX=F,p=!0),this.currentSpeedY>0?this.currentSpeedY+this.reminderY>=1?(this.y+=1-this.reminderY,this.y>>=0,this.currentSpeedY-=1-this.reminderY,this.reminderY=0):(this.y+=this.currentSpeedY,this.currentSpeedY=0):this.currentSpeedY<0&&(this.reminderY+this.currentSpeedY<0&&(this.reminderY!=0||a.isBoost)?(this.y-=this.reminderY,this.y>>=0,this.currentSpeedY+=this.reminderY,this.reminderY=1):(this.y+=this.currentSpeedY,this.currentSpeedY=0)),this.state.world.collidesWith(this)&&(this.y=this.oy,this._speedY>0&&this.morY>0,this._speedY<0&&this.morY<0,this._speedY=0,this.currentSpeedY=M,_=!0)}let y=!1,S=1;const x=Date.now(),v=a.isLiquid&&!this.isFlying;this.spaceJustDown&&!v&&(this.lastJump=-x,y=!0,S=-1),this.spaceDown&&!v&&(this.lastJump<0?x+this.lastJump>750&&(y=!0):x-this.lastJump>150&&(y=!0)),y&&(this.speedX==0&&this.morX&&this.moX&&this.x%16==0&&(this.speedX-=this.morX*fe.jumpHeight,this.lastJump=x*S),this.speedY==0&&this.morY&&this.moY&&this.y%16==0&&(this.speedY-=this.morY*fe.jumpHeight,this.lastJump=x*S));let P=this._speedX<<8,E=this._speedY<<8;!(P!==0||E!==0)&&!v&&(this.x=this.snapToGrid(this.x,this._modifierX),this.y=this.snapToGrid(this.y,this._modifierY)),this.delayBlocks(),this.touchBlock(l,h,a),this.sendMovementPacket(),this.tickId++}delayBlocks(){this.counters.delayAll(),this.delaySwitches(this.switches,this.delayedLocalSwitches),this.delaySwitches(this.state.switches,this.delayedGlobalSwitches)}delaySwitches(e,t){for(let i=0;i<1e3;i++)if(e[i]!==t[i]){const r=t[i];t[i]=e[i],this.state.world.collidesWith(this)&&(t[i]=r)}}snapToGrid(e,t){if(t<.1&&t>-.1){let i=e%16;i<2?i<.2?e>>=0:e-=i/15:i>14&&(i>15.8?(e>>=0,e++):e+=(i-14)/15)}return e}processPortals(e,t,i){if(this.isFlying||!(e instanceof Ye)||e.portalId==e.portalTargetId){this.lastPortalPos=null;return}if(this.lastPortalPos!==null)return;this.lastPortalPos=new Ri(t,i);const r=this.state.world.getPortalTargets(e.portalTargetId);if(r.length<=0)return;const s=r[Math.floor(Math.random()*r.length)],o=this.state.world.getBlockData(this.lastPortalPos.x,this.lastPortalPos.y,Q.Foreground).rotation,l=s.portal.rotation,h=Je.mod(o-l,4),f=this.speedX,g=this.speedY,a=this.modifierX,c=this.modifierY,p=1.42;switch(h){case 1:this.speedX=g*p,this.speedY=-f*p,this.modifierX=c*p,this.modifierY=-a*p,this.reminderY=-this.reminderX,this.currentSpeedY=-this.currentSpeedX;break;case 2:this.speedX=-f*p,this.speedY=-g*p,this.modifierX=-a*p,this.modifierY=-c*p,this.reminderY=-this.reminderY,this.currentSpeedY=-this.currentSpeedY,this.reminderX=-this.reminderX,this.currentSpeedX=-this.currentSpeedX;break;case 3:this.speedX=-g*p,this.speedY=f*p,this.modifierX=-c*p,this.modifierY=a*p,this.reminderX=-this.reminderY,this.currentSpeedX=-this.currentSpeedY;break}if(this.state.camera.targetPlayer===this){const _=this.x-s.pos.x*it.TileSize,y=this.y-s.pos.y*it.TileSize;this.state.camera.addPosition(-_,-y)}this.x=s.pos.x*it.TileSize,this.y=s.pos.y*it.TileSize,this.lastPortalPos=s.pos,this.justTeleported=!0}tickStaffAuraFrame(){this.isInModMode?(this.staffAuraFrame+=.2,this.staffAuraFrame>11&&(this.staffAuraFrame=6)):this.staffAuraFrame=0}sendMovementPacket(){if(this.isMe&&(this.lastHorizontal!=this.horizontal||this.lastVertical!=this.vertical||this.lastSpaceDown!=this.spaceDown||this.lastSpaceJustDown!=this.spaceJustDown||this.justTeleported)){const e=new ke(V.PlayerMoved);e.add(this.x,z.Double),e.add(this.y,z.Double),e.add(this.speedX,z.Double),e.add(this.speedY,z.Double),e.add(this.modifierX,z.Double),e.add(this.modifierY,z.Double),e.add(this.horizontal,z.Int32),e.add(this.vertical,z.Int32),e.add(this.spaceDown),e.add(this.spaceJustDown),e.add(this.tickId,z.Int32),G.pwio.send(e),this.lastHorizontal=this.horizontal,this.lastVertical=this.vertical,this.lastSpaceDown=this.spaceDown,this.lastSpaceJustDown=this.spaceJustDown,this.spaceJustDown=!1}}sendUpdateCountersPacket(){if(!this.isMe||!this.counters.hasChanged)return;const e=new ke(V.PlayerCounters);e.add(this.counters.goldCoins,z.Int32),e.add(this.counters.blueCoins,z.Int32),e.add(this.counters.deaths,z.Int32),G.pwio.send(e),this.counters.hasChanged=!1}kill(){this.isFlying||this.isDead||(this.counters.deaths++,this.state.ui.counters.updateDeathCount(),this.counters.hasChanged=!0,this.state.worldRenderer.updateAllChunks([N.Foreground,N.Numbers]),this.isDead=!0,this.deathFrame=0,this.modifierX=0,this.modifierY=0,this.speedX=0,this.speedY=0,this.state.particleRenderer.addParticle(...vs.createDeathExplosion(this)))}respawn(e,t){this.isRespawning=!1,this.isDead=!1,this.x=e,this.y=t,this.modifierX=0,this.modifierY=0,this.speedX=0,this.speedY=0,this.isMe&&this.state.camera.jumpToTargetPlayer()}touchBlock(e,t,i){var r,s;this.touchBlockAlways(e,t,i),(((r=this.pastPos)==null?void 0:r.x)!=e||((s=this.pastPos)==null?void 0:s.y)!=t)&&this.touchBlockOnMove(e,t,i),this.pastPos=new Ri(e,t)}touchBlockAlways(e,t,i){if(i.isHazard){this.kill();return}if(this.isMe)switch(i.id){case w.Coin:case w.BlueCoin:this.state.world.foregroundBlocks[e][t].extra.collected||(this.state.world.foregroundBlocks[e][t].extra.collected=!0,Z.coinSound.play(),i.id==w.Coin?(this.counters.goldCoins++,this.counters.hasChanged=!0,this.state.ui.counters.updateCoinCount()):(this.counters.blueCoins++,this.counters.hasChanged=!0,this.state.ui.counters.updateBlueCoinCount()),this.state.worldRenderer.updateChunkAtBlockPos(e,t,[N.Foreground,N.AbovePlayers]),this.state.worldRenderer.updateAllChunks([N.Foreground,N.Numbers]));break}}touchBlockOnMove(e,t,i){if(this.isMe)switch(this.state.lastMovement=Date.now(),i.id){case w.Crown:{if(this.isFlying)return;const r=new ke(V.PlayerCrown);r.add(e,z.Int32),r.add(t,z.Int32),G.pwio.send(r)}break;case w.Checkpoint:{if(this.isFlying)return;const r=new ke(V.PlayerCheckpoint);r.add(e,z.Int32),r.add(t,z.Int32),G.pwio.send(r)}break;case w.KeyRed:this.state.keys.sendKey(0);break;case w.KeyGreen:this.state.keys.sendKey(1);break;case w.KeyBlue:this.state.keys.sendKey(2);break;case w.LocalSwitch:{if(this.isFlying)return;const r=this.state.world.getBlockData(e,t,Q.Foreground),s=this.switches[r.switchId]==0?1:0;this.switches[r.switchId]=s,this.state.worldRenderer.updateAllChunks([N.Foreground]),this.sendSwitchMessage(r.switchId,s)}break;case w.LocalSwitchActivator:{if(this.isFlying)return;const r=this.state.world.getBlockData(e,t,Q.Foreground);this.switches[r.switchId]=r.switchState,this.state.worldRenderer.updateAllChunks([N.Foreground]),this.sendSwitchMessage(r.switchId,r.switchState)}break;case w.LocalSwitchResetter:{if(this.isFlying)return;const r=this.state.world.getBlockData(e,t,Q.Foreground);this.switches.fill(r.switchState),this.state.worldRenderer.updateAllChunks([N.Foreground]),this.sendSwitchResetMessage(r.switchState)}break;case w.GlobalSwitch:{if(this.isFlying)return;const r=this.state.world.getBlockData(e,t,Q.Foreground),s=this.state.switches[r.switchId]==0?1:0;this.state.sendSwitchMessage(r.switchId,s)}break;case w.GlobalSwitchActivator:{if(this.isFlying)return;const r=this.state.world.getBlockData(e,t,Q.Foreground);this.state.sendSwitchMessage(r.switchId,r.switchState)}break;case w.GlobalSwitchResetter:{if(this.isFlying)return;const r=this.state.world.getBlockData(e,t,Q.Foreground);this.state.sendSwitchResetMessage(r.switchState)}break}}sendSwitchMessage(e,t){const i=new ke(V.PlayerLocalSwitchChanged);i.add(e,z.Int32),i.add(t,z.Byte),G.pwio.send(i)}sendSwitchResetMessage(e){const t=new ke(V.PlayerLocalSwitchReset);t.add(e,z.Byte),G.pwio.send(t)}reset(e,t){this.counters=new tn(this),this.state.ui.counters.initialize(),this.x=e*it.TileSize,this.y=t*it.TileSize,this.speedX=0,this.speedY=0,this.modifierX=0,this.modifierY=0,this.hasWinnerCrown=!1,this.state.crownPlayer==this&&(this.state.crownPlayer=void 0),this.switches.fill(0),this.delayedLocalSwitches.fill(0),this.isMe&&(this.state.checkPoint=void 0,this.state.camera.jumpToTargetPlayer())}get speedX(){return this._speedX*fe.variableMultiplier}set speedX(e){this._speedX=e/fe.variableMultiplier}get speedY(){return this._speedY*fe.variableMultiplier}set speedY(e){this._speedY=e/fe.variableMultiplier}get modifierX(){return this._modifierX*fe.variableMultiplier}set modifierX(e){this._modifierX=e/fe.variableMultiplier}get modifierY(){return this._modifierY*fe.variableMultiplier}set modifierY(e){this._modifierY=e/fe.variableMultiplier}}var Xt={},yr={};yr.byteLength=ic;yr.toByteArray=sc;yr.fromByteArray=ac;var ct=[],$e=[],ec=typeof Uint8Array<"u"?Uint8Array:Array,Rr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ti=0,tc=Rr.length;ti<tc;++ti)ct[ti]=Rr[ti],$e[Rr.charCodeAt(ti)]=ti;$e[45]=62;$e[95]=63;function ko(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function ic(n){var e=ko(n),t=e[0],i=e[1];return(t+i)*3/4-i}function rc(n,e,t){return(e+t)*3/4-t}function sc(n){var e,t=ko(n),i=t[0],r=t[1],s=new ec(rc(n,i,r)),o=0,l=r>0?i-4:i,h;for(h=0;h<l;h+=4)e=$e[n.charCodeAt(h)]<<18|$e[n.charCodeAt(h+1)]<<12|$e[n.charCodeAt(h+2)]<<6|$e[n.charCodeAt(h+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return r===2&&(e=$e[n.charCodeAt(h)]<<2|$e[n.charCodeAt(h+1)]>>4,s[o++]=e&255),r===1&&(e=$e[n.charCodeAt(h)]<<10|$e[n.charCodeAt(h+1)]<<4|$e[n.charCodeAt(h+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function nc(n){return ct[n>>18&63]+ct[n>>12&63]+ct[n>>6&63]+ct[n&63]}function oc(n,e,t){for(var i,r=[],s=e;s<t;s+=3)i=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),r.push(nc(i));return r.join("")}function ac(n){for(var e,t=n.length,i=t%3,r=[],s=16383,o=0,l=t-i;o<l;o+=s)r.push(oc(n,o,o+s>l?l:o+s));return i===1?(e=n[t-1],r.push(ct[e>>2]+ct[e<<4&63]+"==")):i===2&&(e=(n[t-2]<<8)+n[t-1],r.push(ct[e>>10]+ct[e>>4&63]+ct[e<<2&63]+"=")),r.join("")}var Bs={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Bs.read=function(n,e,t,i,r){var s,o,l=r*8-i-1,h=(1<<l)-1,f=h>>1,g=-7,a=t?r-1:0,c=t?-1:1,p=n[e+a];for(a+=c,s=p&(1<<-g)-1,p>>=-g,g+=l;g>0;s=s*256+n[e+a],a+=c,g-=8);for(o=s&(1<<-g)-1,s>>=-g,g+=i;g>0;o=o*256+n[e+a],a+=c,g-=8);if(s===0)s=1-f;else{if(s===h)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-f}return(p?-1:1)*o*Math.pow(2,s-i)};Bs.write=function(n,e,t,i,r,s){var o,l,h,f=s*8-r-1,g=(1<<f)-1,a=g>>1,c=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,_=i?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=g):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),o+a>=1?e+=c/h:e+=c*Math.pow(2,1-a),e*h>=2&&(o++,h/=2),o+a>=g?(l=0,o=g):o+a>=1?(l=(e*h-1)*Math.pow(2,r),o=o+a):(l=e*Math.pow(2,a-1)*Math.pow(2,r),o=0));r>=8;n[t+p]=l&255,p+=_,l/=256,r-=8);for(o=o<<r|l,f+=r;f>0;n[t+p]=o&255,p+=_,o/=256,f-=8);n[t+p-_]|=y*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=yr,t=Bs,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=l,n.SlowBuffer=v,n.INSPECT_MAX_BYTES=50;const r=2147483647;n.kMaxLength=r,l.TYPED_ARRAY_SUPPORT=s(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const b=new Uint8Array(1),u={foo:function(){return 42}};return Object.setPrototypeOf(u,Uint8Array.prototype),Object.setPrototypeOf(b,u),b.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function o(b){if(b>r)throw new RangeError('The value "'+b+'" is invalid for option "size"');const u=new Uint8Array(b);return Object.setPrototypeOf(u,l.prototype),u}function l(b,u,d){if(typeof b=="number"){if(typeof u=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return a(b)}return h(b,u,d)}l.poolSize=8192;function h(b,u,d){if(typeof b=="string")return c(b,u);if(ArrayBuffer.isView(b))return _(b);if(b==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b);if(st(b,ArrayBuffer)||b&&st(b.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(st(b,SharedArrayBuffer)||b&&st(b.buffer,SharedArrayBuffer)))return y(b,u,d);if(typeof b=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const k=b.valueOf&&b.valueOf();if(k!=null&&k!==b)return l.from(k,u,d);const B=S(b);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof b[Symbol.toPrimitive]=="function")return l.from(b[Symbol.toPrimitive]("string"),u,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b)}l.from=function(b,u,d){return h(b,u,d)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function f(b){if(typeof b!="number")throw new TypeError('"size" argument must be of type number');if(b<0)throw new RangeError('The value "'+b+'" is invalid for option "size"')}function g(b,u,d){return f(b),b<=0?o(b):u!==void 0?typeof d=="string"?o(b).fill(u,d):o(b).fill(u):o(b)}l.alloc=function(b,u,d){return g(b,u,d)};function a(b){return f(b),o(b<0?0:x(b)|0)}l.allocUnsafe=function(b){return a(b)},l.allocUnsafeSlow=function(b){return a(b)};function c(b,u){if((typeof u!="string"||u==="")&&(u="utf8"),!l.isEncoding(u))throw new TypeError("Unknown encoding: "+u);const d=P(b,u)|0;let k=o(d);const B=k.write(b,u);return B!==d&&(k=k.slice(0,B)),k}function p(b){const u=b.length<0?0:x(b.length)|0,d=o(u);for(let k=0;k<u;k+=1)d[k]=b[k]&255;return d}function _(b){if(st(b,Uint8Array)){const u=new Uint8Array(b);return y(u.buffer,u.byteOffset,u.byteLength)}return p(b)}function y(b,u,d){if(u<0||b.byteLength<u)throw new RangeError('"offset" is outside of buffer bounds');if(b.byteLength<u+(d||0))throw new RangeError('"length" is outside of buffer bounds');let k;return u===void 0&&d===void 0?k=new Uint8Array(b):d===void 0?k=new Uint8Array(b,u):k=new Uint8Array(b,u,d),Object.setPrototypeOf(k,l.prototype),k}function S(b){if(l.isBuffer(b)){const u=x(b.length)|0,d=o(u);return d.length===0||b.copy(d,0,0,u),d}if(b.length!==void 0)return typeof b.length!="number"||kr(b.length)?o(0):p(b);if(b.type==="Buffer"&&Array.isArray(b.data))return p(b.data)}function x(b){if(b>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return b|0}function v(b){return+b!=b&&(b=0),l.alloc(+b)}l.isBuffer=function(u){return u!=null&&u._isBuffer===!0&&u!==l.prototype},l.compare=function(u,d){if(st(u,Uint8Array)&&(u=l.from(u,u.offset,u.byteLength)),st(d,Uint8Array)&&(d=l.from(d,d.offset,d.byteLength)),!l.isBuffer(u)||!l.isBuffer(d))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(u===d)return 0;let k=u.length,B=d.length;for(let D=0,R=Math.min(k,B);D<R;++D)if(u[D]!==d[D]){k=u[D],B=d[D];break}return k<B?-1:B<k?1:0},l.isEncoding=function(u){switch(String(u).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(u,d){if(!Array.isArray(u))throw new TypeError('"list" argument must be an Array of Buffers');if(u.length===0)return l.alloc(0);let k;if(d===void 0)for(d=0,k=0;k<u.length;++k)d+=u[k].length;const B=l.allocUnsafe(d);let D=0;for(k=0;k<u.length;++k){let R=u[k];if(st(R,Uint8Array))D+R.length>B.length?(l.isBuffer(R)||(R=l.from(R)),R.copy(B,D)):Uint8Array.prototype.set.call(B,R,D);else if(l.isBuffer(R))R.copy(B,D);else throw new TypeError('"list" argument must be an Array of Buffers');D+=R.length}return B};function P(b,u){if(l.isBuffer(b))return b.length;if(ArrayBuffer.isView(b)||st(b,ArrayBuffer))return b.byteLength;if(typeof b!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof b);const d=b.length,k=arguments.length>2&&arguments[2]===!0;if(!k&&d===0)return 0;let B=!1;for(;;)switch(u){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return xr(b).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d*2;case"hex":return d>>>1;case"base64":return Is(b).length;default:if(B)return k?-1:xr(b).length;u=(""+u).toLowerCase(),B=!0}}l.byteLength=P;function E(b,u,d){let k=!1;if((u===void 0||u<0)&&(u=0),u>this.length||((d===void 0||d>this.length)&&(d=this.length),d<=0)||(d>>>=0,u>>>=0,d<=u))return"";for(b||(b="utf8");;)switch(b){case"hex":return Jt(this,u,d);case"utf8":case"utf-8":return J(this,u,d);case"ascii":return ge(this,u,d);case"latin1":case"binary":return Fe(this,u,d);case"base64":return K(this,u,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lt(this,u,d);default:if(k)throw new TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase(),k=!0}}l.prototype._isBuffer=!0;function I(b,u,d){const k=b[u];b[u]=b[d],b[d]=k}l.prototype.swap16=function(){const u=this.length;if(u%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let d=0;d<u;d+=2)I(this,d,d+1);return this},l.prototype.swap32=function(){const u=this.length;if(u%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let d=0;d<u;d+=4)I(this,d,d+3),I(this,d+1,d+2);return this},l.prototype.swap64=function(){const u=this.length;if(u%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let d=0;d<u;d+=8)I(this,d,d+7),I(this,d+1,d+6),I(this,d+2,d+5),I(this,d+3,d+4);return this},l.prototype.toString=function(){const u=this.length;return u===0?"":arguments.length===0?J(this,0,u):E.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(u){if(!l.isBuffer(u))throw new TypeError("Argument must be a Buffer");return this===u?!0:l.compare(this,u)===0},l.prototype.inspect=function(){let u="";const d=n.INSPECT_MAX_BYTES;return u=this.toString("hex",0,d).replace(/(.{2})/g,"$1 ").trim(),this.length>d&&(u+=" ... "),"<Buffer "+u+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(u,d,k,B,D){if(st(u,Uint8Array)&&(u=l.from(u,u.offset,u.byteLength)),!l.isBuffer(u))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof u);if(d===void 0&&(d=0),k===void 0&&(k=u?u.length:0),B===void 0&&(B=0),D===void 0&&(D=this.length),d<0||k>u.length||B<0||D>this.length)throw new RangeError("out of range index");if(B>=D&&d>=k)return 0;if(B>=D)return-1;if(d>=k)return 1;if(d>>>=0,k>>>=0,B>>>=0,D>>>=0,this===u)return 0;let R=D-B,j=k-d;const he=Math.min(R,j),ne=this.slice(B,D),de=u.slice(d,k);for(let te=0;te<he;++te)if(ne[te]!==de[te]){R=ne[te],j=de[te];break}return R<j?-1:j<R?1:0};function F(b,u,d,k,B){if(b.length===0)return-1;if(typeof d=="string"?(k=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),d=+d,kr(d)&&(d=B?0:b.length-1),d<0&&(d=b.length+d),d>=b.length){if(B)return-1;d=b.length-1}else if(d<0)if(B)d=0;else return-1;if(typeof u=="string"&&(u=l.from(u,k)),l.isBuffer(u))return u.length===0?-1:M(b,u,d,k,B);if(typeof u=="number")return u=u&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(b,u,d):Uint8Array.prototype.lastIndexOf.call(b,u,d):M(b,[u],d,k,B);throw new TypeError("val must be string, number or Buffer")}function M(b,u,d,k,B){let D=1,R=b.length,j=u.length;if(k!==void 0&&(k=String(k).toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(b.length<2||u.length<2)return-1;D=2,R/=2,j/=2,d/=2}function he(de,te){return D===1?de[te]:de.readUInt16BE(te*D)}let ne;if(B){let de=-1;for(ne=d;ne<R;ne++)if(he(b,ne)===he(u,de===-1?0:ne-de)){if(de===-1&&(de=ne),ne-de+1===j)return de*D}else de!==-1&&(ne-=ne-de),de=-1}else for(d+j>R&&(d=R-j),ne=d;ne>=0;ne--){let de=!0;for(let te=0;te<j;te++)if(he(b,ne+te)!==he(u,te)){de=!1;break}if(de)return ne}return-1}l.prototype.includes=function(u,d,k){return this.indexOf(u,d,k)!==-1},l.prototype.indexOf=function(u,d,k){return F(this,u,d,k,!0)},l.prototype.lastIndexOf=function(u,d,k){return F(this,u,d,k,!1)};function O(b,u,d,k){d=Number(d)||0;const B=b.length-d;k?(k=Number(k),k>B&&(k=B)):k=B;const D=u.length;k>D/2&&(k=D/2);let R;for(R=0;R<k;++R){const j=parseInt(u.substr(R*2,2),16);if(kr(j))return R;b[d+R]=j}return R}function L(b,u,d,k){return ji(xr(u,b.length-d),b,d,k)}function W(b,u,d,k){return ji(Mo(u),b,d,k)}function H(b,u,d,k){return ji(Is(u),b,d,k)}function q(b,u,d,k){return ji(zo(u,b.length-d),b,d,k)}l.prototype.write=function(u,d,k,B){if(d===void 0)B="utf8",k=this.length,d=0;else if(k===void 0&&typeof d=="string")B=d,k=this.length,d=0;else if(isFinite(d))d=d>>>0,isFinite(k)?(k=k>>>0,B===void 0&&(B="utf8")):(B=k,k=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const D=this.length-d;if((k===void 0||k>D)&&(k=D),u.length>0&&(k<0||d<0)||d>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");let R=!1;for(;;)switch(B){case"hex":return O(this,u,d,k);case"utf8":case"utf-8":return L(this,u,d,k);case"ascii":case"latin1":case"binary":return W(this,u,d,k);case"base64":return H(this,u,d,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,u,d,k);default:if(R)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),R=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(b,u,d){return u===0&&d===b.length?e.fromByteArray(b):e.fromByteArray(b.slice(u,d))}function J(b,u,d){d=Math.min(b.length,d);const k=[];let B=u;for(;B<d;){const D=b[B];let R=null,j=D>239?4:D>223?3:D>191?2:1;if(B+j<=d){let he,ne,de,te;switch(j){case 1:D<128&&(R=D);break;case 2:he=b[B+1],(he&192)===128&&(te=(D&31)<<6|he&63,te>127&&(R=te));break;case 3:he=b[B+1],ne=b[B+2],(he&192)===128&&(ne&192)===128&&(te=(D&15)<<12|(he&63)<<6|ne&63,te>2047&&(te<55296||te>57343)&&(R=te));break;case 4:he=b[B+1],ne=b[B+2],de=b[B+3],(he&192)===128&&(ne&192)===128&&(de&192)===128&&(te=(D&15)<<18|(he&63)<<12|(ne&63)<<6|de&63,te>65535&&te<1114112&&(R=te))}}R===null?(R=65533,j=1):R>65535&&(R-=65536,k.push(R>>>10&1023|55296),R=56320|R&1023),k.push(R),B+=j}return ce(k)}const X=4096;function ce(b){const u=b.length;if(u<=X)return String.fromCharCode.apply(String,b);let d="",k=0;for(;k<u;)d+=String.fromCharCode.apply(String,b.slice(k,k+=X));return d}function ge(b,u,d){let k="";d=Math.min(b.length,d);for(let B=u;B<d;++B)k+=String.fromCharCode(b[B]&127);return k}function Fe(b,u,d){let k="";d=Math.min(b.length,d);for(let B=u;B<d;++B)k+=String.fromCharCode(b[B]);return k}function Jt(b,u,d){const k=b.length;(!u||u<0)&&(u=0),(!d||d<0||d>k)&&(d=k);let B="";for(let D=u;D<d;++D)B+=Oo[b[D]];return B}function Lt(b,u,d){const k=b.slice(u,d);let B="";for(let D=0;D<k.length-1;D+=2)B+=String.fromCharCode(k[D]+k[D+1]*256);return B}l.prototype.slice=function(u,d){const k=this.length;u=~~u,d=d===void 0?k:~~d,u<0?(u+=k,u<0&&(u=0)):u>k&&(u=k),d<0?(d+=k,d<0&&(d=0)):d>k&&(d=k),d<u&&(d=u);const B=this.subarray(u,d);return Object.setPrototypeOf(B,l.prototype),B};function se(b,u,d){if(b%1!==0||b<0)throw new RangeError("offset is not uint");if(b+u>d)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(u,d,k){u=u>>>0,d=d>>>0,k||se(u,d,this.length);let B=this[u],D=1,R=0;for(;++R<d&&(D*=256);)B+=this[u+R]*D;return B},l.prototype.readUintBE=l.prototype.readUIntBE=function(u,d,k){u=u>>>0,d=d>>>0,k||se(u,d,this.length);let B=this[u+--d],D=1;for(;d>0&&(D*=256);)B+=this[u+--d]*D;return B},l.prototype.readUint8=l.prototype.readUInt8=function(u,d){return u=u>>>0,d||se(u,1,this.length),this[u]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(u,d){return u=u>>>0,d||se(u,2,this.length),this[u]|this[u+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(u,d){return u=u>>>0,d||se(u,2,this.length),this[u]<<8|this[u+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(u,d){return u=u>>>0,d||se(u,4,this.length),(this[u]|this[u+1]<<8|this[u+2]<<16)+this[u+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(u,d){return u=u>>>0,d||se(u,4,this.length),this[u]*16777216+(this[u+1]<<16|this[u+2]<<8|this[u+3])},l.prototype.readBigUInt64LE=_t(function(u){u=u>>>0,Qt(u,"offset");const d=this[u],k=this[u+7];(d===void 0||k===void 0)&&Si(u,this.length-8);const B=d+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24,D=this[++u]+this[++u]*2**8+this[++u]*2**16+k*2**24;return BigInt(B)+(BigInt(D)<<BigInt(32))}),l.prototype.readBigUInt64BE=_t(function(u){u=u>>>0,Qt(u,"offset");const d=this[u],k=this[u+7];(d===void 0||k===void 0)&&Si(u,this.length-8);const B=d*2**24+this[++u]*2**16+this[++u]*2**8+this[++u],D=this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+k;return(BigInt(B)<<BigInt(32))+BigInt(D)}),l.prototype.readIntLE=function(u,d,k){u=u>>>0,d=d>>>0,k||se(u,d,this.length);let B=this[u],D=1,R=0;for(;++R<d&&(D*=256);)B+=this[u+R]*D;return D*=128,B>=D&&(B-=Math.pow(2,8*d)),B},l.prototype.readIntBE=function(u,d,k){u=u>>>0,d=d>>>0,k||se(u,d,this.length);let B=d,D=1,R=this[u+--B];for(;B>0&&(D*=256);)R+=this[u+--B]*D;return D*=128,R>=D&&(R-=Math.pow(2,8*d)),R},l.prototype.readInt8=function(u,d){return u=u>>>0,d||se(u,1,this.length),this[u]&128?(255-this[u]+1)*-1:this[u]},l.prototype.readInt16LE=function(u,d){u=u>>>0,d||se(u,2,this.length);const k=this[u]|this[u+1]<<8;return k&32768?k|4294901760:k},l.prototype.readInt16BE=function(u,d){u=u>>>0,d||se(u,2,this.length);const k=this[u+1]|this[u]<<8;return k&32768?k|4294901760:k},l.prototype.readInt32LE=function(u,d){return u=u>>>0,d||se(u,4,this.length),this[u]|this[u+1]<<8|this[u+2]<<16|this[u+3]<<24},l.prototype.readInt32BE=function(u,d){return u=u>>>0,d||se(u,4,this.length),this[u]<<24|this[u+1]<<16|this[u+2]<<8|this[u+3]},l.prototype.readBigInt64LE=_t(function(u){u=u>>>0,Qt(u,"offset");const d=this[u],k=this[u+7];(d===void 0||k===void 0)&&Si(u,this.length-8);const B=this[u+4]+this[u+5]*2**8+this[u+6]*2**16+(k<<24);return(BigInt(B)<<BigInt(32))+BigInt(d+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24)}),l.prototype.readBigInt64BE=_t(function(u){u=u>>>0,Qt(u,"offset");const d=this[u],k=this[u+7];(d===void 0||k===void 0)&&Si(u,this.length-8);const B=(d<<24)+this[++u]*2**16+this[++u]*2**8+this[++u];return(BigInt(B)<<BigInt(32))+BigInt(this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+k)}),l.prototype.readFloatLE=function(u,d){return u=u>>>0,d||se(u,4,this.length),t.read(this,u,!0,23,4)},l.prototype.readFloatBE=function(u,d){return u=u>>>0,d||se(u,4,this.length),t.read(this,u,!1,23,4)},l.prototype.readDoubleLE=function(u,d){return u=u>>>0,d||se(u,8,this.length),t.read(this,u,!0,52,8)},l.prototype.readDoubleBE=function(u,d){return u=u>>>0,d||se(u,8,this.length),t.read(this,u,!1,52,8)};function ue(b,u,d,k,B,D){if(!l.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>B||u<D)throw new RangeError('"value" argument is out of bounds');if(d+k>b.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(u,d,k,B){if(u=+u,d=d>>>0,k=k>>>0,!B){const j=Math.pow(2,8*k)-1;ue(this,u,d,k,j,0)}let D=1,R=0;for(this[d]=u&255;++R<k&&(D*=256);)this[d+R]=u/D&255;return d+k},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(u,d,k,B){if(u=+u,d=d>>>0,k=k>>>0,!B){const j=Math.pow(2,8*k)-1;ue(this,u,d,k,j,0)}let D=k-1,R=1;for(this[d+D]=u&255;--D>=0&&(R*=256);)this[d+D]=u/R&255;return d+k},l.prototype.writeUint8=l.prototype.writeUInt8=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,1,255,0),this[d]=u&255,d+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,2,65535,0),this[d]=u&255,this[d+1]=u>>>8,d+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,2,65535,0),this[d]=u>>>8,this[d+1]=u&255,d+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,4,4294967295,0),this[d+3]=u>>>24,this[d+2]=u>>>16,this[d+1]=u>>>8,this[d]=u&255,d+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,4,4294967295,0),this[d]=u>>>24,this[d+1]=u>>>16,this[d+2]=u>>>8,this[d+3]=u&255,d+4};function bi(b,u,d,k,B){Ds(u,k,B,b,d,7);let D=Number(u&BigInt(4294967295));b[d++]=D,D=D>>8,b[d++]=D,D=D>>8,b[d++]=D,D=D>>8,b[d++]=D;let R=Number(u>>BigInt(32)&BigInt(4294967295));return b[d++]=R,R=R>>8,b[d++]=R,R=R>>8,b[d++]=R,R=R>>8,b[d++]=R,d}function qe(b,u,d,k,B){Ds(u,k,B,b,d,7);let D=Number(u&BigInt(4294967295));b[d+7]=D,D=D>>8,b[d+6]=D,D=D>>8,b[d+5]=D,D=D>>8,b[d+4]=D;let R=Number(u>>BigInt(32)&BigInt(4294967295));return b[d+3]=R,R=R>>8,b[d+2]=R,R=R>>8,b[d+1]=R,R=R>>8,b[d]=R,d+8}l.prototype.writeBigUInt64LE=_t(function(u,d=0){return bi(this,u,d,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=_t(function(u,d=0){return qe(this,u,d,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(u,d,k,B){if(u=+u,d=d>>>0,!B){const he=Math.pow(2,8*k-1);ue(this,u,d,k,he-1,-he)}let D=0,R=1,j=0;for(this[d]=u&255;++D<k&&(R*=256);)u<0&&j===0&&this[d+D-1]!==0&&(j=1),this[d+D]=(u/R>>0)-j&255;return d+k},l.prototype.writeIntBE=function(u,d,k,B){if(u=+u,d=d>>>0,!B){const he=Math.pow(2,8*k-1);ue(this,u,d,k,he-1,-he)}let D=k-1,R=1,j=0;for(this[d+D]=u&255;--D>=0&&(R*=256);)u<0&&j===0&&this[d+D+1]!==0&&(j=1),this[d+D]=(u/R>>0)-j&255;return d+k},l.prototype.writeInt8=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,1,127,-128),u<0&&(u=255+u+1),this[d]=u&255,d+1},l.prototype.writeInt16LE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,2,32767,-32768),this[d]=u&255,this[d+1]=u>>>8,d+2},l.prototype.writeInt16BE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,2,32767,-32768),this[d]=u>>>8,this[d+1]=u&255,d+2},l.prototype.writeInt32LE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,4,2147483647,-2147483648),this[d]=u&255,this[d+1]=u>>>8,this[d+2]=u>>>16,this[d+3]=u>>>24,d+4},l.prototype.writeInt32BE=function(u,d,k){return u=+u,d=d>>>0,k||ue(this,u,d,4,2147483647,-2147483648),u<0&&(u=4294967295+u+1),this[d]=u>>>24,this[d+1]=u>>>16,this[d+2]=u>>>8,this[d+3]=u&255,d+4},l.prototype.writeBigInt64LE=_t(function(u,d=0){return bi(this,u,d,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=_t(function(u,d=0){return qe(this,u,d,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function rt(b,u,d,k,B,D){if(d+k>b.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("Index out of range")}function Ps(b,u,d,k,B){return u=+u,d=d>>>0,B||rt(b,u,d,4),t.write(b,u,d,k,23,4),d+4}l.prototype.writeFloatLE=function(u,d,k){return Ps(this,u,d,!0,k)},l.prototype.writeFloatBE=function(u,d,k){return Ps(this,u,d,!1,k)};function Ts(b,u,d,k,B){return u=+u,d=d>>>0,B||rt(b,u,d,8),t.write(b,u,d,k,52,8),d+8}l.prototype.writeDoubleLE=function(u,d,k){return Ts(this,u,d,!0,k)},l.prototype.writeDoubleBE=function(u,d,k){return Ts(this,u,d,!1,k)},l.prototype.copy=function(u,d,k,B){if(!l.isBuffer(u))throw new TypeError("argument should be a Buffer");if(k||(k=0),!B&&B!==0&&(B=this.length),d>=u.length&&(d=u.length),d||(d=0),B>0&&B<k&&(B=k),B===k||u.length===0||this.length===0)return 0;if(d<0)throw new RangeError("targetStart out of bounds");if(k<0||k>=this.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),u.length-d<B-k&&(B=u.length-d+k);const D=B-k;return this===u&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(d,k,B):Uint8Array.prototype.set.call(u,this.subarray(k,B),d),D},l.prototype.fill=function(u,d,k,B){if(typeof u=="string"){if(typeof d=="string"?(B=d,d=0,k=this.length):typeof k=="string"&&(B=k,k=this.length),B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!l.isEncoding(B))throw new TypeError("Unknown encoding: "+B);if(u.length===1){const R=u.charCodeAt(0);(B==="utf8"&&R<128||B==="latin1")&&(u=R)}}else typeof u=="number"?u=u&255:typeof u=="boolean"&&(u=Number(u));if(d<0||this.length<d||this.length<k)throw new RangeError("Out of range index");if(k<=d)return this;d=d>>>0,k=k===void 0?this.length:k>>>0,u||(u=0);let D;if(typeof u=="number")for(D=d;D<k;++D)this[D]=u;else{const R=l.isBuffer(u)?u:l.from(u,B),j=R.length;if(j===0)throw new TypeError('The value "'+u+'" is invalid for argument "value"');for(D=0;D<k-d;++D)this[D+d]=R[D%j]}return this};const Zt={};function Sr(b,u,d){Zt[b]=class extends d{constructor(){super(),Object.defineProperty(this,"message",{value:u.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${b}]`,this.stack,delete this.name}get code(){return b}set code(B){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:B,writable:!0})}toString(){return`${this.name} [${b}]: ${this.message}`}}}Sr("ERR_BUFFER_OUT_OF_BOUNDS",function(b){return b?`${b} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Sr("ERR_INVALID_ARG_TYPE",function(b,u){return`The "${b}" argument must be of type number. Received type ${typeof u}`},TypeError),Sr("ERR_OUT_OF_RANGE",function(b,u,d){let k=`The value of "${b}" is out of range.`,B=d;return Number.isInteger(d)&&Math.abs(d)>2**32?B=Es(String(d)):typeof d=="bigint"&&(B=String(d),(d>BigInt(2)**BigInt(32)||d<-(BigInt(2)**BigInt(32)))&&(B=Es(B)),B+="n"),k+=` It must be ${u}. Received ${B}`,k},RangeError);function Es(b){let u="",d=b.length;const k=b[0]==="-"?1:0;for(;d>=k+4;d-=3)u=`_${b.slice(d-3,d)}${u}`;return`${b.slice(0,d)}${u}`}function Ro(b,u,d){Qt(u,"offset"),(b[u]===void 0||b[u+d]===void 0)&&Si(u,b.length-(d+1))}function Ds(b,u,d,k,B,D){if(b>d||b<u){const R=typeof u=="bigint"?"n":"";let j;throw D>3?u===0||u===BigInt(0)?j=`>= 0${R} and < 2${R} ** ${(D+1)*8}${R}`:j=`>= -(2${R} ** ${(D+1)*8-1}${R}) and < 2 ** ${(D+1)*8-1}${R}`:j=`>= ${u}${R} and <= ${d}${R}`,new Zt.ERR_OUT_OF_RANGE("value",j,b)}Ro(k,B,D)}function Qt(b,u){if(typeof b!="number")throw new Zt.ERR_INVALID_ARG_TYPE(u,"number",b)}function Si(b,u,d){throw Math.floor(b)!==b?(Qt(b,d),new Zt.ERR_OUT_OF_RANGE(d||"offset","an integer",b)):u<0?new Zt.ERR_BUFFER_OUT_OF_BOUNDS:new Zt.ERR_OUT_OF_RANGE(d||"offset",`>= ${d?1:0} and <= ${u}`,b)}const Lo=/[^+/0-9A-Za-z-_]/g;function Fo(b){if(b=b.split("=")[0],b=b.trim().replace(Lo,""),b.length<2)return"";for(;b.length%4!==0;)b=b+"=";return b}function xr(b,u){u=u||1/0;let d;const k=b.length;let B=null;const D=[];for(let R=0;R<k;++R){if(d=b.charCodeAt(R),d>55295&&d<57344){if(!B){if(d>56319){(u-=3)>-1&&D.push(239,191,189);continue}else if(R+1===k){(u-=3)>-1&&D.push(239,191,189);continue}B=d;continue}if(d<56320){(u-=3)>-1&&D.push(239,191,189),B=d;continue}d=(B-55296<<10|d-56320)+65536}else B&&(u-=3)>-1&&D.push(239,191,189);if(B=null,d<128){if((u-=1)<0)break;D.push(d)}else if(d<2048){if((u-=2)<0)break;D.push(d>>6|192,d&63|128)}else if(d<65536){if((u-=3)<0)break;D.push(d>>12|224,d>>6&63|128,d&63|128)}else if(d<1114112){if((u-=4)<0)break;D.push(d>>18|240,d>>12&63|128,d>>6&63|128,d&63|128)}else throw new Error("Invalid code point")}return D}function Mo(b){const u=[];for(let d=0;d<b.length;++d)u.push(b.charCodeAt(d)&255);return u}function zo(b,u){let d,k,B;const D=[];for(let R=0;R<b.length&&!((u-=2)<0);++R)d=b.charCodeAt(R),k=d>>8,B=d%256,D.push(B),D.push(k);return D}function Is(b){return e.toByteArray(Fo(b))}function ji(b,u,d,k){let B;for(B=0;B<k&&!(B+d>=u.length||B>=b.length);++B)u[B+d]=b[B];return B}function st(b,u){return b instanceof u||b!=null&&b.constructor!=null&&b.constructor.name!=null&&b.constructor.name===u.name}function kr(b){return b!==b}const Oo=function(){const b="0123456789abcdef",u=new Array(256);for(let d=0;d<16;++d){const k=d*16;for(let B=0;B<16;++B)u[k+B]=b[d]+b[B]}return u}();function _t(b){return typeof BigInt>"u"?Go:b}function Go(){throw new Error("BigInt not supported")}})(Xt);const fr=class fr extends Ne{constructor(t,i){super(t);m(this,"coins");this.coins=Math.min(999,Math.max(1,i))}addToMessage(t){super.addToMessage(t),t.add(this.coins,z.Int32)}isSameAs(t){return t instanceof fr?this.id===t.id&&this.coins===t.coins:!1}get infoBubbleContent(){return`Coins: ${this.coins}`}};m(fr,"selectedCoinCount",1);let Et=fr;class gi extends Ne{constructor(t,i){super(t);m(this,"switchId");this.switchId=Je.clamp(i,0,999)}addToMessage(t){super.addToMessage(t),t.add(this.switchId,z.Int32)}isSameAs(t){return t instanceof gi?this.id===t.id&&this.switchId===t.switchId:!1}}class Ni extends gi{constructor(t,i,r){super(t,i);m(this,"switchState");this.switchState=Je.clamp(r,0,1)}addToMessage(t){super.addToMessage(t),t.add(this.switchState,z.Byte)}isSameAs(t){return t instanceof Ni?this.id===t.id&&this.switchId===t.switchId&&this.switchState===t.switchState:!1}}class Yi extends Ne{constructor(t,i){super(t);m(this,"switchState");this.switchState=Je.clamp(i,0,1)}addToMessage(t){super.addToMessage(t),t.add(this.switchState,z.Byte)}isSameAs(t){return t instanceof Yi?this.id===t.id&&this.switchState===t.switchState:!1}}class Ki extends Ne{constructor(t,i){super(t);m(this,"deaths");this.deaths=Math.min(999,Math.max(1,i))}addToMessage(t){super.addToMessage(t),t.add(this.deaths,z.Int32)}isSameAs(t){return t instanceof Ki?this.id===t.id&&this.deaths===t.deaths:!1}get infoBubbleContent(){return`Deaths: ${this.deaths}`}}class sn{constructor(e){m(this,"world");m(this,"offset",0);this.world=e}deserialize(e){const t=Xt.Buffer.from(e);this.deserializeLayer(t,Q.Background),this.deserializeLayer(t,Q.Foreground)}deserializeLayer(e,t){for(let i=0;i<this.world.width;i++)for(let r=0;r<this.world.height;r++){const s=e.readInt32LE(this.offset);this.offset+=4;const o={value:this.offset},l=this.deserializeBlock(s,e,o);this.offset=o.value,this.world.setBlockData(i,r,t,l,!0)}}deserializeBlock(e,t,i){switch(e){default:return new Ne(e);case w.CoinDoor:case w.CoinGate:case w.BlueCoinDoor:case w.BlueCoinGate:{const r=t.readInt32LE(i.value);return i.value+=4,new Et(e,r)}case w.DeathDoor:case w.DeathGate:{const r=t.readInt32LE(i.value);return i.value+=4,new Ki(e,r)}case w.Portal:case w.PortalInvisible:{const r=t.readInt32LE(i.value);i.value+=4;const s=t.readInt32LE(i.value);i.value+=4;const o=t.readInt32LE(i.value);return i.value+=4,new Ye(e,r,s,o)}case w.Spikes:{const r=t.readInt32LE(i.value);return i.value+=4,new Wt(e,r)}case w.LocalSwitch:case w.LocalSwitchDoor:case w.LocalSwitchGate:case w.GlobalSwitch:case w.GlobalSwitchDoor:case w.GlobalSwitchGate:{const r=t.readInt32LE(i.value);return i.value+=4,new gi(e,r)}case w.LocalSwitchActivator:case w.GlobalSwitchActivator:{const r=t.readInt32LE(i.value);i.value+=4;const s=t.readUInt8(i.value);return i.value+=1,new Ni(e,r,s)}case w.LocalSwitchResetter:case w.GlobalSwitchResetter:{const r=t.readUInt8(i.value);return i.value+=1,new Yi(e,r)}}}}class rs extends os{constructor(e){super(e)}initialize(e){super.initialize(e)}render(e){const t=this.state.players.concat(this.state.player),i=[],r=[],s=[];for(const o of t)if(!(e!=o.isFlying&&!o.isDead)){if(o.isDead){this.addDeathAnim(i,r,s,o);continue}o.isInModMode?this.addStaffAura(i,r,s,o):o.isInGodMode&&this.addAura(i,r,s,o),this.addFace(i,r,s,o),this.addCrown(i,r,s,o),this.addChatIndicator(i,r,s,o)}this.updateBuffers(i,r,s),this.renderVertices()}addAura(e,t,i,r){const s=this.genSpriteData("auras/aura",r.x,r.y,-16,-16);e.push(...s.vertices),t.push(...s.texCoords),i.push(...s.colors)}addStaffAura(e,t,i,r){const s=Z.getSpriteAtlasPosition("auras/staff"),o=this.genAttribData(r.x,r.y,-24,-24,s.x,s.y,64,64,Math.round(r.staffAuraFrame));e.push(...o.vertices),t.push(...o.texCoords),i.push(...o.colors)}addFace(e,t,i,r){const s=this.genSpriteData(_e.getById(r.face).spriteName,r.x,r.y,-5,-5);e.push(...s.vertices),t.push(...s.texCoords),i.push(...s.colors)}addCrown(e,t,i,r){if(this.state.crownPlayer!==r&&!r.hasWinnerCrown)return;const s=this.genSpriteData(this.state.crownPlayer===r?"crowns/gold":"crowns/silver",r.x,r.y,2,-5);e.push(...s.vertices),t.push(...s.texCoords),i.push(...s.colors)}addChatIndicator(e,t,i,r){if(this.state.showPlayerLabelsAndBubbles||r.chatBubbles.length==0)return;const s=this.genSpriteData("misc/microchat",r.x,r.y,8,-5);e.push(...s.vertices),t.push(...s.texCoords),i.push(...s.colors)}addDeathAnim(e,t,i,r){if(r.deathFrame>=7)return;const s=Z.getSpriteAtlasPosition("misc/death"),o=this.genAttribData(r.x,r.y,-24,-24,s.x,s.y,64,64,Math.min(7,Math.round(r.deathFrame)));e.push(...o.vertices),t.push(...o.texCoords),i.push(...o.colors)}}m(rs,"SMILEY_TEX_SIZE",26),m(rs,"AURA_TEX_SIZE",48);class lc{constructor(e){m(this,"state");m(this,"x",0);m(this,"y",0);m(this,"targetX",0);m(this,"targetY",0);m(this,"targetPlayer",null);this.state=e}tick(){this.targetPlayer&&(this.targetX=this.targetPlayer.x+this.targetPlayer.width/2,this.targetY=this.targetPlayer.y+this.targetPlayer.height/2),this.x=this.lerp(this.x,this.targetX,.0625),this.y=this.lerp(this.y,this.targetY,.0625)}setTargetPlayer(e){this.targetPlayer=e,this.setPosition(this.targetPlayer.x+this.targetPlayer.width/2,this.targetPlayer.y+this.targetPlayer.height/2)}jumpToTargetPlayer(){this.targetPlayer&&this.setPosition(this.targetPlayer.x+this.targetPlayer.width/2,this.targetPlayer.y+this.targetPlayer.height/2)}setTargetPos(e,t){this.targetX=e,this.targetY=t}addTargetPos(e,t){this.targetX+=e,this.targetY+=t}setPosition(e,t){this.x=e,this.y=t}addPosition(e,t){this.x+=e,this.y+=t}getPosition(){const e=this.state.ui.sideBar.el.clientWidth/2;return{camX:Math.floor(this.x)-this.state.canvasElement.width/2+Math.floor(e),camY:Math.floor(this.y)-this.state.canvasElement.height/2}}isRectInView(e,t,i,r){const{camX:s,camY:o}=this.getPosition(),l=e-s,h=t-o;return l+i>0&&l<this.state.canvasElement.width&&h+r>0&&h<this.state.canvasElement.height}getViewMatrix(){let{camX:e,camY:t}=this.getPosition();return new Float32Array([2/this.state.canvasElement.width,0,0,0,-2/this.state.canvasElement.height,0,-1-2*e/this.state.canvasElement.width,1+2*t/this.state.canvasElement.height,1])}lerp(e,t,i){return(1-i)*e+i*t}}class cc{constructor(e=0,t=0,i=0,r=0,s=0,o=0){this.x=e,this.y=t,this.r=i,this.g=r,this.b=s,this.a=o}}class uc{constructor(e){m(this,"ui");m(this,"isVisible",!1);m(this,"el");m(this,"canvasCtx");m(this,"blocksCanvas");m(this,"blocksCtx");m(this,"blocksPixels");m(this,"blocksDirty",!0);m(this,"trailsCanvas");m(this,"trailsCtx");m(this,"trailsArray",[]);m(this,"trailsPixels");this.ui=e,this.el=T("canvas.minimap"),this.canvasCtx=this.el.getContext("2d",{willReadFrequently:!0})}initialize(){const e=this.ui.state.world.width,t=this.ui.state.world.height;this.blocksCanvas=new OffscreenCanvas(e,t),this.blocksCtx=this.blocksCanvas.getContext("2d",{willReadFrequently:!0}),this.trailsCanvas=new OffscreenCanvas(e,t),this.trailsCtx=this.trailsCanvas.getContext("2d",{willReadFrequently:!0}),this.el.width=e,this.el.height=t,this.blocksCanvas.width=e,this.blocksCanvas.height=t,this.trailsCanvas.width=e,this.trailsCanvas.height=t,this.trailsPixels=new ImageData(e,t),this.blocksPixels=this.blocksCtx.createImageData(e,t),this.reset()}reset(){const e=this.ui.state.world.width,t=this.ui.state.world.height;for(let i=0;i!==e;i++)for(let r=0;r!==t;r++)this.updateBlock(i,r)}updateBlock(e,t){const i=this.ui.state.world.getBlockData(e,t,Q.Foreground),r=this.ui.state.world.getBlockData(e,t,Q.Background),s=A.getById(i.id),o=A.getById(r.id);let l=4278190080;o.minimapColor!==void 0&&o.minimapColor!==null&&o.id>0&&(l=o.minimapColor),s.minimapColor!==void 0&&s.minimapColor!==null&&s.id>0&&(l=s.minimapColor);const h=(t*this.blocksPixels.width+e)*4;this.blocksPixels.data[h+0]=l>>16&255,this.blocksPixels.data[h+1]=l>>8&255,this.blocksPixels.data[h+2]=l&255,this.blocksPixels.data[h+3]=l>>24&255,this.blocksDirty=!0}tick(){if(this.isVisible){this.el.style.bottom=(this.ui.blockSelector.visible?this.ui.blockSelector.el.offsetHeight:0)+this.ui.toolbar.fixedHeight+5+"px",this.el.style.right="5px",this.blocksDirty&&(this.blocksCtx.putImageData(this.blocksPixels,0,0),this.blocksDirty=!1);for(const e of this.ui.state.playersIncludingMe.filter(t=>!t.isDead))this.trailsArray.push(new cc(e.blockX,e.blockY,e.minimapColor>>16&255,e.minimapColor>>8&255,e.minimapColor&255,255));for(let e=0;e<this.trailsArray.length;e++){const t=this.trailsArray[e];t.a=Math.max(0,t.a-3),t.a===0&&(this.trailsArray.splice(e,1),e--);const i=(t.y*this.trailsCanvas.width+t.x)*4;this.trailsPixels.data[i]=t.r,this.trailsPixels.data[i+1]=t.g,this.trailsPixels.data[i+2]=t.b,this.trailsPixels.data[i+3]=t.a}this.trailsCtx.putImageData(this.trailsPixels,0,0),this.canvasCtx.setTransform(1,0,0,1,0,0),this.canvasCtx.clearRect(0,0,this.el.width,this.el.height),this.canvasCtx.drawImage(this.blocksCanvas,0,0),this.canvasCtx.drawImage(this.trailsCanvas,0,0)}}setVisible(e){this.isVisible=e,this.ui.toolbar.showMinimapButton.setGlowing(e),this.isVisible&&(this.trailsArray=[],this.trailsCtx.clearRect(0,0,this.trailsCanvas.width,this.trailsCanvas.height),this.trailsPixels.data.fill(0)),this.el.style.display=e?"block":"none"}}class _r{constructor(){m(this,"el");m(this,"arrow");m(this,"content");m(this,"targetButton");this.el=T("div.block-config-bubble",[this.arrow=T("div.arrow"),this.content=T("div.content")])}createRow(e,t){return T("div.row",[T("div",e),t])}reposition(){var o;if(this.targetButton===void 0)return;const e=this.targetButton.el.getBoundingClientRect().left+7,t=this.targetButton.el.getBoundingClientRect().top,i=this.el.getBoundingClientRect(),r=Math.max(0,Math.min(e-i.width/2,((o=this.el.parentElement)==null?void 0:o.clientWidth)-i.width)),s=Math.max(0,t-(i.height+10));this.el.style.left=`${r}px`,this.el.style.top=`${s}px`,this.arrow.style.left=`${e-r-10}px`}}class Xi{constructor(e,t,i){m(this,"el");m(this,"minValue");m(this,"maxValue");m(this,"change");m(this,"decreaseButton");m(this,"input");m(this,"increaseButton");this.minValue=t,this.maxValue=i;const r=t.toString().length,s=i.toString().length;this.el=T("div.numeric",[this.decreaseButton=T("div.button",{onclick:()=>this.decrease()},"-"),this.input=T("input.value",{value:e,minLength:r,maxLength:s,onchange:()=>this.valueChanged()}),this.increaseButton=T("div.button",{onclick:()=>this.increase()},"+")])}valueChanged(){var i;const e=this.input.value;let t=parseInt(this.input.value);if(isNaN(t)){this.input.value=e;return}t=Je.clamp(t,this.minValue,this.maxValue),this.input.value=t.toString(),(i=this.change)==null||i.call(this,t)}increase(){this.input.value=(parseInt(this.input.value)+1).toString(),this.valueChanged()}decrease(){this.input.value=(parseInt(this.input.value)-1).toString(),this.valueChanged()}}class nn extends _r{constructor(t){super();m(this,"coinsInput");this.coinsInput=new Xi(Et.selectedCoinCount,1,999),this.coinsInput.change=i=>{Et.selectedCoinCount=i},Y(this.content,this.createRow(t,this.coinsInput))}}class vo{constructor(e,t){m(this,"el");m(this,"block");m(this,"isSelected");m(this,"blockImage");m(this,"selectorImage");this.el=T("div.block-button",{onclick:()=>t(this)}),this.setBlock(e,!0)}setSelected(e){this.isSelected!=e&&(this.isSelected=e,Pe(this.selectorImage,{display:e?"block":"none"}))}setBlock(e,t=!1){this.block=e,t||(ye(this.el,this.blockImage),ye(this.el,this.selectorImage)),this.blockImage=e.displayImage.cloneNode(),this.selectorImage=Z.selectionIndicator.cloneNode(),this.setSelected(this.isSelected??!1),Y(this.el,this.blockImage),Y(this.el,this.selectorImage)}}class hc{constructor(e,t,i,r){m(this,"el");m(this,"blockSelector");m(this,"blocks");this.blockSelector=e,this.el=T("div.package",[T("div.title",t.name),this.blocks=T("div.blocks")]);for(const s of t.blocks.filter(o=>o.blockTab==i)){const o=new vo(s,r.bind(this));this.blockSelector.ui.allBlockButtons.push(o),Y(this.blocks,o)}}}class Zi{constructor(e,t,i){m(this,"el");m(this,"blockSelector");m(this,"blockTab");this.blockSelector=e,this.blockTab=t,this.el=T("div.page",[T("div.title",i)]);const r=T("div.container");for(const s of ht.blockPackages){if(!s.blocks.some(l=>l.blockTab==t))continue;const o=new hc(this.blockSelector,s,this.blockTab,this.onBlockButtonClicked.bind(this));Y(r,o)}Y(this.el,r)}onBlockButtonClicked(e){if(this.blockSelector.ui.toolbar.quickBlockSelector.rememberBlock!==void 0)return;const t=this.blockSelector.ui.state.getSelectedBlockId()==e.block.id;if(t||this.blockSelector.ui.state.setSelectedBlockId(e.block.id),this.blockSelector.ui.blockConfigBubble&&t)this.blockSelector.ui.setBlockConfigBubble(void 0);else{const i=As.getBlockConfigBubble(e.block.id);this.blockSelector.ui.setBlockConfigBubble(i),i&&(i.targetButton=e,i.reposition())}}setVisible(e){this.el.style.display=e?"flex":"none"}}class Qi{constructor(e,t){m(this,"el");m(this,"selected",!1);this.el=T("div.tab",{onclick:t},T(`i.fas fa-${e}`))}setSelected(e){this.el.classList.toggle("selected",e),this.selected=e}}class dc{constructor(e){m(this,"el");m(this,"ui");m(this,"visible",!1);m(this,"initialized",!1);m(this,"selectedTab",C.Blocks);m(this,"blockSelectorTabs",[]);m(this,"blocksTab");m(this,"actionTab");m(this,"decorationsTab");m(this,"backgroundsTab");m(this,"blockSelectorPages",[]);m(this,"blocksPage");m(this,"actionPage");m(this,"decorationsPage");m(this,"backgroundsPage");this.ui=e,this.blockSelectorTabs=[this.blocksTab=new Qi("cube",this.switchTab.bind(this,C.Blocks)),this.actionTab=new Qi("bolt",this.switchTab.bind(this,C.Action)),this.decorationsTab=new Qi("leaf",this.switchTab.bind(this,C.Decorations)),this.backgroundsTab=new Qi("image",this.switchTab.bind(this,C.Backgrounds))],this.blockSelectorPages=[this.blocksPage=new Zi(this,C.Blocks,"Building Blocks"),this.actionPage=new Zi(this,C.Action,"Action Blocks"),this.decorationsPage=new Zi(this,C.Decorations,"Decorative Blocks"),this.backgroundsPage=new Zi(this,C.Backgrounds,"Background Blocks")],this.el=T("div.block-selector",[T("div.tabs",this.blockSelectorTabs),this.blockSelectorPages]),this.setVisible(!1)}initialize(){this.switchTab(C.Blocks,!0),this.initialized=!0}setVisible(e){this.visible=e,e&&(this.el.style.display="flex"),Tt.fromTo(this.el,{opacity:e?0:1,y:e?10:0},{opacity:e?1:0,y:e?0:10,duration:.1,ease:"power1.inOut",onComplete:()=>{e||(this.el.style.display="none")}}),e&&this.reposition(),e||this.ui.setBlockConfigBubble(void 0)}switchTab(e,t=!1){if(!(this.selectedTab==e&&!t)){for(let i=0;i<this.blockSelectorTabs.length;i++){const r=this.blockSelectorTabs[i],s=this.blockSelectorPages[i],o=s.blockTab==e;r.setSelected(o),s.setVisible(o)}this.ui.setBlockConfigBubble(void 0),this.selectedTab=e}}nextTab(){const e=this.blockSelectorTabs.length;for(let t=0;t<e;t++)if(this.blockSelectorTabs[t].selected){const r=(t+1)%e;this.switchTab(this.blockSelectorPages[r].blockTab);return}}reposition(){this.el.style.top=this.ui.el.clientHeight-this.ui.toolbar.el.clientHeight-this.el.clientHeight+"px"}checkKeybinds(){this.ui.state.canEdit&&(U.isKeyJustDown("toggle_block_selector")&&this.setVisible(!this.visible),U.isKeyJustDown("block_selector_cycle_tab")&&(this.visible?this.nextTab():this.setVisible(!0)))}}class fc{constructor(e){m(this,"el");m(this,"isVisible",!1);m(this,"input");m(this,"sendButton");this.ui=e,this.el=T("div.chat-box",[T("i.fa fa-comment"),this.input=T("input",{onkeydown:this.onInputKeyDown.bind(this),type:"text",maxlength:120,placeholder:"Type a message or /help for commands"}),this.sendButton=T("div.send",{onclick:this.sendChat.bind(this)},"Send")])}initialize(){this.setVisible(!1)}setVisible(e){if(this.isVisible=e,this.el.style.display=e?"":"none",this.ui.updateChatButton(),e){this.input.focus();return}this.input.value=""}checkKeybinds(){U.isKeyJustDown("reply_pm")&&this.ui.lastPMUsername&&(this.setVisible(!0),this.input.value=`/pm ${this.ui.lastPMUsername} `)}onInputKeyDown(e){U.getKeyBinds("send_chat").indexOf(e.key)!==-1?this.sendChat():U.getKeyBinds("autocomplete_chat").indexOf(e.key)!==-1?(e.preventDefault(),this.autoCompleteUsername()):U.getKeyBinds("close_chat").indexOf(e.key)!==-1&&this.setVisible(!1)}sendChat(){const e=this.input.value.trim();if(!e){this.setVisible(!1);return}const t=new ke(V.ChatMessage);t.add(e),G.pwio.send(t),this.setVisible(!1)}autoCompleteUsername(){let e=this.input.value,t=e.lastIndexOf(" "),i=e.substring(t+1);if(i.length===0)return;let s=this.ui.state.playersIncludingMe.map(h=>h.username).filter(h=>h.startsWith(i.trim().toUpperCase()));if(s.length===0)return;const o=t===-1;let l=s[0]+(o?": ":" ");this.input.value=e.substring(0,t+1)+l}}class Lr{constructor(e){m(this,"el");m(this,"text");this.el=T("div.counter",[this.text=T("span"),e.cloneNode()])}setText(e){this.text.innerText=e}setVisible(e){this.el.style.display=e?"flex":"none"}}class pc{constructor(e){m(this,"el");m(this,"ui");m(this,"coinCounter");m(this,"blueCoinCounter");m(this,"deathCounter");this.ui=e,this.el=T("div.counters",[this.coinCounter=new Lr(A.getById(w.Coin).generateDisplayImage(!1)),this.blueCoinCounter=new Lr(A.getById(w.BlueCoin).generateDisplayImage(!1)),this.deathCounter=new Lr(Z.deathCountIcon)])}initialize(){this.updateCoinCount(),this.updateBlueCoinCount(),this.updateDeathCount()}updateCoinCount(){const e=this.ui.state.player.counters.goldCoins,t=this.ui.state.world.totalCoinCounter.gold;this.coinCounter.setVisible(t>0),this.coinCounter.setText(`${e}/${t}`)}updateBlueCoinCount(){const e=this.ui.state.player.counters.blueCoins,t=this.ui.state.world.totalCoinCounter.blue;this.blueCoinCounter.setVisible(t>0),this.blueCoinCounter.setText(`${e}/${t}`)}updateDeathCount(){const e=this.ui.state.player.counters.deaths;this.deathCounter.setVisible(e>0),this.deathCounter.setText(`${e}`)}}class mc{constructor(e,t){m(this,"el");m(this,"count",1);this.username=e,this.usernameColor=t,this.el=T("div.player",[T("div.username",{style:{color:t},onclick:()=>G.showProfile(e.toUpperCase())},e)])}}class gc{constructor(){m(this,"el");m(this,"listItems",[]);this.el=T("div.player-list")}addPlayer(e){const t=this.listItems.find(r=>r.username===e.username);if(t){t.count++;return}const i=new mc(e.username,e.usernameColor);this.listItems.push(i),this.refreshItems()}removePlayer(e){const t=this.listItems.find(i=>i.username===e.username);t&&--t.count<1&&(this.listItems.splice(this.listItems.indexOf(t),1),this.refreshItems())}refreshItems(){this.el.innerHTML="";for(const e of this.listItems)Y(this.el,e)}}class wc{constructor(e,t,i,r="#FFF"){m(this,"el");this.el=T("div.entry",[T("span",{style:{color:r}},`${e}: `),T("span",{style:{color:"#BBB"}},t.replace(/\r\n|\r|\n/g,`
`))]),i&&this.el.classList.add("highlight")}}class yc{constructor(e){m(this,"el");this.sidebar=e,this.el=T("div.chat")}addMessage(e,t,i="#FFF"){const r=this.el.scrollTop+this.el.clientHeight>=this.el.scrollHeight-10,s=t.toLowerCase().indexOf(this.sidebar.ui.state.player.username.toLowerCase())!==-1;Y(this,new wc(e,t,s,i)),this.el.children.length>50&&this.el.removeChild(this.el.children[0]),r&&(this.el.scrollTop=this.el.scrollHeight)}resize(){this.el.scrollTop=this.el.scrollHeight}}const mt=class mt{static Filter(e){let t=e;t=t.replace(/(\s){2,}/mgi," ");let i=t.split(" "),r=!1;for(let o=0;o<i.length-1;o++){if((i[o].length==1||r)&&i[o+1].length==1){i[o]+=i[o+1],i.splice(o+1,1),o--,r=!0;continue}r=!1}let s=!1;for(let o=0;o<i.length;o++)this.isBadword(i[o])&&(mt.removeBadWords?i.splice(o--,1):i[o]=mt.badwordReplacement,s=!0);return s?i.join(" "):e}static isBadword(e,t=!1){e=e.toLowerCase();for(let r=0;r<mt.badwords.length;r++){let s=mt.badwords[r];if(s.charAt(s.length-1)=="*"&&s.charAt(0)=="*"){if(s=s.substr(1).substr(0,s.length-2),e.indexOf(s)!=-1)return!0}else if(s.charAt(0)=="*"){if(s=s.substr(1),e.length>=s.length&&e.indexOf(s)==e.length-s.length)return!0}else if(s.charAt(0)=="+"){if(s=s.substr(1),e.length>s.length&&e.indexOf(s)==e.length-s.length)return!0}else if(s.charAt(s.length-1)=="*"){if(s=s.substr(0,s.length-1),e.indexOf(s)==0)return!0}else if(e.length>=s.length&&s.charAt(s.length-1)=="+"){if(s=s.substr(0,s.length-1),e.length>s.length&&e.indexOf(s)==0)return!0}else if(e==s)return!0}if(t)return!1;let i;return!!(this.isBadword(e.replace(/[^\w| ]/mgi,""),!0)||(i=e.replace(/[^\w| ]/mgi," "),i!=e&&this.Filter(i)!=i)||(i=e,i=i.replace(/\$/mgi,"s"),i=i.replace(/5/mgi,"s"),i=i.replace(/3/mgi,"b"),i=i.replace(/\!/mgi,"l"),i=i.replace(/0/mgi,"o"),i=i.replace(/1/mgi,"i"),i=i.replace(/\#/mgi,"h"),i=i.replace(/€/mgi,"e"),i=i.replace(/\(/mgi,"c"),this.isBadword(i,!0))||(i=i.replace(/z/mgi,"s"),this.isBadword(i,!0)))}};m(mt,"removeBadWords",!1),m(mt,"badwordReplacement","****"),m(mt,"badwords",["ahole*","anus*","arse*","arss*","ashole*","ass","asshole","asswipe","ballsdeep","*bastard*","*basterd*","*bassterd*","*biatch*","*bitch*","blowjob","*bollock*","boner","*boob*","breast*","bukkak*","butthole*","buttwipe*","carpetmunch*","chink*","chode*","choad*","clit*","*cnts*","cock*","cok","cokbite*","cokhead*","cokjock*","cokmunch*","coks","coksuck*","coksmoke*","crap+","cum*","cunnie*","cunnilingus*","cunny*","*cunt*","*dammit*","dick","dik","dike*","diks","dildo*","douche*","doosh*","dooch*","*dumbars*","*dumbass*","*dumars*","*dumass*","edjaculat*","ejacculat*","ejackulat*","ejaculat*","ejaculit*","ejakulat*","enema*","faeces*","fag*","*fatars*","*fatass*","*fcuk*","feces*","felatio*feltch*","flikker*","*foreskin*","*forskin*","*fuck*","*fudgepack*","*fuk*","gay*","*handjob*","hardon*","*hiroshima*","*hitler*","hoar","homo","honkey*","hoor","hoore","hoores","hoors","horing","hooring","humping*","*jackars*","*jackass*","*jackoff*","*jerkoff*","jiss*","*jizz*","kike*","knobjock*","knobrid*","knobsuck*","kooch*","kootch*","kraut*","kunt*","kyke*","*lardars*","*lardass*","*lesbian*","lesbo*","lessie*","lezzie*","lezzy*","*masturbat*","minge*","minging*","mofo","muffdive*","munge*","munging*","*nazi*","*negro*","niga","nigg*","niglet*","nutsack*","orafis","*orgasm*","*orgasum*","oriface","orifice","orifiss","paci","pacie","packi","packie","packy","paki","pakie","paky","panooch","pecker","peanis","peeenis","peeenus","peeenusss","peenis","peenus","peinus","penas","*penis*","penus","phuc","phuck*","phuk*","pissflap*","polac","polack*","polak*","polesmok*","pollac","pollack*","pollak*","polloc","pollock*","pollok*","poon","poonani","poonanni","poonanny","poonany","poontang","poop*","porn*","preteen*","pula","pule","punani","punanni","punanny","punany","pusse","pussee","pussie","pussies","pussy","pussying","pussylick","pussysuck","poossy*","poossie*","puuke","puuker","queef*","queer*","qweer*","qweir*","recktum*","rectum*","renob","retard*","rimming*","rimjob*","ruski*","sadist*","scank*","schlong*","schmuck*","screw*","scrote*","scrotum*","semen*","sex*","shemale*","shat","*shit*","skank*","*slut*","spic","spick","spik","stalin*","tard","teets","testic*","tit","tits","titt","titty*","tittie*","twat*","*vagina*","*vaginna*","*vaggina*","*vaagina*","*vagiina*","vag","vags","vaj","vajs","*vajina*","*vulva*","wank*","*whoar*","whoe","*whor*","*B=D*","*B==D*","*B===*"]);let wi=mt;class _c{constructor(e){m(this,"el");m(this,"worldTitle");m(this,"worldSubTitle");m(this,"playerList");m(this,"chat");this.ui=e,this.el=T("div.sidebar",[T("div.info",[this.worldTitle=T("div.title"),this.worldSubTitle=T("div.subtitle")]),this.playerList=new gc,this.chat=new yc(this)]),this.updateMeta("Untitled World",0,"")}updateMeta(e,t,i){if(this.worldTitle.textContent=wi.Filter(e),i===""){this.worldSubTitle.textContent=`${t} play${t===1?"":"s"}`;return}bn(this.worldSubTitle,[T("span","by "),T("span.username",{onclick:()=>G.showProfile(i.toUpperCase())},i),T("span",` · ${t} play${t===1?"":"s"}`)])}initialize(){this.playerList.addPlayer(this.ui.state.player),this.playerList.refreshItems()}}class bc{constructor(e,t){m(this,"el");m(this,"smiley");m(this,"isSelected");m(this,"smileyImage");m(this,"selectorImage");this.smiley=e,this.el=T("",{onclick:()=>t(this),class:"smiley-button"},[this.smileyImage=e.displayImage.cloneNode(),this.selectorImage=Z.selectionIndicator.cloneNode()]),Pe(this.smileyImage,{position:"absolute",width:"26px",height:"26px"}),Pe(this.selectorImage,{position:"absolute",width:"16px",height:"16px"}),this.setSelected(this.isSelected??!1),Y(this.el,this.smileyImage),Y(this.el,this.selectorImage)}setSelected(e){this.isSelected!=e&&(this.isSelected=e,Pe(this.selectorImage,{display:e?"block":"none"}))}}class Sc{constructor(e){m(this,"el");m(this,"ui");m(this,"isVisible",!1);m(this,"smileyButtons",[]);this.ui=e;for(const t of ht.getSmileys()){const i=new bc(t,this.onSmileySelected.bind(this));this.smileyButtons.push(i)}this.el=T("div.smiley-selector",{style:{maxWidth:26*8+"px"}},this.smileyButtons),this.setVisible(!1)}setVisible(e){this.isVisible=e,this.el.style.display=e?"flex":"none",this.ui.toolbar.changeSmileyButton.setGlowing(e),e&&(this.el.style.bottom=this.ui.toolbar.changeSmileyButton.el.offsetHeight+1+"px",this.el.style.left=this.ui.toolbar.changeSmileyButton.el.offsetLeft-1+"px")}onSmileySelected(e){const t=new ke(V.PlayerFace);t.add(e.smiley.id,z.Int32),G.pwio.send(t)}update(){for(const e of this.smileyButtons){const t=e.smiley.id==this.ui.state.player.face;e.setSelected(t),t&&this.ui.toolbar.changeSmileyButton.setImage(e.smiley.displayImage)}}}class xc{constructor(e){m(this,"el");m(this,"toolbar");m(this,"baseBlocks",[w.Empty,w.GravityLeft,w.GravityUp,w.GravityRight,w.GravityDot,w.BasicGray,w.BasicRed,w.BasicGreen,w.BasicBlue,w.Coin,w.BlueCoin]);m(this,"blockButtons",[]);m(this,"selectedIndex",0);m(this,"rememberBlock");this.toolbar=e;for(const t of this.baseBlocks){const i=new vo(A.getById(t),this.onBlockButtonClicked.bind(this));this.blockButtons.push(i)}this.toolbar.ui.allBlockButtons.push(...this.blockButtons),this.el=T("div.quick-block-selector",[T("div.title-and-blocks",["BLOCKS",T("div.block-row",this.blockButtons)]),T("div.more-button",{onclick:this.toolbar.toggleBlockSelector.bind(this.toolbar)},T("i.fa-solid fa-chevron-up"))])}onBlockButtonClicked(e){if(this.rememberBlock!==void 0)return;const t=this.toolbar.ui.state.getSelectedBlockId()==e.block.id;if(t||this.toolbar.ui.state.setSelectedBlockId(e.block.id),this.toolbar.ui.blockConfigBubble&&t)this.toolbar.ui.setBlockConfigBubble(void 0);else{const i=As.getBlockConfigBubble(e.block.id);this.toolbar.ui.setBlockConfigBubble(i),i&&(i.targetButton=e,i.reposition())}}selectIndex(e){this.selectedIndex=e;const t=this.blockButtons[e];this.toolbar.ui.state.setSelectedBlockId(t.block.id)}selectBlock(e){const t=this.blockButtons.find(i=>i.block.id==e);if(!t){this.selectedIndex=-1;return}this.selectedIndex=this.blockButtons.indexOf(t)}pickBlock(e){if(this.selectedIndex<=0)return;if(e==w.Empty){this.selectIndex(0);return}const t=this.blockButtons.find(r=>r.block.id==e);if(t){this.selectIndex(this.blockButtons.indexOf(t));return}this.blockButtons[this.selectedIndex].setBlock(A.getById(e)),this.selectIndex(this.selectedIndex)}checkKeybinds(){if(U.isKeyDown("shift")){this.rememberBlock===void 0&&(this.rememberBlock=this.toolbar.ui.state.getSelectedBlockId(),this.toolbar.ui.state.setSelectedBlockId(w.Empty));return}this.rememberBlock!==void 0&&(this.toolbar.ui.state.setSelectedBlockId(this.rememberBlock),this.rememberBlock=void 0);for(let e=0;e<10;e++)U.isKeyJustDown(`block_${e+1}`)&&this.selectIndex(e+1)}}class ii{constructor(e,t,i){m(this,"el");m(this,"content");m(this,"isGlowing",!1);this.el=T("div.button",{style:{width:e+"px"},onmousedown:s=>{s.preventDefault(),s.button==0&&i()},ontouchstart:s=>{s.preventDefault(),i()}});const r="1px solid rgba(120, 120, 120, 0.8)";Pe(this.el,t=="left"?{borderRight:r}:{borderLeft:r})}setText(e){this.content&&ye(this.el,this.content),Y(this.el,this.content=T("span",e))}setImage(e){this.content&&ye(this.el,this.content),Y(this.el,this.content=e.cloneNode()),this.setGlowing(this.isGlowing)}setIcon(e){this.content&&ye(this.el,this.content),Y(this.el,this.content=T(`i.fa fa-${e}`)),this.setGlowing(this.isGlowing)}setGlowing(e){this.isGlowing=e,this.content&&(e?Pe(this.content,{filter:"drop-shadow(0px 0px 6px rgba(255, 255, 255, 0.8))"}):Pe(this.content,{filter:"none"}))}}class kc{constructor(e){m(this,"el");m(this,"fixedHeight",36);m(this,"middleSection");m(this,"quickBlockSelector");m(this,"exitWorldButton");m(this,"changeSmileyButton");m(this,"godModeButton");m(this,"chatButton");m(this,"fullScreenButton");m(this,"showMinimapButton");this.ui=e,this.el=T("div.toolbar",[this.exitWorldButton=new ii(47,"left",this.exitWorld.bind(this)),this.changeSmileyButton=new ii(this.fixedHeight,"left",this.toggleSmileySelector.bind(this)),this.chatButton=new ii(this.fixedHeight,"left",this.toggleChat.bind(this)),this.godModeButton=new ii(42,"left",this.toggleGodMode.bind(this)),this.middleSection=T("div.middle-section",[this.quickBlockSelector=new xc(this)]),this.fullScreenButton=new ii(this.fixedHeight,"right",G.toggleFullScreen.bind(G)),this.showMinimapButton=new ii(this.fixedHeight,"right",this.toggleMinimap.bind(this))]),this.exitWorldButton.setText("Exit world"),this.chatButton.setIcon("comment"),this.godModeButton.setText("God mode"),this.fullScreenButton.setImage(Z.fullScreenIcon),this.showMinimapButton.setIcon("map")}exitWorld(){G.pwio.disconnect()}toggleMinimap(){this.ui.minimap.setVisible(!this.ui.minimap.isVisible)}toggleChat(){this.ui.chatBox.setVisible(!this.ui.chatBox.isVisible)}toggleSmileySelector(){this.ui.smileySelector.setVisible(!this.ui.smileySelector.isVisible)}toggleBlockSelector(){this.ui.blockSelector.setVisible(!this.ui.blockSelector.visible)}toggleGodMode(){const e=new ke(V.PlayerGodMode);e.add(!this.ui.state.player.isInGodMode),G.pwio.send(e)}toggleModMode(){const e=new ke(V.PlayerModMode);e.add(!this.ui.state.player.isInModMode),G.pwio.send(e)}checkKeybinds(){U.isKeyJustDown("god_mode")&&this.toggleGodMode(),U.isKeyJustDown("mod_mode")&&this.ui.state.player.isAdmin&&this.toggleModMode(),U.isKeyJustDown("minimap")&&this.toggleMinimap(),U.isKeyJustDown("open_chat")&&this.toggleChat(),U.isKeyJustDown("open_chat_command")&&!this.ui.chatBox.isVisible&&(this.ui.chatBox.setVisible(!0),this.ui.chatBox.input.value="/"),this.quickBlockSelector.checkKeybinds()}}class vc extends _r{constructor(){super();m(this,"portalIdInput");m(this,"portalTargetIdInput");this.portalIdInput=new Xi(Ye.selectedPortalId,0,999),this.portalIdInput.change=t=>{Ye.selectedPortalId=t},Y(this.content,this.createRow("Portal ID:",this.portalIdInput)),this.portalTargetIdInput=new Xi(Ye.selectedPortalTargetId,0,999),this.portalTargetIdInput.change=t=>{Ye.selectedPortalTargetId=t},Y(this.content,this.createRow("Portal Target ID:",this.portalTargetIdInput))}}class Bc{constructor(e){m(this,"el");m(this,"arrow");m(this,"content");m(this,"blockX",0);m(this,"blockY",0);this.ui=e,this.el=T("div.block-info-bubble",[this.arrow=T("div.arrow"),this.content=T("div.content")]),this.setVisible(!1)}setPosition(e,t){const i=this.el.getBoundingClientRect(),r=e-i.width/2,s=t-i.height-6;this.el.style.left=`${r}px`,this.el.style.top=`${s}px`}setBlockPosition(e,t){this.blockX=e,this.blockY=t}setVisible(e){Pe(this.el,{visibility:e?"visible":"hidden"})}setContent(e){this.content.innerText=e}tick(){const t=this.ui.state.camera.getPosition();this.setPosition(this.blockX*16-t.camX+8,this.blockY*16-t.camY)}}class Ac{constructor(e){m(this,"el");m(this,"values",["OFF","ON"]);m(this,"change");m(this,"leftArrowButton");m(this,"valueEl");m(this,"rightArrowButton");this.el=T("div.on-off",[this.leftArrowButton=T("div.button",{onclick:()=>this.previous()},"<"),this.valueEl=T("div.value",this.values[e]),this.rightArrowButton=T("div.button",{onclick:()=>this.next()},">")])}next(){var i;const t=(this.values.indexOf(this.valueEl.innerText)+1)%this.values.length;this.valueEl.innerText=this.values[t],(i=this.change)==null||i.call(this,t)}previous(){var i;const t=(this.values.indexOf(this.valueEl.innerText)-1+this.values.length)%this.values.length;this.valueEl.innerText=this.values[t],(i=this.change)==null||i.call(this,t)}}const xt=class xt extends _r{constructor(t,i){super();m(this,"switchIdInput");m(this,"switchStateInput");i!=w.LocalSwitchResetter&&i!=w.GlobalSwitchResetter&&(this.switchIdInput=new Xi(xt.selectedSwitchId,0,999),this.switchIdInput.change=r=>{xt.selectedSwitchId=r},Y(this.content,this.createRow(`${t} Switch ID:`,this.switchIdInput))),(i==w.LocalSwitchActivator||i==w.LocalSwitchResetter||i==w.GlobalSwitchActivator||i==w.GlobalSwitchResetter)&&(this.switchStateInput=new Ac(xt.selectedState),this.switchStateInput.change=r=>{xt.selectedState=r},Y(this.content,this.createRow(`${t} Switch State:`,this.switchStateInput)))}};m(xt,"selectedSwitchId",0),m(xt,"selectedState",0);let At=xt;const Di=class Di extends _r{constructor(t){super();m(this,"coinsInput");this.coinsInput=new Xi(Di.selectedDeaths,1,999),this.coinsInput.change=i=>{Di.selectedDeaths=i},Y(this.content,this.createRow(t,this.coinsInput))}};m(Di,"selectedDeaths",1);let Vi=Di;class As{constructor(e){m(this,"el");m(this,"state");m(this,"gameContainer");m(this,"allBlockButtons",[]);m(this,"lastPMUsername","");m(this,"sideBar",new _c(this));m(this,"minimap",new uc(this));m(this,"toolbar",new kc(this));m(this,"blockSelector",new dc(this));m(this,"smileySelector",new Sc(this));m(this,"counters",new pc(this));m(this,"chatBox",new fc(this));m(this,"blockInfoBubble",new Bc(this));m(this,"blockConfigBubble");this.state=e,this.el=T("div.ui",[this.gameContainer=T("div.game",[this.blockInfoBubble,this.counters,this.minimap,this.blockSelector,this.smileySelector,this.chatBox,this.toolbar]),this.sideBar])}resize(){var e;this.sideBar.chat.resize(),this.blockSelector.reposition(),(e=this.blockConfigBubble)==null||e.reposition()}initialize(){this.minimap.initialize(),this.counters.initialize(),this.sideBar.initialize(),this.chatBox.initialize(),this.blockSelector.initialize(),this.updateSmileyButton(),this.updateGodModeButton(),this.updateChatButton(),this.updateRights()}tick(){var e;this.toolbar.checkKeybinds(),this.blockSelector.checkKeybinds(),this.chatBox.checkKeybinds(),this.minimap.tick(),(e=this.blockInfoBubble)==null||e.tick()}updateSmileyButton(){this.smileySelector.update(),this.toolbar.changeSmileyButton.setImage(ht.smileys[this.state.player.face].displayImage)}updateGodModeButton(){this.toolbar.godModeButton.setGlowing(this.state.player.isInGodMode)}updateChatButton(){this.toolbar.chatButton.setGlowing(this.chatBox.isVisible)}updateRights(){this.setCanEdit(this.state.canEdit),this.setCanToggleGodMode(this.state.canToggleGodMode)}setCanEdit(e){Pe(this.toolbar.quickBlockSelector.el,{display:e?"":"none"}),Pe(this.blockSelector.el,{display:e?"":"none"}),e||this.blockSelector.setVisible(!1)}setCanToggleGodMode(e){Pe(this.toolbar.godModeButton.el,{display:e?"":"none"})}setBlockConfigBubble(e){this.blockConfigBubble&&(ye(this.gameContainer,this.blockConfigBubble),this.blockConfigBubble=void 0),e&&(this.blockConfigBubble=e,Y(this.gameContainer,this.blockConfigBubble))}updateSelectedBlock(){this.setBlockConfigBubble(void 0);for(const e of this.allBlockButtons)e.setSelected(e.block.id==this.state.getSelectedBlockId());this.toolbar.quickBlockSelector.selectBlock(this.state.getSelectedBlockId())}static getBlockConfigBubble(e){switch(e){case w.CoinDoor:case w.BlueCoinDoor:return new nn("Coins to open door:");case w.CoinGate:case w.BlueCoinGate:return new nn("Coins to close gate:");case w.DeathDoor:return new Vi("Deaths to open door:");case w.DeathGate:return new Vi("Deaths to close gate:");case w.Portal:case w.PortalInvisible:return new vc;case w.LocalSwitch:case w.LocalSwitchDoor:case w.LocalSwitchGate:case w.LocalSwitchActivator:case w.LocalSwitchResetter:return new At("Local",e);case w.GlobalSwitch:case w.GlobalSwitchDoor:case w.GlobalSwitchGate:case w.GlobalSwitchActivator:case w.GlobalSwitchResetter:return new At("Global",e);default:return}}}const pr=class pr extends os{constructor(t){super(t);m(this,"particlesPos",Z.getSpriteAtlasPosition("misc/particles"));m(this,"particles",[])}initialize(t){super.initialize(t)}render(){const t=[],i=[],r=[];for(const s of this.particles.filter(o=>!o.isDead)){const o=this.genAttribData(s.x,s.y,0,0,this.particlesPos.x,this.particlesPos.y,5,5,s.frame);t.push(...o.vertices),i.push(...o.texCoords),r.push(...o.colors)}this.updateBuffers(t,i,r),this.renderVertices()}addParticle(...t){for(this.particles.push(...t);this.particles.length>pr.MAX_PARTICLES;)this.particles.shift()}tickParticles(){for(let t=0;t<this.particles.length;t++){const i=this.particles[t];i.tick(),i.isDead&&(this.particles.splice(t,1),t--)}}};m(pr,"MAX_PARTICLES",1e3);let ss=pr;class br extends _i{constructor(t,i=void 0){super();m(this,"joinRoomId");m(this,"joinData");m(this,"canvasElement");m(this,"gl");m(this,"initialized",!1);m(this,"worldRenderer",null);m(this,"playerRenderer",null);m(this,"particleRenderer",null);m(this,"tileAtlasTexture",null);m(this,"spriteAtlasTexture",null);m(this,"takingScreenshot",!1);m(this,"usernameLabels",T("div.username-labels"));m(this,"chatBubbles",T("div.chat-bubbles"));m(this,"ui",new As(this));m(this,"world",null);m(this,"camera",null);m(this,"player",null);m(this,"players",[]);m(this,"lastTick",0);m(this,"lastMovement",0);m(this,"selectedBlockId",0);m(this,"drawLayerLock",null);m(this,"lastPlacementPos");m(this,"crownPlayer");m(this,"keys");m(this,"canEdit",!1);m(this,"canToggleGodMode",!1);m(this,"checkPoint");m(this,"switches",new Uint8Array(1e3));if(this.joinRoomId=t,this.joinData=i,this.canvasElement=T("canvas"),this.gl=this.canvasElement.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0}),!this.gl)throw new Error("Unable to initialize WebGL2. Your browser or machine may not support it.")}get playersIncludingMe(){return[this.player,...this.players]}async load(){const t=this.gl;if(this.tileAtlasTexture=t.createTexture(),this.spriteAtlasTexture=t.createTexture(),Z.registerTexture(t,this.tileAtlasTexture,Z.tileAtlas,0),Z.registerTexture(t,this.spriteAtlasTexture,Z.spriteAtlas,1),ui.initialize(t),await G.pwio.connect(this.joinRoomId,this.joinData),G.pwio.connected){for(G.pwio.onDisconnected=i=>this.onDisconnect(i),G.pwio.onMessage=this.onMessage.bind(this);!this.initialized;)await new Promise(i=>setTimeout(i,100));return Promise.resolve()}return Promise.reject()}initializeFromMessage(t){const i=this.gl;let r=0;this.player=new rn(this,!0),this.player.id=t.getInt32(r++),this.player.connectUserId=t.getString(r++),this.player.username=t.getString(r++),this.player.face=t.getInt32(r++),this.player.isAdmin=t.getBoolean(r++),this.player.x=t.getDouble(r++),this.player.y=t.getDouble(r++),this.player.mountUsernameLabel(),this.canEdit=t.getBoolean(r++),this.canToggleGodMode=t.getBoolean(r++),this.ui.sideBar.updateMeta(t.getString(r++),t.getInt32(r++),t.getString(r++)),this.switches=t.getByteArray(r++),this.world=new it(this,t.getInt32(r++),t.getInt32(r++)),this.world.clear(!0),new sn(this.world).deserialize(t.getByteArray(r++)),this.camera=new lc(this),this.camera.setTargetPlayer(this.player),this.keys=new Or(this),this.worldRenderer=new Ze(this),this.worldRenderer.initialize(i),this.playerRenderer=new rs(this),this.playerRenderer.initialize(i),this.particleRenderer=new ss(this),this.particleRenderer.initialize(i),this.ui.initialize(),G.pwio.send(new ke(V.PlayerInit)),this.initialized=!0,this.player.initialized=!0}resize(){const t=G.el.clientWidth,i=G.el.clientHeight,r=t%2===0?t:t+1,s=i%2===0?i:i+1;this.canvasElement.width=r,this.canvasElement.height=s,this.ui.resize()}activate(){G.setBrowserLocation(`world/${this.joinRoomId}`),Y(G,this.canvasElement),Y(G,this.usernameLabels),Y(G,this.chatBubbles),Y(G,this.ui),U.addCanvasListeners(this.canvasElement),this.resize(),this.lastTick=Date.now(),this.setSelectedBlockId(w.Empty)}deactivate(){this.initialized=!1,ui.cleanup(this.gl),ye(G,this.canvasElement),ye(G,this.ui),ye(G,this.usernameLabels),ye(G,this.chatBubbles)}tick(){const t=U.isKeyDown("space"),i=U.isKeyJustDown("space"),r=U.isKeyDown("move_right"),s=U.isKeyDown("move_left"),o=U.isKeyDown("move_up"),l=U.isKeyDown("move_down");this.handleBlockDrawing(),this.handleBlockInfoBubble();let h=0,f=0;r&&(h+=1),s&&(h-=1),o&&(f-=1),l&&(f+=1),this.player.horizontal=h,this.player.vertical=f,this.player.spaceDown=t,this.player.spaceJustDown=i;for(const g of this.playersIncludingMe)g.tick();this.particleRenderer.tickParticles(),this.camera.tick(),this.world.tick(),this.keys.tick(),this.ui.tick()}handleScreenshot(){U.isKeyJustDown("screenshot")&&(this.takingScreenshot=!0,this.render(),this.canvasElement.toBlob(i=>{const r=document.createElement("a");r.href=URL.createObjectURL(i),r.download="screenshot.png",r.click()},"image/png",1),this.takingScreenshot=!1)}update(t){if(this.initialized){for(let i=0;Date.now()-this.lastTick>=fe.msPerTick&&i<=fe.maxMsPerTick;i++)this.lastTick+=fe.msPerTick,this.tick(),i==fe.maxMsPerTick&&(this.lastTick=Date.now());for(const i of this.playersIncludingMe)i.updateUsernameLabelAndChatBubbles(this.showPlayerLabelsAndBubbles)}}get showPlayerLabelsAndBubbles(){return Date.now()-this.lastMovement>1750||U.isKeyDown("shift")}handleBlockDrawing(){var g,a,c,p,_,y;if(!this.canEdit)return;const t=U.isMouseDown("left"),i=U.isMouseDown("right"),r=U.isMouseDown("middle"),s=t||i,o=U.isKeyDown("shift"),l=U.isKeyDown("control"),{x:h,y:f}=this.world.canvasPosToBlockPos(U.mouseX,U.mouseY);if(this.world.isInBounds(h,f)){if(r&&this.canEdit){let S=this.world.getBlockData(h,f,Q.Foreground);S.id===w.Empty&&(S=this.world.getBlockData(h,f,Q.Background)),l?this.ui.toolbar.quickBlockSelector.pickBlock(S.id):this.setSelectedBlockId(S.id);return}if((!s||((g=this.lastPlacementPos)==null?void 0:g.x)!==h||((a=this.lastPlacementPos)==null?void 0:a.y)!==f)&&(this.lastPlacementPos=void 0),!(this.lastPlacementPos!==void 0&&((c=this.lastPlacementPos)==null?void 0:c.x)===h&&((p=this.lastPlacementPos)==null?void 0:p.y)===f)){if(this.lastPlacementPos={x:h,y:f},t){const S=o?w.Empty:this.selectedBlockId,x=A.getById(S);let v=0;this.drawLayerLock==null&&(this.drawLayerLock=x.id==w.Empty?this.world.getTopMostPlacementLayer(h,f)??Q.Background:x.layer);const P=this.world.getBlockData(h,f,this.drawLayerLock);P.isRotatable()&&(v=(P.rotation+1)%4);let E;switch(S){case w.CoinDoor:case w.CoinGate:case w.BlueCoinDoor:case w.BlueCoinGate:E=new Et(S,Et.selectedCoinCount);break;case w.DeathDoor:case w.DeathGate:E=new Ki(S,Vi.selectedDeaths);break;case w.Portal:case w.PortalInvisible:E=new Ye(S,v,Ye.selectedPortalId,Ye.selectedPortalTargetId);break;case w.Spikes:E=new Wt(S,v);break;case w.LocalSwitch:case w.LocalSwitchDoor:case w.LocalSwitchGate:case w.GlobalSwitch:case w.GlobalSwitchDoor:case w.GlobalSwitchGate:E=new gi(S,At.selectedSwitchId);break;case w.LocalSwitchActivator:case w.GlobalSwitchActivator:E=new Ni(S,At.selectedSwitchId,At.selectedState);break;case w.LocalSwitchResetter:case w.GlobalSwitchResetter:E=new Yi(S,At.selectedState);break;default:E=new Ne(S);break}if(E.isSameAs(P))return;this.world.sendBlockData(h,f,this.drawLayerLock,E);return}if(i){const S=new Ne(w.Empty);if(this.drawLayerLock==null&&(this.drawLayerLock=this.world.getTopMostPlacementLayer(h,f)),this.world.getBlockData(h,f,this.drawLayerLock).isSameAs(S)||((_=this.lastPlacementPos)==null?void 0:_.x)!==h||((y=this.lastPlacementPos)==null?void 0:y.y)!==f)return;this.world.sendBlockData(h,f,this.drawLayerLock,S);return}s||(this.drawLayerLock=null,this.lastPlacementPos=void 0)}}}handleBlockInfoBubble(){if(!this.player.isFlying){this.ui.blockInfoBubble.setVisible(!1);return}const{x:t,y:i}=this.world.canvasPosToBlockPos(U.mouseX,U.mouseY);if(!this.world.isInBounds(t,i)){this.ui.blockInfoBubble.setVisible(!1);return}let r=this.world.getBlockData(t,i,Q.Foreground);if(r.infoBubbleContent==null){this.ui.blockInfoBubble.setVisible(!1);return}this.ui.blockInfoBubble.setVisible(!0),this.ui.blockInfoBubble.setContent(r.infoBubbleContent),this.ui.blockInfoBubble.setBlockPosition(t,i)}render(){const t=this.gl;if(!this.initialized)return;t.viewport(0,0,this.canvasElement.width,this.canvasElement.height),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),this.worldRenderer.preRender(),this.worldRenderer.render([N.Background,N.Foreground,N.Numbers]),this.takingScreenshot||this.playerRenderer.render(!1),this.worldRenderer.render([N.AbovePlayers]),this.takingScreenshot||this.playerRenderer.render(!0),this.particleRenderer.render();const i=t.getError();i!=t.NO_ERROR&&console.log(`WebGL rendering error: ${i}`)}getSelectedBlockId(){return this.selectedBlockId}setSelectedBlockId(t){this.selectedBlockId=t,this.drawLayerLock=null,this.ui.updateSelectedBlock()}reset(){for(let t=0;t<this.world.width;t++)for(let i=0;i<this.world.height;i++){const r=this.world.getBlockData(t,i,Q.Foreground);r.extra.collected&&(r.extra.collected=!1)}this.worldRenderer.updateAllChunks()}sendSwitchMessage(t,i){const r=new ke(V.GlobalSwitchChanged);r.add(t,z.Int32),r.add(i,z.Byte),G.pwio.send(r)}sendSwitchResetMessage(t){const i=new ke(V.GlobalSwitchReset);i.add(t,z.Byte),G.pwio.send(i)}onDisconnect(t){t||G.loadGameState(new Bo)}onMessage(t){switch(t.type){case V.PlayerInit:this.initializeFromMessage(t);break;case V.SystemMessage:{const i=t.getString(0),r=wi.Filter(t.getString(1));t.getBoolean(2)?G.showAlert(i,r):(this.ui.sideBar.chat.addMessage(i,r),i.indexOf(" > YOU")!==-1&&(this.ui.lastPMUsername=i.split(" ")[1]))}break}this.initialized&&this.onInitializedMessage(t)}onInitializedMessage(t){switch(t.type){case V.UpdateRights:this.canEdit=t.getBoolean(0),this.canToggleGodMode=t.getBoolean(1),this.ui.updateRights(),this.worldRenderer.updateAllChunks([N.AbovePlayers,N.Foreground]);break;case V.ChatMessage:{const i=t.getInt32(0),r=wi.Filter(t.getString(1)),s=this.playersIncludingMe.find(o=>o.id===i);s&&(this.ui.sideBar.chat.addMessage(s.username,r,s.usernameColor),s.addChatBubble(r))}break;case V.WorldMetadata:{const i=t.getString(0),r=t.getInt32(1),s=t.getString(2);this.ui.sideBar.updateMeta(i,r,s)}break;case V.WorldCleared:this.world.clear();break;case V.PlayerJoined:{let i=0;const r=new rn(this,!1);r.id=t.getInt32(i++),r.connectUserId=t.getString(i++),r.username=t.getString(i++),r.face=t.getInt32(i++),r.isAdmin=t.getBoolean(i++),r.x=t.getDouble(i++),r.y=t.getDouble(i++),r.counters.goldCoins=t.getInt32(i++),r.counters.blueCoins=t.getInt32(i++),r.counters.deaths=t.getInt32(i++),r.isInGodMode=t.getBoolean(i++),r.isInModMode=t.getBoolean(i++),t.getBoolean(i++)===!0&&(this.crownPlayer=r),r.switches=t.getByteArray(i++),r.mountUsernameLabel(),this.players.push(r),this.ui.sideBar.playerList.addPlayer(r),r.initialized=!0}break;case V.PlayerLeft:{const i=t.getInt32(0),r=this.players.findIndex(s=>s.id===i);r!==-1&&(this.players[r].unmountUsernameLabel(),this.players[r].clearChatBubbles(),this.ui.sideBar.playerList.removePlayer(this.players[r]),this.players.splice(r,1))}break;case V.PlayerMoved:{const i=t.getInt32(0),r=this.players.find(s=>s.id===i);r&&(r.x=t.getDouble(1),r.y=t.getDouble(2),r.speedX=t.getDouble(3),r.speedY=t.getDouble(4),r.modifierX=t.getDouble(5),r.modifierY=t.getDouble(6),r.horizontal=t.getInt32(7),r.vertical=t.getInt32(8),r.spaceDown=t.getBoolean(9),r.spaceJustDown=t.getBoolean(10),r.tickId=t.getInt32(11),r.isDead=!1)}break;case V.PlayerFace:{const i=t.getInt32(0),r=this.playersIncludingMe.find(s=>s.id===i);r&&(r.face=t.getInt32(1),r===this.player&&(G.lastPlayerFace=r.face,this.ui.updateSmileyButton()))}break;case V.PlayerGodMode:{const i=t.getInt32(0),r=this.playersIncludingMe.find(s=>s.id===i);r&&(r.isInGodMode=t.getBoolean(1),r===this.player&&(this.ui.updateGodModeButton(),this.worldRenderer.updateAllChunks([N.Foreground])))}break;case V.PlayerModMode:{const i=t.getInt32(0),r=this.playersIncludingMe.find(s=>s.id===i);r&&(r.isInModMode=t.getBoolean(1),r===this.player&&this.worldRenderer.updateAllChunks([N.Foreground]))}break;case V.WorldBlockPlaced:{const i=t.getInt32(0),r=t.getInt32(1),s=t.getInt32(2),o=t.getInt32(3);this.world.setBlockData(i,r,s,this.getBlockDataFromMessage(o,t))}break;case V.PlayerCrown:this.crownPlayer=this.playersIncludingMe.find(i=>i.id===t.getInt32(0));break;case V.PlayerKeyPressed:this.keys.activateKey(t.getByte(0));break;case V.PlayerCheckpoint:{const i=t.getInt32(0),r=t.getInt32(1);this.checkPoint=new Ri(i,r),this.worldRenderer.updateAllChunks([N.Foreground])}break;case V.PlayerRespawn:{const i=t.getInt32(0),r=t.getInt32(1),s=t.getInt32(2),o=this.playersIncludingMe.find(l=>l.id===i);o&&o.respawn(r,s)}break;case V.PlayerCounters:{const i=t.getInt32(0),r=this.players.find(s=>s.id===i);r&&(r.counters.goldCoins=t.getInt32(1),r.counters.blueCoins=t.getInt32(2),r.counters.deaths=t.getInt32(3))}break;case V.PlayerReset:{const i=t.getInt32(0),r=this.playersIncludingMe.find(s=>s.id===i);if(r){const s=t.getInt32(1),o=t.getInt32(2);r.reset(s,o),r.isMe&&this.reset()}}break;case V.WorldReloaded:console.log("World reloaded."),new sn(this.world).deserialize(t.getByteArray(0)),this.worldRenderer.updateAllChunks(),this.ui.minimap.reset();break;case V.PlayerLocalSwitchChanged:{const i=t.getInt32(0),r=this.players.find(s=>s.id===i);if(r){const s=t.getInt32(1),o=t.getByte(2);r.switches[s]=o}}break;case V.PlayerLocalSwitchReset:{const i=t.getInt32(0),r=t.getByte(1),s=this.players.find(o=>o.id===i);s&&s.switches.fill(r)}break;case V.GlobalSwitchChanged:{const i=t.getInt32(1),r=t.getByte(2);this.switches[i]=r,this.worldRenderer.updateAllChunks([N.Foreground])}break;case V.GlobalSwitchReset:{const i=t.getByte(1);this.switches.fill(i),this.worldRenderer.updateAllChunks([N.Foreground])}break}}getBlockDataFromMessage(t,i){let r=4;switch(t){default:return new Ne(t);case w.CoinDoor:case w.CoinGate:case w.BlueCoinDoor:case w.BlueCoinGate:return new Et(t,i.getInt32(r++));case w.DeathDoor:case w.DeathGate:return new Ki(t,i.getInt32(r++));case w.Portal:case w.PortalInvisible:return new Ye(t,i.getInt32(r++),i.getInt32(r++),i.getInt32(r++));case w.Spikes:return new Wt(t,i.getInt32(r++));case w.LocalSwitch:case w.LocalSwitchDoor:case w.LocalSwitchGate:case w.GlobalSwitch:case w.GlobalSwitchDoor:case w.GlobalSwitchGate:return new gi(t,i.getInt32(r++));case w.LocalSwitchActivator:case w.GlobalSwitchActivator:return new Ni(t,i.getInt32(r++),i.getByte(r++));case w.LocalSwitchResetter:case w.GlobalSwitchResetter:return new Yi(t,i.getByte(r++))}}}class on{constructor(e,t){m(this,"el");const i=e.width&&e.height;this.el=T("div.item",{onclick:()=>this.joinWorld(e.id)},[T("div.status-ball",{style:{backgroundColor:e.isOnline?"#0c0":"#c00"}}),T("div",{class:"name"},[T("div.title",wi.Filter(e.title)),i&&t&&T("div.subtitle",`${e.width}x${e.height}`)]),T("div.plays",`${e.plays} play`+(e.plays==1?"":"s")),e.isOnline&&T("div.players",`${e.playerCount}/${e.maxPlayers} online`)])}joinWorld(e){G.loadGameState(new br(e),{loadingText:"Joining world..."})}}class Cc{constructor(e){m(this,"el");m(this,"isLoading",!1);m(this,"lastLoaded",0);m(this,"allWorlds",[]);m(this,"onlineWorldsTab");m(this,"myWorldsTab");m(this,"onlineWorldsContainer");m(this,"myWorldsContainer");this.ui=e,this.el=T("div.world-list",[T("div.tabs",[this.onlineWorldsTab=T("div.tab",{onclick:()=>this.switchTab(0)},[T("i.fa-solid fa-earth-americas"),"Online"]),this.myWorldsTab=T("div.tab",{onclick:()=>this.switchTab(1)},[T("i.fa-solid fa-house"),"My Worlds"])]),this.onlineWorldsContainer=T("div.container"),this.myWorldsContainer=T("div.container")]),this.switchTab(0)}switchTab(e){this.loadAllRooms(),this.onlineWorldsContainer.style.display=e==0?"block":"none",this.onlineWorldsTab.classList.toggle("active",e==0),this.myWorldsContainer.style.display=e==1?"block":"none",this.myWorldsTab.classList.toggle("active",e==1)}async loadAllRooms(){Date.now()-this.lastLoaded<5e3||this.isLoading||(G.pwio.checkVersion(),this.allWorlds=[],this.onlineWorldsContainer.innerHTML="",this.myWorldsContainer.innerHTML="",Y(this.onlineWorldsContainer,T("div.message","Loading...")),Y(this.myWorldsContainer,T("div.message","Loading...")),this.isLoading=!0,Promise.all([this.loadOnlineRooms(),this.loadOwnedRooms()]).finally(()=>{this.isLoading=!1,this.lastLoaded=Date.now(),this.mountRooms()}))}async loadOnlineRooms(){const e=await this.fetchOnlineRooms();if(!e.ok){Y(this.onlineWorldsContainer,T("div.message","Failed to load worlds :("));return}const t=await e.json(),i=t.visibleRooms.sort(this.compareRooms);for(let r of i)this.allWorlds.push({id:r.id,title:r.data.title,playerCount:r.players,maxPlayers:r.max_players,plays:r.data.plays,isOnline:!0,isMine:!1});this.ui.lobbyInfo.updateCounts(t.onlinePlayerCount,t.onlineRoomCount)}async loadOwnedRooms(){const e=(await this.fetchMyWorlds()).sort();for(let t of e){let i=this.allWorlds.find(r=>r.id==t.id);if(i){i.isMine=!0,i.width=t.width,i.height=t.height;continue}this.allWorlds.push({id:t.id,title:t.title,width:t.width,height:t.height,playerCount:0,maxPlayers:0,plays:t.plays,isOnline:!1,isMine:!0})}}mountRooms(){this.onlineWorldsContainer.innerHTML="",this.myWorldsContainer.innerHTML="";for(let e of this.allWorlds)e.playerCount>0&&Y(this.onlineWorldsContainer,new on(e,!1)),e.isMine&&Y(this.myWorldsContainer,new on(e,!0));this.myWorldsContainer.children.length==0&&Y(this.myWorldsContainer,T("div.message","You have no worlds :(")),this.onlineWorldsContainer.children.length==0&&Y(this.onlineWorldsContainer,T("div.message","There are no worlds online right now :("))}async fetchOnlineRooms(){return fetch(`${zr("http")}/room/list/${Vt.roomType}`)}async fetchMyWorlds(){return(await G.pb.collection("worlds").getList()).items}compareRooms(e,t){return e.players!=t.players?t.players-e.players:e.data.plays!=t.data.plays?t.data.plays-e.data.plays:0}}class Pc{constructor(){m(this,"el");m(this,"worldNameInput");this.el=T("div.create-sandbox-world",[T("div.title","Create Sandbox World"),T("div.subtitle","Create an empty non-saved 200x200 world to play around in. Anyone with the link can join and edit the world."),T("div.input",[T("div.label","World Name"),this.worldNameInput=T("input",{class:"ui-input",type:"text",placeholder:"My awesome world!",value:"My awesome world!",maxlength:24})]),T("div.ui-action-button",{onclick:this.createWorld.bind(this),class:""},"Create Sandbox World!")])}createWorld(){const e=this.worldNameInput.value;e!=""&&G.loadGameState(new br(this.generateRandomRoomId(e),{world_name:e}),{loadingText:"Creating sandbox world..."})}generateRandomRoomId(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"_")+"_"+Math.random().toString(36).substring(2,9)}}class Tc{constructor(){m(this,"el");var e;this.el=T("div.player-profile-info",[T("div.smiley",_e.getById(G.lastPlayerFace).displayImage),T("div.username",[(e=G.pb.authStore.model)==null?void 0:e.username,T("div.logout",{onclick:this.logout.bind(this)},"Click here to log out")])])}logout(){G.pb.authStore.clear()}}class Ec{constructor(){m(this,"el");m(this,"playerCountText");m(this,"worldCountText");this.el=T("div.info",[T("div.line",[T("i.fas fa-user"),this.playerCountText=T("span","...")]),T("div.line",[T("i.fas fa-earth-americas"),this.worldCountText=T("span","...")])])}updateCounts(e,t){this.playerCountText.textContent=`${e} player${e==1?"":"s"} online`,this.worldCountText.textContent=`${t} world${t==1?"":"s"} online`}}class Dc{constructor(e){m(this,"el");m(this,"state");m(this,"background");m(this,"lobbyInfo");m(this,"worldList");m(this,"playerProfileInfo");m(this,"createWorld");this.state=e,this.el=T("div.lobby",[this.background=T("div.background"),T("div.container",[T("div.left-side",[this.lobbyInfo=new Ec,this.worldList=new Cc(this)]),T("div.right-side",[this.playerProfileInfo=new Tc,this.createWorld=new Pc])]),T("div.version",Vt.version)]),Y(this.background,Z.lobbyBackground.cloneNode())}}class Bo extends _i{constructor(){super();m(this,"ui",new Dc(this))}async load(){return Promise.resolve()}async activate(){G.setBrowserLocation(""),Y(G.el,this.ui)}deactivate(){ye(G.el,this.ui)}resize(){}}class an{static serialize(e){let t=1+this.calculate7BitEncodedIntLength(e.type);for(let s=0;s<e.count;s++){let o=e.getEntryType(s),l=e.getValue(s);t+=this.getEntrySizeInBytes(o,l)+1}let i=Xt.Buffer.alloc(t),r=0;i.writeUInt8(107,r++),r=this.write7BitEncodedInt(i,e.type,r);for(let s=0;s<e.count;s++){let o=e.getEntryType(s),l=e.getValue(s);switch(i.writeUInt8(o,r++),o){case z.String:const h=Xt.Buffer.byteLength(l);r=this.write7BitEncodedInt(i,h,r),i.write(l,r),r+=h;break;case z.Byte:i.writeUInt8(l,r++);break;case z.Int16:i.writeInt16BE(l,r),r+=2;break;case z.Int32:i.writeInt32BE(l,r),r+=4;break;case z.Int64:i.writeBigInt64BE(l,r),r+=8;break;case z.Float:i.writeFloatBE(l,r),r+=4;break;case z.Double:i.writeDoubleBE(l,r),r+=8;break;case z.Boolean:i.writeUInt8(l?1:0,r++);break;case z.ByteArray:r=this.write7BitEncodedInt(i,l.byteLength,r);for(let f=0;f<l.byteLength;f++)i.writeUInt8(l[f],r++);break}}return i}static deserialize(e){let t=1,i=this.read7BitEncodedInt(e,t);t+=this.calculate7BitEncodedIntLength(i);let r=new ke(i);for(;t<e.length;){let s=e.readUInt8(t++),o;switch(s){case z.String:let l=this.read7BitEncodedInt(e,t);t+=this.calculate7BitEncodedIntLength(l),o=e.toString("utf8",t,t+l),t+=l;break;case z.Byte:o=e.readUInt8(t++);break;case z.Int16:o=e.readInt16BE(t),t+=2;break;case z.Int32:o=e.readInt32BE(t),t+=4;break;case z.Int64:o=e.readBigInt64BE(t),t+=8;break;case z.Float:o=e.readFloatBE(t),t+=4;break;case z.Double:o=e.readDoubleBE(t),t+=8;break;case z.Boolean:o=e.readUInt8(t++)===1;break;case z.ByteArray:let h=this.read7BitEncodedInt(e,t);t+=this.calculate7BitEncodedIntLength(h);let f=new Uint8Array(h);for(let g=0;g<h;g++)f.set([e.readUInt8(t++)],g);o=f;break}r.add(o,s)}return r}static getEntrySizeInBytes(e,t){switch(e){case z.String:return this.calculate7BitEncodedIntLength(t.length)+Xt.Buffer.byteLength(t);case z.Byte:return 1;case z.Int16:return 2;case z.Int32:return 4;case z.Int64:return 8;case z.Float:return 4;case z.Double:return 8;case z.Boolean:return 1;case z.ByteArray:return this.calculate7BitEncodedIntLength(t.length)+t.length}}static calculate7BitEncodedIntLength(e){let t=0;do e>>=7,t++;while(e>0);return t}static write7BitEncodedInt(e,t,i){for(;t>=128;)e.writeUInt8(t&127|128,i++),t>>=7;return e.writeUInt8(t,i++),i}static read7BitEncodedInt(e,t){let i=0,r=0,s;do s=e.readUInt8(t++),i|=(s&127)<<r,r+=7;while(s&128);return i}}class ln extends _i{constructor(e,t){super(),this.title=e,this.message=t}activate(){G.showAlert(this.title,this.message,!1)}isLocked(){return!0}}const ni=class ni{constructor(){m(this,"webSocket");m(this,"connected",!1);m(this,"onConnected");m(this,"onDisconnected");m(this,"onMessage");m(this,"onError")}checkVersion(){fetch(`${zr("http")}/check/${Vt.roomType}`).then(e=>{e.status!==200&&G.setGameState(new ln("Update Required","The game version is outdated. Please refresh the page to update."))}).catch(e=>G.setGameState(new ln("An error occurred","The server is currently unavailable. Please refresh the page to try again.")))}async connect(e,t=void 0){this.connected&&this.disconnect(!0);const i=await this.getJoinKey(Vt.roomType,e);if(!i)throw new Error("Failed to get the join key.");let r=`${zr()}/room/${i}`;t!==void 0&&(r+=`?joinData=${btoa(JSON.stringify(t))}`),this.webSocket=new WebSocket(r),this.webSocket.binaryType="arraybuffer",await new Promise((s,o)=>{this.webSocket.onopen=l=>{this.handleWebsocketOpen(),s()},this.webSocket.onclose=l=>{this.handleWebsocketClosed(l),o(new Error("Failed to connect to the server."))},this.webSocket.onmessage=l=>this.handleMessage(l),this.webSocket.onerror=l=>{this.handleError(l),o(new Error("An error occurred while connecting to the server."))}})}disconnect(e=!1){var t;!this.connected||!this.webSocket||((t=this.onDisconnected)==null||t.call(this,e),this.reset(),this.webSocket.close(),this.connected=!1)}async getJoinKey(e,t){const i=await G.pb.send(`/api/joinkey/${e}/${t}`,{});return i==null?void 0:i.token}handleWebsocketOpen(){var e;this.connected=!0,(e=this.onConnected)==null||e.call(this)}handleWebsocketClosed(e){var t;this.connected&&(this.connected=!1,(t=this.onDisconnected)==null||t.call(this,!1))}handleMessage(e){var r;if(!this.connected||!this.webSocket)return;if(!(e.data instanceof ArrayBuffer)){console.error("Received non-arraybuffer data.");return}const t=Xt.Buffer.from(e.data),i=t.readInt8(0);switch(i){case ni.PING_HEADER:this.sendPong();break;case ni.MESSAGE_HEADER:const s=an.deserialize(t);(r=this.onMessage)==null||r.call(this,s);break;default:console.error(`Received unknown message header: ${i}`);break}}handleError(e){var t,i;console.error(e),(t=this.onError)==null||t.call(this,new Error("An error occurred.")),(i=this.onDisconnected)==null||i.call(this,!1)}send(e){if(!this.connected||!this.webSocket)return;const t=an.serialize(e);this.webSocket.send(t)}sendPong(){if(!this.connected||!this.webSocket)return;const e=new Xt.Buffer([63]);this.webSocket.send(e)}reset(){this.connected=!1,this.onConnected=void 0,this.onDisconnected=void 0,this.onMessage=void 0,this.onError=void 0}};m(ni,"PING_HEADER",63),m(ni,"MESSAGE_HEADER",107);let ns=ni;class Ve extends Error{constructor(e){var t,i,r,s;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,Ve.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof Ve||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(s=(r=(i=this.originalError)==null?void 0:i.cause)==null?void 0:r.message)!=null&&s.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const er=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Ic(n,e){const t={};if(typeof n!="string")return t;const i=Object.assign({},e||{}).decode||Rc;let r=0;for(;r<n.length;){const s=n.indexOf("=",r);if(s===-1)break;let o=n.indexOf(";",r);if(o===-1)o=n.length;else if(o<s){r=n.lastIndexOf(";",s-1)+1;continue}const l=n.slice(r,s).trim();if(t[l]===void 0){let h=n.slice(s+1,o).trim();h.charCodeAt(0)===34&&(h=h.slice(1,-1));try{t[l]=i(h)}catch{t[l]=h}}r=o+1}return t}function cn(n,e,t){const i=Object.assign({},t||{}),r=i.encode||Lc;if(!er.test(n))throw new TypeError("argument name is invalid");const s=r(e);if(s&&!er.test(s))throw new TypeError("argument val is invalid");let o=n+"="+s;if(i.maxAge!=null){const l=i.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(l)}if(i.domain){if(!er.test(i.domain))throw new TypeError("option domain is invalid");o+="; Domain="+i.domain}if(i.path){if(!er.test(i.path))throw new TypeError("option path is invalid");o+="; Path="+i.path}if(i.expires){if(!function(h){return Object.prototype.toString.call(h)==="[object Date]"||h instanceof Date}(i.expires)||isNaN(i.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(o+="; HttpOnly"),i.secure&&(o+="; Secure"),i.priority)switch(typeof i.priority=="string"?i.priority.toLowerCase():i.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Rc(n){return n.indexOf("%")!==-1?decodeURIComponent(n):n}function Lc(n){return encodeURIComponent(n)}let Ao;function ci(n){if(n)try{const e=decodeURIComponent(Ao(n.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Co(n,e=0){let t=ci(n);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}Ao=typeof atob=="function"?atob:n=>{let e=String(n).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,i,r=0,s=0,o="";i=e.charAt(s++);~i&&(t=r%4?64*t+i:i,r++%4)?o+=String.fromCharCode(255&t>>(-2*r&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return o};const un="pb_auth";class Fc{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!Co(this.token)}get isAdmin(){return ci(this.token).type==="admin"}get isAuthRecord(){return ci(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=un){const i=Ic(e||"")[t]||"";let r={};try{r=JSON.parse(i),(typeof r===null||typeof r!="object"||Array.isArray(r))&&(r={})}catch{}this.save(r.token||"",r.model||null)}exportToCookie(e,t=un){var h,f;const i={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},r=ci(this.token);i.expires=r!=null&&r.exp?new Date(1e3*r.exp):new Date("1970-01-01"),e=Object.assign({},i,e);const s={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let o=cn(t,JSON.stringify(s),e);const l=typeof Blob<"u"?new Blob([o]).size:o.length;if(s.model&&l>4096){s.model={id:(h=s==null?void 0:s.model)==null?void 0:h.id,email:(f=s==null?void 0:s.model)==null?void 0:f.email};const g=["collectionId","username","verified"];for(const a in this.model)g.includes(a)&&(s.model[a]=this.model[a]);o=cn(t,JSON.stringify(s),e)}return o}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let i=this._onChangeCallbacks.length-1;i>=0;i--)if(this._onChangeCallbacks[i]==e)return delete this._onChangeCallbacks[i],void this._onChangeCallbacks.splice(i,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class Mc extends Fc{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let i=t;typeof t!="string"&&(i=JSON.stringify(t)),window.localStorage.setItem(e,i)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class $t{constructor(e){this.client=e}}class zc extends $t{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,i){return i=Object.assign({method:"POST",body:{email:e,template:t}},i),this.client.send("/api/settings/test/email",i).then(()=>!0)}async generateAppleClientSecret(e,t,i,r,s,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:i,privateKey:r,duration:s}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}class Cs extends $t{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let i=500;return(t=Object.assign({},e,t)).batch&&(i=t.batch,delete t.batch),this._getFullList(i,t)}async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send(this.baseCrudPath,i).then(r=>{var s;return r.items=((s=r.items)==null?void 0:s.map(o=>this.decode(o)))||[],r})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(i=>{var r;if(!((r=i==null?void 0:i.items)!=null&&r.length))throw new Ve({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return i.items[0]})}async getOne(e,t){if(!e)throw new Ve({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(i=>this.decode(i))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(i=>this.decode(i))}async update(e,t,i){return i=Object.assign({method:"PATCH",body:t},i),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),i).then(r=>this.decode(r))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let i=[],r=async s=>this.getList(s,e||500,t).then(o=>{const l=o.items;return i=i.concat(l),l.length==o.perPage?r(s+1):i});return r(1)}}function ze(n,e,t,i){const r=i!==void 0;return r||t!==void 0?r?(console.warn(n),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,i),e):Object.assign(e,t):e}function Fr(n){var e;(e=n._resetAutoRefresh)==null||e.call(n)}class Oc extends Cs{get baseCrudPath(){return"/api/admins"}async update(e,t,i){return super.update(e,t,i).then(r=>{var s,o;return((s=this.client.authStore.model)==null?void 0:s.id)===r.id&&((o=this.client.authStore.model)==null?void 0:o.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,r),r})}async delete(e,t){return super.delete(e,t).then(i=>{var r,s;return i&&((r=this.client.authStore.model)==null?void 0:r.id)===e&&((s=this.client.authStore.model)==null?void 0:s.collectionId)===void 0&&this.client.authStore.clear(),i})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}async authWithPassword(e,t,i,r){let s={method:"POST",body:{identity:e,password:t}};s=ze("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",s,i,r);const o=s.autoRefreshThreshold;delete s.autoRefreshThreshold,s.autoRefresh||Fr(this.client);let l=await this.client.send(this.baseCrudPath+"/auth-with-password",s);return l=this.authResponse(l),o&&function(f,g,a,c){Fr(f);const p=f.beforeSend,_=f.authStore.model,y=f.authStore.onChange((S,x)=>{(!S||(x==null?void 0:x.id)!=(_==null?void 0:_.id)||(x!=null&&x.collectionId||_!=null&&_.collectionId)&&(x==null?void 0:x.collectionId)!=(_==null?void 0:_.collectionId))&&Fr(f)});f._resetAutoRefresh=function(){y(),f.beforeSend=p,delete f._resetAutoRefresh},f.beforeSend=async(S,x)=>{var I;const v=f.authStore.token;if((I=x.query)!=null&&I.autoRefresh)return p?p(S,x):{url:S,sendOptions:x};let P=f.authStore.isValid;if(P&&Co(f.authStore.token,g))try{await a()}catch{P=!1}P||await c();const E=x.headers||{};for(let F in E)if(F.toLowerCase()=="authorization"&&v==E[F]&&f.authStore.token){E[F]=f.authStore.token;break}return x.headers=E,p?p(S,x):{url:S,sendOptions:x}}}(this.client,o,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},s))),l}async authRefresh(e,t){let i={method:"POST"};return i=ze("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",i,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",i).then(this.authResponse.bind(this))}async requestPasswordReset(e,t,i){let r={method:"POST",body:{email:e}};return r=ze("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",r,t,i),this.client.send(this.baseCrudPath+"/request-password-reset",r).then(()=>!0)}async confirmPasswordReset(e,t,i,r,s){let o={method:"POST",body:{token:e,password:t,passwordConfirm:i}};return o=ze("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",o,r,s),this.client.send(this.baseCrudPath+"/confirm-password-reset",o).then(()=>!0)}}const Gc=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Po(n){if(n){n.query=n.query||{};for(let e in n)Gc.includes(e)||(n.query[e]=n[e],delete n[e])}}class To extends $t{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,i){var o;if(!e)throw new Error("topic must be set.");let r=e;if(i){Po(i);const l="options="+encodeURIComponent(JSON.stringify({query:i.query,headers:i.headers}));r+=(r.includes("?")?"&":"?")+l}const s=function(l){const h=l;let f;try{f=JSON.parse(h==null?void 0:h.data)}catch{}t(f||{})};return this.subscriptions[r]||(this.subscriptions[r]=[]),this.subscriptions[r].push(s),this.isConnected?this.subscriptions[r].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(r,s):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,s)}async unsubscribe(e){var i;let t=!1;if(e){const r=this.getSubscriptionsByTopic(e);for(let s in r)if(this.hasSubscriptionListeners(s)){for(let o of this.subscriptions[s])(i=this.eventSource)==null||i.removeEventListener(s,o);delete this.subscriptions[s],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var i;let t=!1;for(let r in this.subscriptions)if((r+"?").startsWith(e)){t=!0;for(let s of this.subscriptions[r])(i=this.eventSource)==null||i.removeEventListener(r,s);delete this.subscriptions[r]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var s;let i=!1;const r=this.getSubscriptionsByTopic(e);for(let o in r){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let l=!1;for(let h=this.subscriptions[o].length-1;h>=0;h--)this.subscriptions[o][h]===t&&(l=!0,delete this.subscriptions[o][h],this.subscriptions[o].splice(h,1),(s=this.eventSource)==null||s.removeEventListener(o,t));l&&(this.subscriptions[o].length||delete this.subscriptions[o],i||this.hasSubscriptionListeners(o)||(i=!0))}this.hasSubscriptionListeners()?i&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,i;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let r in this.subscriptions)if((i=this.subscriptions[r])!=null&&i.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let i in this.subscriptions)(i+"?").startsWith(e)&&(t[i]=this.subscriptions[i]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let i=3;for(;this.hasUnsentSubscriptions()&&i>0;)i--,await this.submitSubscriptions()}).then(()=>{for(let r of this.pendingConnects)r.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const i=this.getSubscriptionsByTopic("PB_CONNECT");for(let r in i)for(let s of i[r])s(e)}).catch(i=>{this.clientId="",this.connectErrorHandler(i)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let i of this.pendingConnects)i.reject(new Ve(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[]}}}class Uc extends Cs{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,i){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,i)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const i=Object.assign({},e,t);return super.getFullList(i)}async getList(e=1,t=30,i){return super.getList(e,t,i)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,i){return super.update(e,t,i).then(r=>{var s,o,l;return((s=this.client.authStore.model)==null?void 0:s.id)!==(r==null?void 0:r.id)||((o=this.client.authStore.model)==null?void 0:o.collectionId)!==this.collectionIdOrName&&((l=this.client.authStore.model)==null?void 0:l.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,r),r})}async delete(e,t){return super.delete(e,t).then(i=>{var r,s,o;return!i||((r=this.client.authStore.model)==null?void 0:r.id)!==e||((s=this.client.authStore.model)==null?void 0:s.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.model)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),i})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}async authWithPassword(e,t,i,r){let s={method:"POST",body:{identity:e,password:t}};return s=ze("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",s,i,r),this.client.send(this.baseCollectionPath+"/auth-with-password",s).then(o=>this.authResponse(o))}async authWithOAuth2Code(e,t,i,r,s,o,l){let h={method:"POST",body:{provider:e,code:t,codeVerifier:i,redirectUrl:r,createData:s}};return h=ze("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",h,o,l),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",h).then(f=>this.authResponse(f))}async authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},i=(await this.listAuthMethods()).authProviders.find(h=>h.name===t.provider);if(!i)throw new Ve(new Error(`Missing or invalid provider "${t.provider}".`));const r=this.client.buildUrl("/api/oauth2-redirect"),s=new To(this.client);let o=null;function l(){o==null||o.close(),s.unsubscribe()}return t.urlCallback||(o=hn(void 0)),new Promise(async(h,f)=>{var g;try{await s.subscribe("@oauth2",async _=>{const y=s.clientId;try{if(!_.state||y!==_.state)throw new Error("State parameters don't match.");if(_.error||!_.code)throw new Error("OAuth2 redirect error or missing code: "+_.error);const S=Object.assign({},t);delete S.provider,delete S.scopes,delete S.createData,delete S.urlCallback;const x=await this.authWithOAuth2Code(i.name,_.code,i.codeVerifier,r,t.createData,S);h(x)}catch(S){f(new Ve(S))}l()});const a={state:s.clientId};(g=t.scopes)!=null&&g.length&&(a.scope=t.scopes.join(" "));const c=this._replaceQueryParams(i.authUrl+r,a);await(t.urlCallback||function(_){o?o.location.href=_:o=hn(_)})(c)}catch(a){l(),f(new Ve(a))}})}async authRefresh(e,t){let i={method:"POST"};return i=ze("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",i,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",i).then(r=>this.authResponse(r))}async requestPasswordReset(e,t,i){let r={method:"POST",body:{email:e}};return r=ze("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/request-password-reset",r).then(()=>!0)}async confirmPasswordReset(e,t,i,r,s){let o={method:"POST",body:{token:e,password:t,passwordConfirm:i}};return o=ze("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,r,s),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(e,t,i){let r={method:"POST",body:{email:e}};return r=ze("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/request-verification",r).then(()=>!0)}async confirmVerification(e,t,i){let r={method:"POST",body:{token:e}};return r=ze("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/confirm-verification",r).then(()=>{const s=ci(e),o=this.client.authStore.model;return o&&!o.verified&&o.id===s.id&&o.collectionId===s.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(e,t,i){let r={method:"POST",body:{newEmail:e}};return r=ze("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/request-email-change",r).then(()=>!0)}async confirmEmailChange(e,t,i,r){let s={method:"POST",body:{token:e,password:t}};return s=ze("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",s,i,r),this.client.send(this.baseCollectionPath+"/confirm-email-change",s).then(()=>{const o=ci(e),l=this.client.authStore.model;return l&&l.id===o.id&&l.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}async unlinkExternalAuth(e,t,i){return i=Object.assign({method:"DELETE"},i),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),i).then(()=>!0)}_replaceQueryParams(e,t={}){let i=e,r="";e.indexOf("?")>=0&&(i=e.substring(0,e.indexOf("?")),r=e.substring(e.indexOf("?")+1));const s={},o=r.split("&");for(const l of o){if(l=="")continue;const h=l.split("=");s[decodeURIComponent(h[0].replace(/\+/g," "))]=decodeURIComponent((h[1]||"").replace(/\+/g," "))}for(let l in t)t.hasOwnProperty(l)&&(t[l]==null?delete s[l]:s[l]=t[l]);r="";for(let l in s)s.hasOwnProperty(l)&&(r!=""&&(r+="&"),r+=encodeURIComponent(l.replace(/%20/g,"+"))+"="+encodeURIComponent(s[l].replace(/%20/g,"+")));return r!=""?i+"?"+r:i}}function hn(n){if(typeof window>"u"||!(window!=null&&window.open))throw new Ve(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,i=window.innerWidth,r=window.innerHeight;e=e>i?i:e,t=t>r?r:t;let s=i/2-e/2,o=r/2-t/2;return window.open(n,"popup_window","width="+e+",height="+t+",top="+o+",left="+s+",resizable,menubar=no")}class Nc extends Cs{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,i){return i=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},i),this.client.send(this.baseCrudPath+"/import",i).then(()=>!0)}}class Yc extends $t{async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send("/api/logs",i)}async getOne(e,t){if(!e)throw new Ve({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Kc extends $t{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Xc extends $t{getUrl(e,t,i={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const r=[];r.push("api"),r.push("files"),r.push(encodeURIComponent(e.collectionId||e.collectionName)),r.push(encodeURIComponent(e.id)),r.push(encodeURIComponent(t));let s=this.client.buildUrl(r.join("/"));if(Object.keys(i).length){i.download===!1&&delete i.download;const o=new URLSearchParams(i);s+=(s.includes("?")?"&":"?")+o}return s}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class Vc extends $t{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class Wc{constructor(e="/",t,i="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=i,this.authStore=t||new Mc,this.admins=new Oc(this),this.collections=new Nc(this),this.files=new Xc(this),this.logs=new Yc(this),this.settings=new zc(this),this.realtime=new To(this),this.health=new Kc(this),this.backups=new Vc(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Uc(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let i in t){let r=t[i];switch(typeof r){case"boolean":case"number":r=""+r;break;case"string":r="'"+r.replace(/'/g,"\\'")+"'";break;default:r=r===null?"null":r instanceof Date?"'"+r.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(r).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+i+"}",r)}return e}getFileUrl(e,t,i={}){return this.files.getUrl(e,t,i)}buildUrl(e){var i;let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(i=window.location.origin)!=null&&i.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let i=this.buildUrl(e);if(this.beforeSend){const r=Object.assign({},await this.beforeSend(i,t));r.url!==void 0||r.options!==void 0?(i=r.url||i,t=r.options||t):Object.keys(r).length&&(t=r,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const r=this.serializeQueryParams(t.query);r&&(i+=(i.includes("?")?"&":"?")+r),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(i,t).then(async r=>{let s={};try{s=await r.json()}catch{}if(this.afterSend&&(s=await this.afterSend(r,s)),r.status>=400)throw new Ve({url:r.url,status:r.status,data:s});return s}).catch(r=>{throw new Ve(r)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),Po(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const i=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(i);const r=new AbortController;this.cancelControllers[i]=r,t.signal=r.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(const i in e){const r=e[i];if(typeof r!="object"||this.hasBlobField({data:r})){const s=Array.isArray(r)?r:[r];for(let o of s)t.append(i,o)}else{let s={};s[i]=r,t.append("@jsonPayload",JSON.stringify(s))}}return t}hasBlobField(e){for(const t in e){const i=Array.isArray(e[t])?e[t]:[e[t]];for(const r of i)if(typeof Blob<"u"&&r instanceof Blob||typeof File<"u"&&r instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let i in e)if(i.toLowerCase()==t)return e[i];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const i in e){if(e[i]===null)continue;const r=e[i],s=encodeURIComponent(i);if(Array.isArray(r))for(const o of r)t.push(s+"="+encodeURIComponent(o));else r instanceof Date?t.push(s+"="+encodeURIComponent(r.toISOString())):typeof r!==null&&typeof r=="object"?t.push(s+"="+encodeURIComponent(JSON.stringify(r))):t.push(s+"="+encodeURIComponent(r))}return t.join("&")}}class qc{constructor(e){m(this,"el");m(this,"emailInput");m(this,"passwordInput");this.ui=e,this.el=T("div.container",{class:""},[T("div.title","Login with Email and Password"),T("div.subtitle","Login to your account using your email and password."),this.emailInput=T("input.ui-input",{type:"text",placeholder:"Email"}),this.passwordInput=T("input.ui-input",{type:"password",placeholder:"Password"}),T("div.forgot-password",{onclick:()=>this.ui.switchTab(2)},"Forgot your password?"),T("button.ui-action-button",{onclick:this.login.bind(this)},"Login")])}async login(){const e=this.emailInput.value,t=this.passwordInput.value;e==""||t==""||await G.pb.collection("users").authWithPassword(e,t).catch(i=>G.showAlert("Oops!",i.message))}setActive(e){this.el.style.display=e?"flex":"none"}}class jc{constructor(e){m(this,"el");m(this,"usernameInput");m(this,"emailInput");m(this,"passwordInput");m(this,"confirmPasswordInput");this.ui=e,this.el=T("div.container",[T("div.title","Register a new account"),T("div.subtitle","By registering an account, you can access all of our features. It only takes a few seconds!"),this.usernameInput=T("input.ui-input uppercase",{type:"text",placeholder:"Username",maxlength:"20"}),this.emailInput=T("input.ui-input",{type:"text",placeholder:"Email"}),this.passwordInput=T("input.ui-input",{type:"password",placeholder:"Password"}),this.confirmPasswordInput=T("input.ui-input",{type:"password",placeholder:"Confirm Password"}),T("button.ui-action-button",{onclick:this.register.bind(this)},"Register"),T("div.terms-and-conditions",{onclick:this.openTermsPage.bind(this)},"By registering an account, you accept our terms and conditions.")])}async register(){if(this.usernameInput.value==""||this.emailInput.value==""||this.passwordInput.value==""||this.confirmPasswordInput.value=="")return;if(!/^[a-zA-Z][a-zA-Z0-9]{2,19}$/.test(this.usernameInput.value)){G.showAlert("Invalid username!","Usernames must be 3-20 characters long, start with a letter, and only contain letters and numbers.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.emailInput.value)){G.showAlert("Invalid email!","Please enter a valid email address.");return}if(this.passwordInput.value.length<8){G.showAlert("Invalid password!","Passwords must be at least 6 characters long.");return}if(this.passwordInput.value!=this.confirmPasswordInput.value){G.showAlert("Your passwords do not match!","Please make sure they are the same and try again.");return}const e=await this.ui.state.recaptcha.execute("register");await G.pb.collection("users").create({username:this.usernameInput.value.toUpperCase(),email:this.emailInput.value,emailVisibility:!1,password:this.passwordInput.value,passwordConfirm:this.confirmPasswordInput.value},{recaptchaToken:e}).then(this.success.bind(this)).catch(this.decodeError.bind(this))}async success(){await G.pb.collection("users").requestVerification(this.emailInput.value),G.showAlert("Success!","Your account has been created! Please check your email for a verification link. Once you have verified your email, you can log in with your email and password."),this.ui.switchTab(0)}async decodeError(e){if(!e)return;const t=e.data.data;if(Object.keys(t).length==0){G.showAlert("Oops!",e.message);return}let i=`Account creation failed due to the following errors:

`;for(const r in t){const s=t[r];i+=`${r}: ${s.message}
`}G.showAlert("Oops!",i)}setActive(e){this.el.style.display=e?"flex":"none"}openTermsPage(){window.open("/terms.html","_blank")}}class Hc{constructor(e){m(this,"el");m(this,"emailInput");this.ui=e,this.el=T("div.container",[T("div.title","Reset your password"),T("div.subtitle","Enter your email address below and we will send you a link to reset your password."),this.emailInput=T("input.ui-input",{type:"text",placeholder:"Email"}),T("button.ui-action-button",{onclick:this.resetPassword.bind(this)},"Reset Password")])}async resetPassword(){const e=this.emailInput.value;e!=""&&(await G.pb.collection("users").requestPasswordReset(e).then(()=>G.showAlert("Success!","Password reset email sent.")).catch(t=>G.showAlert("Oops!",t.message)),this.ui.switchTab(0),this.emailInput.value="")}setActive(e){this.el.style.display=e?"flex":"none"}}class $c{constructor(e){m(this,"el");m(this,"loginTab");m(this,"registerTab");m(this,"loginTabPage");m(this,"registerTabPage");m(this,"passwordResetTabPage");this.state=e,this.el=T("div.auth",[T("div.box",[T("div.tabs",[this.loginTab=T("div.tab",{onclick:()=>this.switchTab(0)},"Login"),this.registerTab=T("div.tab",{onclick:()=>this.switchTab(1)},"Register")]),this.loginTabPage=new qc(this),this.registerTabPage=new jc(this),this.passwordResetTabPage=new Hc(this)])]),this.switchTab(0)}switchTab(e){this.loginTabPage.setActive(e==0),this.loginTab.classList.toggle("active",e==0),this.registerTabPage.setActive(e==1),this.registerTab.classList.toggle("active",e==1),this.passwordResetTabPage.setActive(e==2)}}var Eo={},yi={},qi={},Jc=at&&at.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(g){try{f(i.next(g))}catch(a){o(a)}}function h(g){try{f(i.throw(g))}catch(a){o(a)}}function f(g){g.done?s(g.value):r(g.value).then(l,h)}f((i=i.apply(n,e||[])).next())})},Zc=at&&at.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(f){return function(g){return h([f,g])}}function h(f){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(s=f[0]&2?r.return:f[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,f[1])).done)return s;switch(r=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,r=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){t.label=f[1];break}if(f[0]===6&&t.label<s[1]){t.label=s[1],s=f;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(f);break}s[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(n,t)}catch(g){f=[6,g],r=0}finally{i=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(qi,"__esModule",{value:!0});qi.ReCaptchaInstance=void 0;var Qc=function(){function n(e,t,i){this.siteKey=e,this.recaptchaID=t,this.recaptcha=i,this.styleContainer=null}return n.prototype.execute=function(e){return Jc(this,void 0,void 0,function(){return Zc(this,function(t){return[2,this.recaptcha.enterprise?this.recaptcha.enterprise.execute(this.recaptchaID,{action:e}):this.recaptcha.execute(this.recaptchaID,{action:e})]})})},n.prototype.getSiteKey=function(){return this.siteKey},n.prototype.hideBadge=function(){this.styleContainer===null&&(this.styleContainer=document.createElement("style"),this.styleContainer.innerHTML=".grecaptcha-badge{visibility:hidden !important;}",document.head.appendChild(this.styleContainer))},n.prototype.showBadge=function(){this.styleContainer!==null&&(document.head.removeChild(this.styleContainer),this.styleContainer=null)},n}();qi.ReCaptchaInstance=Qc;Object.defineProperty(yi,"__esModule",{value:!0});yi.getInstance=yi.load=void 0;var eu=qi,bt;(function(n){n[n.NOT_LOADED=0]="NOT_LOADED",n[n.LOADING=1]="LOADING",n[n.LOADED=2]="LOADED"})(bt||(bt={}));var Do=function(){function n(){}return n.load=function(e,t){if(t===void 0&&(t={}),typeof document>"u")return Promise.reject(new Error("This is a library for the browser!"));if(n.getLoadingState()===bt.LOADED)return n.instance.getSiteKey()===e?Promise.resolve(n.instance):Promise.reject(new Error("reCAPTCHA already loaded with different site key!"));if(n.getLoadingState()===bt.LOADING)return e!==n.instanceSiteKey?Promise.reject(new Error("reCAPTCHA already loaded with different site key!")):new Promise(function(r,s){n.successfulLoadingConsumers.push(function(o){return r(o)}),n.errorLoadingRunnable.push(function(o){return s(o)})});n.instanceSiteKey=e,n.setLoadingState(bt.LOADING);var i=new n;return new Promise(function(r,s){i.loadScript(e,t.useRecaptchaNet||!1,t.useEnterprise||!1,t.renderParameters?t.renderParameters:{},t.customUrl).then(function(){n.setLoadingState(bt.LOADED);var o=i.doExplicitRender(grecaptcha,e,t.explicitRenderParameters?t.explicitRenderParameters:{},t.useEnterprise||!1),l=new eu.ReCaptchaInstance(e,o,grecaptcha);n.successfulLoadingConsumers.forEach(function(h){return h(l)}),n.successfulLoadingConsumers=[],t.autoHideBadge&&l.hideBadge(),n.instance=l,r(l)}).catch(function(o){n.errorLoadingRunnable.forEach(function(l){return l(o)}),n.errorLoadingRunnable=[],s(o)})})},n.getInstance=function(){return n.instance},n.setLoadingState=function(e){n.loadingState=e},n.getLoadingState=function(){return n.loadingState===null?bt.NOT_LOADED:n.loadingState},n.prototype.loadScript=function(e,t,i,r,s){var o=this;t===void 0&&(t=!1),i===void 0&&(i=!1),r===void 0&&(r={}),s===void 0&&(s="");var l=document.createElement("script");l.setAttribute("recaptcha-v3-script","");var h="https://www.google.com/recaptcha/api.js";t&&(i?h="https://recaptcha.net/recaptcha/enterprise.js":h="https://recaptcha.net/recaptcha/api.js"),i&&(h="https://www.google.com/recaptcha/enterprise.js"),s&&(h=s),r.render&&(r.render=void 0);var f=this.buildQueryString(r);return l.src=h+"?render=explicit"+f,new Promise(function(g,a){l.addEventListener("load",o.waitForScriptToLoad(function(){g(l)},i),!1),l.onerror=function(c){n.setLoadingState(bt.NOT_LOADED),a(c)},document.head.appendChild(l)})},n.prototype.buildQueryString=function(e){var t=Object.keys(e);return t.length<1?"":"&"+Object.keys(e).filter(function(i){return!!e[i]}).map(function(i){return i+"="+e[i]}).join("&")},n.prototype.waitForScriptToLoad=function(e,t){var i=this;return function(){window.grecaptcha===void 0?setTimeout(function(){i.waitForScriptToLoad(e,t)},n.SCRIPT_LOAD_DELAY):t?window.grecaptcha.enterprise.ready(function(){e()}):window.grecaptcha.ready(function(){e()})}},n.prototype.doExplicitRender=function(e,t,i,r){var s={sitekey:t,badge:i.badge,size:i.size,tabindex:i.tabindex};return i.container?r?e.enterprise.render(i.container,s):e.render(i.container,s):r?e.enterprise.render(s):e.render(s)},n.loadingState=null,n.instance=null,n.instanceSiteKey=null,n.successfulLoadingConsumers=[],n.errorLoadingRunnable=[],n.SCRIPT_LOAD_DELAY=25,n}();yi.load=Do.load;yi.getInstance=Do.getInstance;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ReCaptchaInstance=n.getInstance=n.load=void 0;var e=yi;Object.defineProperty(n,"load",{enumerable:!0,get:function(){return e.load}}),Object.defineProperty(n,"getInstance",{enumerable:!0,get:function(){return e.getInstance}});var t=qi;Object.defineProperty(n,"ReCaptchaInstance",{enumerable:!0,get:function(){return t.ReCaptchaInstance}})})(Eo);class tu extends _i{constructor(){super();m(this,"ui",new $c(this));m(this,"recaptcha")}async load(){return this.recaptcha=await Eo.load(Vt.recaptchaSiteKey),this.recaptcha.hideBadge(),Promise.resolve()}async activate(){Y(G.el,this.ui)}deactivate(){ye(G.el,this.ui)}}class iu{constructor(e,t,i=!0){m(this,"el");m(this,"box");this.el=T("div.ui-alert-box",[this.box=T("div.container",[T("div.title",e),T("div.message",{innerText:t}),i&&T("div.button",{onclick:this.close.bind(this)},"OK")])]),Tt.fromTo(this.el,{opacity:0},{opacity:1,duration:.2}),Tt.fromTo(this.box,{scale:.5},{scale:1,duration:.2,ease:"back.out(1.7)"})}close(){Tt.to(this.el,{opacity:0,duration:.2,onComplete:()=>{ye(this.el.parentElement,this.el)}})}}class Io{constructor(e,t=!0){m(this,"el");m(this,"contentContainer");m(this,"usernameElement");m(this,"worldsElement");this.username=e,this.isStandalone=t,this.el=T("div.profile",[this.contentContainer=T("div.container",[!t&&T("i.fas.fa-times.close",{onclick:this.close.bind(this)}),this.usernameElement=T("div.username"," "),this.worldsElement=T("div.worlds")])]),this.loadProfile(),Tt.from(this.contentContainer,{duration:.1,y:50,opacity:0})}async loadProfile(){await G.pb.collection("public_profiles").getFirstListItem(`username="${this.username.toUpperCase()}"`).then(e=>this.renderProfile(e)).catch(()=>this.renderNotFound())}async renderProfile(e){this.usernameElement.textContent=e.username,e.admin&&this.usernameElement.classList.add("admin"),await G.pb.collection("public_worlds").getFullList({filter:`owner="${e.id}"`,sort:"-plays"}).then(t=>this.renderWorlds(t))}async renderWorlds(e){for(const t of e.filter(i=>i.minimap))Y(this.worldsElement,T("div.world",{onclick:()=>this.openWorld(t.id)},[T("div.title",t.title),T("div.plays",`${t.plays} plays`),T("img",{src:G.pb.files.getUrl(t,t.minimap),alt:t.title})]))}openWorld(e){this.close(),G.loadGameState(new br(e),{loadingText:"Loading world..."})}renderNotFound(){bn(this.contentContainer,[T("div.notfound","Profile not found.")])}close(){Tt.to(this.el,{duration:.1,y:50,opacity:0,onComplete:()=>this.el.remove()})}}class ru extends _i{constructor(t){super();m(this,"profile");this.username=t,this.profile=new Io(this.username)}async load(){return Promise.resolve()}async activate(){Y(G.el,this.profile)}deactivate(){ye(G.el,this.profile)}}class su{constructor(){m(this,"el");m(this,"stats");m(this,"fullScreenAllowed",!1);m(this,"loggedIn",!1);m(this,"gameState");m(this,"lastTime",performance.now());m(this,"pwio",new ns);m(this,"pb",new Wc(Vt.endpoints.api));m(this,"lastPlayerFace",0);this.el=document.getElementById("game"),window.onresize=this.resize.bind(this),this.resize(),this.fullScreenAllowed=Hi.fullscreenEnabled,this.start()}resize(){var e;(e=this.gameState)==null||e.resize()}registerKeyBinds(){U.registerKeyBind("move_right",["KeyD","ArrowRight"]),U.registerKeyBind("move_left",["KeyA","ArrowLeft"]),U.registerKeyBind("move_up",["KeyW","ArrowUp"]),U.registerKeyBind("move_down",["KeyS","ArrowDown"]),U.registerKeyBind("shift",["ShiftLeft","ShiftRight"]),U.registerKeyBind("control",["ControlLeft","ControlRight"]),U.registerKeyBind("space",["Space"]),U.registerKeyBind("god_mode",["KeyG"]),U.registerKeyBind("mod_mode",["KeyP"]),U.registerKeyBind("minimap",["KeyM"]),U.registerKeyBind("block_1",["Digit1"]),U.registerKeyBind("block_2",["Digit2"]),U.registerKeyBind("block_3",["Digit3"]),U.registerKeyBind("block_4",["Digit4"]),U.registerKeyBind("block_5",["Digit5"]),U.registerKeyBind("block_6",["Digit6"]),U.registerKeyBind("block_7",["Digit7"]),U.registerKeyBind("block_8",["Digit8"]),U.registerKeyBind("block_9",["Digit9"]),U.registerKeyBind("block_10",["Digit0"]),U.registerKeyBind("toggle_block_selector",["KeyE","KeyB"]),U.registerKeyBind("block_selector_cycle_tab",["Tab"]),U.registerKeyBind("open_chat",["KeyReturn","Enter","KeyT"]),U.registerKeyBind("open_chat_command",["Slash"]),U.registerKeyBind("autocomplete_chat",["Tab"]),U.registerKeyBind("send_chat",["KeyReturn","Enter"]),U.registerKeyBind("close_chat",["Escape"]),U.registerKeyBind("screenshot",["KeyN"]),U.registerKeyBind("reply_pm",["Backspace"])}async start(){this.stats=new Xo,U.initialize(this.el),this.registerKeyBinds(),window.requestAnimationFrame(this.gameLoop.bind(this)),await Z.loadAssets(),ht.initSmileys(),ht.initBlocks();let[e,t]=parent.location.pathname.split("/").filter(r=>r),i;e&&t&&(i={action:e,location:t}),this.pb.authStore.onChange(()=>{var s;const r=this.loggedIn;this.loggedIn=!!this.pb.authStore.model,!r&&this.loggedIn&&(this.lastPlayerFace=((s=this.pb.authStore.model)==null?void 0:s.face)??0,i&&i.action==="world"&&i.location?(this.loadGameState(new br(i.location),{loadingText:"Loading world..."}),i=void 0):i&&i.action==="profile"&&i.location?(this.loadGameState(new ru(i.location),{loadingText:"Loading profile..."}),i=void 0):this.loadGameState(new Bo,{loadingText:"Loading world..."})),this.loggedIn||(this.pwio.disconnect(),this.loadGameState(new tu))}),this.pb.collection("users").authRefresh().catch(()=>{console.log("Failed to refresh auth token."),this.pb.authStore.clear()})}gameLoop(){this.update(),this.render(),window.requestAnimationFrame(this.gameLoop.bind(this))}update(){var i;const e=performance.now(),t=(e-this.lastTime)/1e3;this.lastTime=e,(i=this.gameState)==null||i.update(t),U.forceFocus()}render(){var e;this.stats.begin(),(e=this.gameState)==null||e.render(),this.stats.end()}setGameState(e){var t,i;(t=this.gameState)!=null&&t.isLocked()||((i=this.gameState)==null||i.deactivate(),this.gameState=e,this.gameState.activate())}loadGameState(e,t={}){const i=this.gameState,r=new ua(t.loadingText??"Loading...");this.setGameState(r),e.load().then(()=>this.setGameState(e)).catch(s=>{var o;(o=t.loadFailed)==null||o.call(this,s),i&&this.setGameState(i),G.showAlert("Failed to join world!",`Reason: ${s.message}`)})}toggleFullScreen(){if(this.fullScreenAllowed){if(Hi.fullscreenElement!==null){Hi.exitFullscreen();return}Hi.requestFullscreen(this.el.parentElement)}}setBrowserLocation(e){parent.window.history.replaceState({},"",`/${e}`)}showAlert(e,t,i=!0){Y(this.el,new iu(e,t,i))}showProfile(e){Y(this.el,new Io(e,!1))}}const nu=new su,G=nu;
